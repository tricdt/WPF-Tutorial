<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:dxbt="http://schemas.devexpress.com/winfx/2008/xaml/bars/themekeys"
                    xmlns:dxcn="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
                    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
                    xmlns:dxrt="http://schemas.devexpress.com/winfx/2008/xaml/ribbon/themekeys"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!--BEGIN WPF-->

    <BooleanToVisibilityConverter x:Key="boolToVisibilityConverter"/>

    <Thickness x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarFirstSeparatorMargin}">2,0,0,0</Thickness>

    <Thickness x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLastSeparatorMargin}">0,0,2,0</Thickness>

    <!--END WPF-->

    <!-- Ribbon Quick Access Toolbar Control -->

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLeftContentTemplate}" TargetType="ContentControl">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="12"/>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="2">
                <Path Data="F1 M 46,16C 49.3137,16 52,18.9101 52,22.5C 52,26.0899 49.3137,29 46,29L 46,16 Z "
                      HorizontalAlignment="Left"
                      Margin="0"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      StrokeDashArray="1 0"
                      StrokeThickness="0">
                    <Path.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#ff9ea3a8" Offset="0"/>
                            <GradientStop Color="#ffaeafb1" Offset="1"/>
                        </LinearGradientBrush>
                    </Path.Fill>
                </Path>
                <Path Data="F1 M 46,16C 49.3137,16 52,18.9101 52,22.5C 52,26.0899 49.3137,29 46,29L 46,16 Z "
                      HorizontalAlignment="Left"
                      Margin="0,1,1,1"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      StrokeDashArray="1 0"
                      StrokeThickness="0">
                    <Path.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#ffbec4cd" Offset="1"/>
                            <GradientStop Color="#ffdedfe3" Offset="0"/>
                        </LinearGradientBrush>
                    </Path.Fill>
                </Path>
            </Grid>
            <Grid Margin="0,0,-5,0">
                <Path Data="F1 M 251.079,190L 251.079,200L 251.079,210L 244.074,210C 243.906,201.631 239.542,194.292 233,190L 251.079,190 Z "
                      HorizontalAlignment="Right"
                      Margin="0"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      VerticalAlignment="Stretch">
                    <Path.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#ff9ea3a8" Offset="0"/>
                            <GradientStop Color="#ffaeafb1" Offset="1"/>
                        </LinearGradientBrush>
                    </Path.Fill>
                </Path>
                <Path Data="F1 M 250.078,191L 250.078,209L 245.058,209C 244.758,201.676 241.176,195.199 235.743,191L 250.078,191 Z "
                      HorizontalAlignment="Right"
                      Margin="2,1,1,1"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      VerticalAlignment="Stretch">
                    <Path.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#ffbec4cd" Offset="1"/>
                            <GradientStop Color="#ffdedfe3" Offset="0"/>
                        </LinearGradientBrush>
                    </Path.Fill>
                </Path>
            </Grid>
            <Grid Grid.Column="1" Margin="-1,0,0,0">
                <Rectangle Margin="1,0,0,0"
                           SnapsToDevicePixels="True"
                           StrokeDashArray="1 0"
                           StrokeThickness="0">
                    <Rectangle.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#ff9ea3a8" Offset="0"/>
                            <GradientStop Color="#ffaeafb1" Offset="1"/>
                        </LinearGradientBrush>
                    </Rectangle.Fill>
                </Rectangle>
                <Rectangle Margin="1,1,0,1"
                           SnapsToDevicePixels="True"
                           StrokeDashArray="1 0"
                           StrokeThickness="0">
                    <Rectangle.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#ffbec4cd" Offset="1"/>
                            <GradientStop Color="#ffdedfe3" Offset="0"/>
                        </LinearGradientBrush>
                    </Rectangle.Fill>
                </Rectangle>
            </Grid>
            <Grid Grid.Column="1"
                  Margin="0,0,0,-1"
                  MinHeight="24"
                  MinWidth="16">
                <ContentPresenter Content="{TemplateBinding ContentControl.Content}"/>
            </Grid>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLeftContentTemplateInPopup}" TargetType="ContentControl">
        <Grid>
            <Border x:Name="Border"
                    Background="#ffb0b0b0"
                    SnapsToDevicePixels="True">
                <Border Background="#ccedeff3" Margin="1,1,0,1">
                    <Border Margin="1,1,0,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFd9dee6" Offset="0"/>
                                <GradientStop Color="#FFd6dbe3" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                </Border>
            </Border>
            <ContentPresenter Content="{TemplateBinding Content}" Margin="3,3,2,2"/>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarRightContentTemplateInPopup}" TargetType="ContentControl">
        <Grid>
            <Border x:Name="Border"
                    Background="#ffb0b0b0"
                    SnapsToDevicePixels="True">
                <Border Background="#ccedeff3" Margin="0,1,1,1">
                    <Border Margin="0,1,0,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFd9dee6" Offset="0"/>
                                <GradientStop Color="#FFd6dbe3" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                </Border>
            </Border>
            <ContentPresenter Content="{TemplateBinding Content}" Margin="3,3,2,2"/>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarLeftContentTemplateInFooter}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding Content}" Margin="0,0,-1,-1"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarLeftContentTemplateInTitle}" TargetType="ContentControl">
        <Grid Margin="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Control x:Name="PART_FirstSeparator"
                     Grid.Column="0"
                     Margin="{DynamicResource {dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarFirstSeparatorMargin}}"
                     Template="{DynamicResource {dxbt:BarItemSeparatorThemeKey ResourceKey=InRibbonQuickAccessToolbarCommonTemplate}}"/>
            <ContentPresenter Content="{TemplateBinding Content}"
                              Grid.Column="1"
                              Margin="2,0,-1,-1"/>
        </Grid>
        <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=(dxr:RibbonControl.Ribbon).IsInRibbonWindow, RelativeSource={RelativeSource Self}}" Value="False">
                <Setter Property="Visibility"
                        TargetName="PART_FirstSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding VisibleItemsCount, RelativeSource={RelativeSource AncestorType=dxr:RibbonQuickAccessToolbarControl}}" Value="0">
                <Setter Property="Visibility"
                        TargetName="PART_FirstSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=(dxcn:DXWindowsHelper.WindowKind), RelativeSource={RelativeSource Self}}" Value="{x:Static dxcn:DXWindowsHelper.ThemedWindow}">
                <Setter Property="Margin"
                        TargetName="PART_FirstSeparator"
                        Value="0"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=(dxr:RibbonControl.Ribbon).ToolbarHideSeparators, RelativeSource={RelativeSource Self}}" Value="True">
                <Setter Property="Visibility"
                        TargetName="PART_FirstSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarLeftContentTemplate2010}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding ContentControl.Content}"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarRightContentTemplate}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding Content}" Margin="5,0,-1,-1"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarRightContentTemplateInFooter}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding Content}" Margin="2,0,-1,-1"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarRightContentTemplateInTitle}" TargetType="ContentControl">
        <Grid Margin="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <ContentPresenter Name="contentPresenter"
                              Content="{TemplateBinding Content}"
                              Grid.Column="0"
                              Margin="2,0,-1,-1"/>
            <Control x:Name="PART_LastSeparator"
                     Grid.Column="1"
                     Margin="{DynamicResource {dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLastSeparatorMargin}}"
                     Template="{DynamicResource {dxbt:BarItemSeparatorThemeKey ResourceKey=InRibbonQuickAccessToolbarCommonTemplate}}"/>
        </Grid>
        <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=(dxr:RibbonControl.Ribbon).IsInRibbonWindow, RelativeSource={RelativeSource Self}}" Value="False">
                <Setter Property="Visibility"
                        TargetName="PART_LastSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=(dxr:RibbonControl.Ribbon).ToolbarShowCustomizationButton, RelativeSource={RelativeSource Self}}" Value="False">
                <Setter Property="Visibility"
                        TargetName="PART_LastSeparator"
                        Value="Collapsed"/>
                <Setter Property="Visibility"
                        TargetName="contentPresenter"
                        Value="Collapsed"/>
            </DataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey  ResourceKey=RibbonToolbarRightContentTemplate2010}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding Content}" Margin="2,0,-1,-1"/>
    </ControlTemplate>

    <!-- Office2007Silver: Ribbon Quick Access Toolbar Button Template -->

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarCustomizationButtonTemplate}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Margin="0,0,1,1" SnapsToDevicePixels="True">
            <Grid x:Name="PART_Normal" Opacity="0">
                <Border Background="Transparent"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border Background="Transparent"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border Background="Transparent"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True"/>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Hover" Visibility="Collapsed">
                <Border x:Name="hover"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border x:Name="hover1"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="White" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border x:Name="hover2"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Pressed" Visibility="Collapsed">
                <Border x:Name="pressed"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF8B7654" Offset="0"/>
                            <GradientStop Color="#FFC4B9A8" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.1*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border x:Name="pressed1"
                                BorderThickness="0"
                                CornerRadius="1,1,0,0"
                                Grid.RowSpan="2"
                                Margin="1,1,1,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFDAD11" Offset="1"/>
                                    <GradientStop Color="#FFF0A85C"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border x:Name="pressed2"
                                    BorderThickness="0"
                                    CornerRadius="0"
                                    Margin="1"
                                    SnapsToDevicePixels="True">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFFFC570" Offset="1"/>
                                        <GradientStop Color="#FFFCA160" Offset="0.5"/>
                                        <GradientStop Color="#FFFB8C3B" Offset="0.5"/>
                                        <GradientStop Color="#FFF8B56A"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="pressed3"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                CornerRadius="2,2,0,0"
                                Margin="0"
                                Opacity="0.5"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF352D21" Offset="0.1"/>
                                    <GradientStop Color="#00352D21" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_Focused" Visibility="Collapsed">
                <Border BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="White" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid>
                <Grid HorizontalAlignment="Center"
                      Margin="0"
                      SnapsToDevicePixels="True"
                      VerticalAlignment="Center">
                    <StackPanel HorizontalAlignment="Center"
                                Margin="4,0,4,1"
                                Orientation="Vertical"
                                SnapsToDevicePixels="True"
                                VerticalAlignment="Center"
                                Width="5">
                        <Grid Height="4"
                              SnapsToDevicePixels="True"
                              Width="6">
                            <Rectangle Fill="#ffe1e1e1"
                                       Height="1"
                                       HorizontalAlignment="Left"
                                       Margin="0"
                                       SnapsToDevicePixels="True"
                                       Stretch="Fill"
                                       VerticalAlignment="Bottom"
                                       Width="6"/>
                            <Rectangle Fill="#ff464646"
                                       Height="1"
                                       HorizontalAlignment="Left"
                                       Margin="0,0,0,1"
                                       SnapsToDevicePixels="True"
                                       Stretch="Fill"
                                       VerticalAlignment="Bottom"
                                       Width="6"/>
                        </Grid>
                        <Grid Height="4"
                              Margin="0,1,0,0"
                              SnapsToDevicePixels="True"
                              Width="Auto">
                            <Path Data="F1 M 3.05176e-005,1L 3.05176e-005,2L 1,2.00003L 1,3.00003L 2,3.00003L 2,4.00003L 3,4.00003L 3,3.00003L 4,3.00003L 4,2.00003L 5,2.00003L 5,1.00003L 3.05176e-005,1 Z "
                                  Fill="#ffe1e1e1"
                                  Height="Auto"
                                  Margin="0,1,0,0"
                                  SnapsToDevicePixels="True"
                                  Stretch="Fill"
                                  Width="Auto"/>
                            <Path Data="F1 M 0,0L 0,1L 0.999969,1L 0.999969,2L 1.99997,2L 1.99997,3L 2.99997,3L 2.99997,2L 3.99997,2L 3.99997,1L 4.99997,1L 4.99997,0L 0,0 Z "
                                  Fill="#ff464646"
                                  Height="Auto"
                                  Margin="0,0,0,1"
                                  SnapsToDevicePixels="True"
                                  Stretch="Fill"
                                  Width="Auto"/>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Checked">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hover">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <!-- Office2007Silver: Ribbon Quick Access Toolbar Button Template In Footer-->

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarCustomizationButtonTemplateInFooter}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Margin="0,0,1,1" SnapsToDevicePixels="True">
            <Grid x:Name="PART_Normal" Opacity="0">
                <Border Background="Transparent"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border Background="Transparent"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border Background="Transparent"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True"/>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Hover" Visibility="Collapsed">
                <Border x:Name="hover"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border x:Name="hover1"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="White" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border x:Name="hover2"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Pressed" Visibility="Collapsed">
                <Border x:Name="pressed"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF8B7654" Offset="0"/>
                            <GradientStop Color="#FFC4B9A8" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.1*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border x:Name="pressed1"
                                BorderThickness="0"
                                CornerRadius="1,1,0,0"
                                Grid.RowSpan="2"
                                Margin="1,1,1,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFDAD11" Offset="1"/>
                                    <GradientStop Color="#FFF0A85C"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border x:Name="pressed2"
                                    BorderThickness="0"
                                    CornerRadius="0"
                                    Margin="1"
                                    SnapsToDevicePixels="True">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFFFC570" Offset="1"/>
                                        <GradientStop Color="#FFFCA160" Offset="0.5"/>
                                        <GradientStop Color="#FFFB8C3B" Offset="0.5"/>
                                        <GradientStop Color="#FFF8B56A"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="pressed3"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                CornerRadius="2,2,0,0"
                                Margin="0"
                                Opacity="0.5"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF352D21" Offset="0.1"/>
                                    <GradientStop Color="#00352D21" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_Focused" Visibility="Collapsed">
                <Border BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="White" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid>
                <Grid HorizontalAlignment="Center"
                      Margin="0"
                      SnapsToDevicePixels="True"
                      VerticalAlignment="Center">
                    <StackPanel HorizontalAlignment="Center"
                                Margin="4,0,4,1"
                                Orientation="Vertical"
                                SnapsToDevicePixels="True"
                                VerticalAlignment="Center"
                                Width="5">
                        <Grid Height="4"
                              SnapsToDevicePixels="True"
                              Width="6">
                            <Rectangle Fill="#ffe1e1e1"
                                       Height="1"
                                       HorizontalAlignment="Left"
                                       Margin="0"
                                       SnapsToDevicePixels="True"
                                       Stretch="Fill"
                                       VerticalAlignment="Bottom"
                                       Width="6"/>
                            <Rectangle Fill="#ff464646"
                                       Height="1"
                                       HorizontalAlignment="Left"
                                       Margin="0,0,0,1"
                                       SnapsToDevicePixels="True"
                                       Stretch="Fill"
                                       VerticalAlignment="Bottom"
                                       Width="6"/>
                        </Grid>
                        <Grid Height="4"
                              Margin="0,1,0,0"
                              SnapsToDevicePixels="True"
                              Width="Auto">
                            <Path Data="F1 M 3.05176e-005,1L 3.05176e-005,2L 1,2.00003L 1,3.00003L 2,3.00003L 2,4.00003L 3,4.00003L 3,3.00003L 4,3.00003L 4,2.00003L 5,2.00003L 5,1.00003L 3.05176e-005,1 Z "
                                  Fill="#ffe1e1e1"
                                  Height="Auto"
                                  Margin="0,1,0,0"
                                  SnapsToDevicePixels="True"
                                  Stretch="Fill"
                                  Width="Auto"/>
                            <Path Data="F1 M 0,0L 0,1L 0.999969,1L 0.999969,2L 1.99997,2L 1.99997,3L 2.99997,3L 2.99997,2L 3.99997,2L 3.99997,1L 4.99997,1L 4.99997,0L 0,0 Z "
                                  Fill="#ff464646"
                                  Height="Auto"
                                  Margin="0,0,0,1"
                                  SnapsToDevicePixels="True"
                                  Stretch="Fill"
                                  Width="Auto"/>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Checked">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hover">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <!-- Office2007Silver: Ribbon Quick Access Toolbar Button Template -->

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarDropDownButtonTemplate}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Margin="0,0,1,1"
              MinHeight="20"
              MinWidth="12"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_Normal" Opacity="0">
                <Border Background="Transparent"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border Background="Transparent"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border Background="Transparent"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True"/>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Hover" Visibility="Collapsed">
                <Border x:Name="hover"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border x:Name="hover1"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border x:Name="hover2"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Pressed" Visibility="Collapsed">
                <Border x:Name="pressed"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF8B7654" Offset="0"/>
                            <GradientStop Color="#FFC4B9A8" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.1*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border x:Name="pressed1"
                                BorderThickness="0"
                                CornerRadius="1,1,0,0"
                                Grid.RowSpan="2"
                                Margin="1,1,1,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFDAD11" Offset="1"/>
                                    <GradientStop Color="#FFF0A85C"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border x:Name="pressed2"
                                    BorderThickness="0"
                                    CornerRadius="0"
                                    Margin="1"
                                    SnapsToDevicePixels="True">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFFFC570" Offset="1"/>
                                        <GradientStop Color="#FFFCA160" Offset="0.5"/>
                                        <GradientStop Color="#FFFB8C3B" Offset="0.5"/>
                                        <GradientStop Color="#FFF8B56A"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="pressed3"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                CornerRadius="2,2,0,0"
                                Margin="0"
                                Opacity="0.5"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF352D21" Offset="0.1"/>
                                    <GradientStop Color="#00352D21" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_Focused" Visibility="Collapsed">
                <Border BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid Height="6"
                  HorizontalAlignment="Center"
                  Margin="1,0,0,0"
                  SnapsToDevicePixels="True"
                  VerticalAlignment="Center"
                  Width="8">
                <Path Data="F1 M 151,112L 148,115L 147,115L 150,112L 147,109L 148,109L 151,112 Z "
                      Fill="#ffe1e1e1"
                      HorizontalAlignment="Right"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="4"/>
                <Path Data="F1 M 147,109L 150,112L 147,115L 147,109 Z "
                      Fill="#ff464646"
                      HorizontalAlignment="Right"
                      Margin="0,0,1,0"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="3"/>
                <Path Data="F1 M 147,112L 144,115L 143,115L 146,112L 143,109L 144,109L 147,112 Z "
                      Fill="#ffe1e1e1"
                      HorizontalAlignment="Left"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="4"/>
                <Path Data="F1 M 143,109L 146,112L 143,115L 143,109 Z "
                      Fill="#ff464646"
                      HorizontalAlignment="Left"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="3"/>
            </Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Checked">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hover">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <!-- Office2007Silver: Ribbon Quick Access Toolbar Button Template In Footer-->

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarDropDownButtonTemplateInFooter}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Height="20"
              Margin="0,0,1,1"
              SnapsToDevicePixels="True"
              Width="12">
            <Grid x:Name="PART_Normal" Opacity="0">
                <Border Background="Transparent"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border Background="Transparent"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border Background="Transparent"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True"/>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Hover" Visibility="Collapsed">
                <Border x:Name="hover"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border x:Name="hover1"
                            BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border x:Name="hover2"
                                BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Pressed" Visibility="Collapsed">
                <Border x:Name="pressed"
                        BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF8B7654" Offset="0"/>
                            <GradientStop Color="#FFC4B9A8" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.1*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border x:Name="pressed1"
                                BorderThickness="0"
                                CornerRadius="1,1,0,0"
                                Grid.RowSpan="2"
                                Margin="1,1,1,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFDAD11" Offset="1"/>
                                    <GradientStop Color="#FFF0A85C"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border x:Name="pressed2"
                                    BorderThickness="0"
                                    CornerRadius="0"
                                    Margin="1"
                                    SnapsToDevicePixels="True">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFFFC570" Offset="1"/>
                                        <GradientStop Color="#FFFCA160" Offset="0.5"/>
                                        <GradientStop Color="#FFFB8C3B" Offset="0.5"/>
                                        <GradientStop Color="#FFF8B56A"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="pressed3"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                CornerRadius="2,2,0,0"
                                Margin="0"
                                Opacity="0.5"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF352D21" Offset="0.1"/>
                                    <GradientStop Color="#00352D21" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_Focused" Visibility="Collapsed">
                <Border BorderThickness="0"
                        CornerRadius="2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDDCF9B" Offset="0"/>
                            <GradientStop Color="#FFDDCF9B" Offset="1"/>
                            <GradientStop Color="#FFC0A776" Offset="0.5"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                <GradientStop Color="#FFFFF362" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFFFFDDE" Offset="0"/>
                                    <GradientStop Color="#FFFFE794" Offset="1"/>
                                    <GradientStop Color="#FFFFE797" Offset="0.5"/>
                                    <GradientStop Color="#FFFFD758" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid Height="6"
                  HorizontalAlignment="Center"
                  Margin="1,0,0,0"
                  SnapsToDevicePixels="True"
                  VerticalAlignment="Center"
                  Width="8">
                <Path Data="F1 M 151,112L 148,115L 147,115L 150,112L 147,109L 148,109L 151,112 Z "
                      Fill="#ffe1e1e1"
                      HorizontalAlignment="Right"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="4"/>
                <Path Data="F1 M 147,109L 150,112L 147,115L 147,109 Z "
                      Fill="#ff464646"
                      HorizontalAlignment="Right"
                      Margin="0,0,1,0"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="3"/>
                <Path Data="F1 M 147,112L 144,115L 143,115L 146,112L 143,109L 144,109L 147,112 Z "
                      Fill="#ffe1e1e1"
                      HorizontalAlignment="Left"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="4"/>
                <Path Data="F1 M 143,109L 146,112L 143,115L 143,109 Z "
                      Fill="#ff464646"
                      HorizontalAlignment="Left"
                      SnapsToDevicePixels="True"
                      Stretch="Fill"
                      Width="3"/>
            </Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Checked">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hover">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Hover" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Focused" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarPopupBorderTemplate}" TargetType="{x:Type dxr:RibbonQuickAccessToolbarPopupBorderControl}">
        <Border Background="Black">
            <ContentPresenter Content="{TemplateBinding Content}"/>
        </Border>
    </ControlTemplate>

    <!--BEGIN WPF-->

    <!-- Aero -->

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLeftContentTemplateInAeroHeader}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding Content}"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLeftContentTemplate2010InAeroHeader}" TargetType="ContentControl">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Control x:Name="PART_FirstSeparator"
                     Grid.Column="0"
                     Margin="{DynamicResource {dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarFirstSeparatorMargin}}"
                     Template="{DynamicResource {dxbt:BarItemSeparatorThemeKey ResourceKey=InRibbonQuickAccessToolbarCommonTemplate}}"/>
            <ContentPresenter Content="{TemplateBinding Content}" Grid.Column="1"/>
        </Grid>
        <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=(dxr:RibbonControl.Ribbon).IsInRibbonWindow, RelativeSource={RelativeSource Self}}" Value="False">
                <Setter Property="Visibility"
                        TargetName="PART_FirstSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding VisibleItemsCount, RelativeSource={RelativeSource AncestorType=dxr:RibbonQuickAccessToolbarControl}}" Value="0">
                <Setter Property="Visibility"
                        TargetName="PART_FirstSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=(dxcn:DXWindowsHelper.WindowKind), RelativeSource={RelativeSource Self}}" Value="{x:Static dxcn:DXWindowsHelper.ThemedWindow}">
                <Setter Property="Margin"
                        TargetName="PART_FirstSeparator"
                        Value="0"/>
            </DataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarRightContentTemplateInAeroHeader}" TargetType="ContentControl">
        <ContentPresenter Content="{TemplateBinding Content}" Margin="5,-1,0,-1"/>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarRightContentTemplate2010InAeroHeader}" TargetType="ContentControl">
        <Grid Margin="2,0,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <ContentPresenter Content="{TemplateBinding Content}" Grid.Column="0"/>
            <Control x:Name="PART_LastSeparator"
                     Grid.Column="1"
                     Margin="{DynamicResource {dxrt:QuickAccessToolbarThemeKey ResourceKey=RibbonToolbarLastSeparatorMargin}}"
                     Template="{DynamicResource {dxbt:BarItemSeparatorThemeKey ResourceKey=InRibbonQuickAccessToolbarCommonTemplate}}"/>
        </Grid>
        <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=(dxr:RibbonControl.Ribbon).IsInRibbonWindow, RelativeSource={RelativeSource Self}}" Value="False">
                <Setter Property="Visibility"
                        TargetName="PART_LastSeparator"
                        Value="Collapsed"/>
            </DataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!--END WPF-->

</ResourceDictionary>