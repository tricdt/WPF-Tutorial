<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars" xmlns:dxbt="http://schemas.devexpress.com/winfx/2008/xaml/bars/themekeys" xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon" xmlns:dxri="http://schemas.devexpress.com/winfx/2008/xaml/ribbon/internal" xmlns:dxcn="http://schemas.devexpress.com/winfx/2008/xaml/core/internal" xmlns:dxrt="http://schemas.devexpress.com/winfx/2008/xaml/ribbon/themekeys" xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys">
  <dxc:BooleanToVisibilityConverter x:Key="boolToVisibilityConverter" Invert="False" />
  <dxri:RibbonPageCategoryCornerRadiusConverter x:Key="cornerRadiusConverter" />
  <dxri:RibbonPageCategoryThicknessConverter x:Key="thicknessConverter" />
  <dxc:BooleanToVisibilityConverter x:Key="invertBoolToVisibilityConverter" Invert="True" />
  <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionTemplate}" TargetType="{x:Type dxr:RibbonPageCaptionControl}">
    <Grid>
      <dxr:RibbonCheckedBorderControl Template="{TemplateBinding ActualBorderTemplate}" UseAppFocusValue="True" AppFocusValue="{Binding Path=(dxr:RibbonNavigationManager.IsSelected), RelativeSource={RelativeSource TemplatedParent}}" Focusable="False" IsTabStop="False" FocusVisualStyle="{x:Null}" MergeCheckedStates="True" Color="{TemplateBinding Color}" IsChecked="{TemplateBinding IsSelected}">
        <ContentControl x:Name="PART_ContentContainer" Style="{TemplateBinding ActualContentContainerStyle}" Focusable="False" IsTabStop="False">
          <Grid ClipToBounds="True" Focusable="False">
            <dxb:ContentViewport x:Name="PART_Content" KeepPositiveLeftContentPosition="True" VerticalContentAlignment="Center" Grid.Column="0" Focusable="False" dxc:FrameworkElementHelper.IsClipped="True">
              <ContentControl x:Name="PART_UserContent" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ActualContentTemplate}" Style="{TemplateBinding ActualTextStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Focusable="False" IsTabStop="False" />
            </dxb:ContentViewport>
          </Grid>
        </ContentControl>
      </dxr:RibbonCheckedBorderControl>
    </Grid>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Page.(dxcn:AppearanceOptions.HasForeground)}" Value="True">
        <Setter TargetName="PART_UserContent" Property="Foreground" Value="{Binding RelativeSource={RelativeSource Self}, Path=TemplatedParent.Page.(dxcn:AppearanceOptions.Foreground)}" />
      </DataTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=PageHeaderTemplate}" TargetType="{x:Type dxr:RibbonPageHeaderControl}">
    <Grid Focusable="False" MinHeight="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=MinHeight}}">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <dxr:RibbonPageCaptionControl x:Name="PART_CaptionControl" Grid.Column="0" Page="{TemplateBinding Page}" Color="{Binding Page.ActualColor, RelativeSource={RelativeSource Mode=TemplatedParent}}" Margin="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=CaptionControlMargin}}" FocusVisualStyle="{x:Null}" IsTabStop="False" MinWidth="{Binding Path=ActualPageCaptionMinWidth, RelativeSource={RelativeSource Mode=TemplatedParent}}" VerticalAlignment="Bottom" />
      <ContentControl x:Name="PART_Separator" Grid.Column="1" Opacity="{TemplateBinding SeparatorOpacity}" HorizontalAlignment="Right" Focusable="False" IsTabStop="False" Template="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=SeparatorTemplate}}" />
    </Grid>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding Path=Page.Ribbon.RibbonStyle, RelativeSource={RelativeSource Self}}" Value="OfficeSlim">
        <Setter TargetName="PART_Separator" Property="Visibility" Value="Collapsed" />
      </DataTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ItemsPanelTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SelectedPagePanelTemplate}">
    <dxr:RibbonSelectedPageControlItemsPanel />
  </ItemsPanelTemplate>
  <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=RightRepeatButtonStyle}" TargetType="{x:Type RepeatButton}">
    <Setter Property="Template" Value="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=RightRepeatButtonTemplate}}" />
  </Style>
  <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=LeftRepeatButtonStyle}" TargetType="{x:Type RepeatButton}">
    <Setter Property="Template" Value="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=LeftRepeatButtonTemplate}}" />
  </Style>
  <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SelectedPageTemplate}" TargetType="{x:Type dxr:RibbonSelectedPageControl}">
    <dxr:RibbonSelectedPageControlRootPanel x:Name="root">
      <ContentControl Template="{TemplateBinding ActualBorderTemplate}" Focusable="False" IsTabStop="False" DataContext="{Binding Path=SelectedPage.ActualColor, RelativeSource={RelativeSource TemplatedParent}}" />
      <ContentControl Style="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=SelectedPageContainerStyle}}" Focusable="False" IsTabStop="False">
        <Border x:Name="PART_RootBorder">
          <dxr:RibbonPageContentBorder x:Name="PART_AppearanceBorder" Style="{Binding Path=SelectedPage.(dxr:RibbonPage.ContentBorderStyle), RelativeSource={RelativeSource TemplatedParent}}">
            <Grid x:Name="RootGrid">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
              </Grid.ColumnDefinitions>
              <ScrollViewer x:Name="PART_ScrollViewer" Grid.Column="1" BorderThickness="0" VerticalAlignment="Stretch" HorizontalScrollBarVisibility="Hidden" VerticalContentAlignment="Stretch" VerticalScrollBarVisibility="Disabled" Padding="0" Focusable="False" IsTabStop="False">
                <ItemsPresenter x:Name="PART_ItemsPresenter" />
              </ScrollViewer>
              <RepeatButton x:Name="PART_LeftRepeatButton" Visibility="Collapsed" Grid.Column="0" Style="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=LeftRepeatButtonStyle}}" />
              <RepeatButton x:Name="PART_RightRepeatButton" Visibility="Collapsed" Grid.Column="2" Style="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=RightRepeatButtonStyle}}" />
              <dxri:RibbonMinimizationButton x:Name="PART_MinimizationButtonInPageContent" Grid.Column="3" dxcn:WindowChrome.IsHitTestVisibleInChrome="True" VerticalAlignment="Bottom" Visibility="Collapsed" Style="{DynamicResource {dxrt:RibbonThemeKey ResourceKey=MinimizationButtonStyleInPageContent}}" Template="{DynamicResource {dxrt:RibbonThemeKey ResourceKey=MinimizationButtonTemplateInPageContent}}" />
            </Grid>
          </dxr:RibbonPageContentBorder>
        </Border>
      </ContentControl>
    </dxr:RibbonSelectedPageControlRootPanel>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding Path=Ribbon.(dxcn:AppearanceOptions.HasBackground), RelativeSource={RelativeSource Self}}" Value="True">
        <Setter TargetName="PART_RootBorder" Property="Background" Value="{Binding Path=Ribbon.(dxcn:AppearanceOptions.Background), RelativeSource={RelativeSource TemplatedParent}}" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=Ribbon.(dxcn:AppearanceOptions.HasCornerRadius), RelativeSource={RelativeSource Self}}" Value="True">
        <Setter TargetName="PART_RootBorder" Property="CornerRadius" Value="{Binding Path=Ribbon.(dxcn:AppearanceOptions.CornerRadius), RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource cornerRadiusConverter}, ConverterParameter=Bottom}" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=Ribbon.(dxcn:AppearanceOptions.HasBorderThickness), RelativeSource={RelativeSource Self}}" Value="True">
        <Setter TargetName="PART_RootBorder" Property="BorderThickness" Value="{Binding Path=Ribbon.(dxcn:AppearanceOptions.BorderThickness), RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource thicknessConverter}, ConverterParameter=Bottom}" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=Ribbon.(dxcn:AppearanceOptions.HasBorderBrush), RelativeSource={RelativeSource Self}}" Value="True">
        <Setter TargetName="PART_RootBorder" Property="BorderBrush" Value="{Binding Path=Ribbon.(dxcn:AppearanceOptions.BorderBrush), RelativeSource={RelativeSource TemplatedParent}}" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=Ribbon.RibbonStyle, RelativeSource={RelativeSource Mode=Self}}" Value="TabletOffice">
        <Setter TargetName="PART_ScrollViewer" Property="HorizontalAlignment" Value="Center" />
        <Setter TargetName="PART_ScrollViewer" Property="HorizontalScrollBarVisibility" Value="Disabled" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=Ribbon.RibbonStyle, RelativeSource={RelativeSource Mode=Self}}" Value="OfficeSlim">
        <Setter TargetName="PART_ScrollViewer" Property="HorizontalScrollBarVisibility" Value="Disabled" />
      </DataTrigger>
      <Trigger Property="IsInSimplifiedRibbon" Value="True">
        <Setter TargetName="PART_ScrollViewer" Property="HorizontalScrollBarVisibility" Value="Disabled" />
      </Trigger>
      <MultiDataTrigger>
        <MultiDataTrigger.Conditions>
          <Condition Binding="{Binding Path=Ribbon.MinimizationButtonPosition, RelativeSource={RelativeSource Self}}" Value="PageContent" />
          <Condition Binding="{Binding Path=Ribbon.IsMinimizationButtonVisible, RelativeSource={RelativeSource Self}}" Value="True" />
        </MultiDataTrigger.Conditions>
        <Setter TargetName="PART_MinimizationButtonInPageContent" Property="Visibility" Value="Visible" />
      </MultiDataTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="{dxrt:RibbonThemeKey ResourceKey=PageGroupsControlTemplate}" TargetType="{x:Type dxr:RibbonPageGroupsControl}">
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <ItemsPresenter />
      <Grid x:Name="PART_DropDownContainer" Grid.Column="1" Visibility="Collapsed">
        <dxri:RibbonOverflowButton x:Name="PART_OverflowButton" FocusVisualStyle="{x:Null}" Style="{DynamicResource {dxrt:RibbonThemeKey ResourceKey=PageGroupsControlDropDownButtonStyle}}" Template="{DynamicResource {dxrt:RibbonThemeKey ResourceKey=PageGroupsControlDropDownButtonTemplate}}" Focusable="False" IsTabStop="False" />
      </Grid>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsInSimplifiedRibbon" Value="True">
        <Setter TargetName="PART_DropDownContainer" Property="Visibility" Value="Visible" />
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ItemsPanelTemplate x:Key="{dxrt:RibbonThemeKey ResourceKey=PageGroupsControlItemsPanelTemplate}">
    <dxr:RibbonPageGroupsItemsPanel />
  </ItemsPanelTemplate>
  <ControlTemplate x:Key="{dxrt:RibbonThemeKey ResourceKey=PagesControlTemplate}" TargetType="{x:Type dxr:RibbonPagesControl}">
    <ItemsPresenter />
  </ControlTemplate>
  <ItemsPanelTemplate x:Key="{dxrt:RibbonThemeKey ResourceKey=PagesControlItemsPanelTemplate}">
    <dxr:RibbonPagesItemsPanel />
  </ItemsPanelTemplate>
  <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=AeroPageHeaderTemplate}" TargetType="{x:Type dxr:RibbonPageHeaderControl}">
    <Grid Focusable="False" MinHeight="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=AeroMinHeight}}">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <dxr:RibbonPageCaptionControl x:Name="PART_CaptionControl" Grid.Column="0" Page="{TemplateBinding Page}" Color="{Binding Page.ActualColor, RelativeSource={RelativeSource Mode=TemplatedParent}}" Margin="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=CaptionControlMarginInAeroWindow}}" SelectedTextStyle="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=SelectedTextStyleInAeroWindow}}" NormalTextStyle="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=NormalTextStyleInAeroWindow}}" HoverTextStyle="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=HoverTextStyleInAeroWindow}}" NormalTextStyleInMinimizedRibbon="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=NormalTextStyleInAeroWindowInMinimizedRibbon}}" HoverTextStyleInMinimizedRibbon="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=HoverTextStyleInAeroWindowInMinimizedRibbon}}" SelectedTextStyleInMinimizedRibbon="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=SelectedTextStyleInAeroWindowInMinimizedRibbon}}" BorderTemplate="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=CaptionBackgroundTemplateInAeroWindow}}" BorderTemplateInMinimizedRibbon="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=CaptionBackgroundTemplateInAeroWindowInMinimizedRibbon}}" HighlightedBorderTemplate="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=HighlightedCaptionBackgroundTemplateInAeroWindow}}" HighlightedBorderTemplateInMinimizedRibbon="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=HighlightedCaptionBackgroundTemplateInAeroWindowInMinimizedRibbon}}" FocusVisualStyle="{x:Null}" IsTabStop="False" MinWidth="{Binding Path=ActualPageCaptionMinWidth, RelativeSource={RelativeSource Mode=TemplatedParent}}" VerticalAlignment="Bottom" />
      <ContentControl x:Name="PART_Separator" Grid.Column="1" Opacity="{TemplateBinding SeparatorOpacity}" HorizontalAlignment="Right" Focusable="False" IsTabStop="False" Template="{DynamicResource {dxrt:RibbonPageThemeKey ResourceKey=SeparatorTemplateInAeroWindow}}" />
    </Grid>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding Path=Page.Ribbon.RibbonStyle, RelativeSource={RelativeSource Self}}" Value="OfficeSlim">
        <Setter TargetName="PART_Separator" Property="Visibility" Value="Collapsed" />
      </DataTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
</ResourceDictionary>