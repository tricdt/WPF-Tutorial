<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dxgcore="http://schemas.devexpress.com/winfx/2008/xaml/grid" xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid" xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars" xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys" xmlns:dxght="http://schemas.devexpress.com/winfx/2008/xaml/grid/internal" xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" xmlns:dxet="http://schemas.devexpress.com/winfx/2008/xaml/editors/themekeys" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:mvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" xmlns:dxcn="http://schemas.devexpress.com/winfx/2008/xaml/core/internal" xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys">
  <dx:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
  <Style x:Key="{dxgt:CardTemplatesThemeKey ResourceKey=SearchPanelContentTemplate}" TargetType="{x:Type ContentControl}">
    <Setter Property="dx:FocusHelper2.Focusable" Value="False" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate>
          <Grid x:Name="grid" Background="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelBackground}}">
            <dxg:GridSearchControl x:Name="PART_SearchControl" View="{Binding Path=(dxg:GridControl.CurrentView), RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="{Binding Path=(dxg:GridControl.CurrentView).ActualSearchPanelHorizontalAlignment, RelativeSource={RelativeSource TemplatedParent}}" Margin="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWithoutGroupedPanelMargin}}">
              <dxg:GridSearchControl.Visibility>
                <Binding Path="View.ActualShowSearchPanel" RelativeSource="{RelativeSource Self}">
                  <Binding.Converter>
                    <mvvm:BooleanToVisibilityConverter />
                  </Binding.Converter>
                </Binding>
              </dxg:GridSearchControl.Visibility>
            </dxg:GridSearchControl>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="GroupPanelShown" SourceName="PART_SearchControl" Value="True">
              <Setter Property="Margin" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWithGroupedPanelMargin}}" TargetName="PART_SearchControl" />
            </Trigger>
            <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).ActualSearchPanelPosition, RelativeSource={RelativeSource TemplatedParent}}" Value="Default">
              <Setter Property="VerticalAlignment" Value="Top" />
              <Setter TargetName="PART_SearchControl" Property="Margin" Value="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=HeadersButtonMargin}}" />
              <Setter TargetName="PART_SearchControl" Property="AllowAnimation" Value="true" />
              <Setter TargetName="PART_SearchControl" Property="SearchTextBoxMinWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidth}}" />
              <Setter TargetName="grid" Property="Margin">
                <Setter.Value>
                  <Binding Path="(dxg:GridControl.CurrentView).ShowSearchPanelMode" RelativeSource="{RelativeSource TemplatedParent}">
                    <Binding.Converter>
                      <mvvm:ObjectToObjectConverter DefaultSource="Default" DefaultTarget="0">
                        <mvvm:MapItem Source="Always" Target="0,0,4,0" />
                        <mvvm:MapItem Source="HotKey" Target="0" />
                        <mvvm:MapItem Source="Never" Target="0" />
                      </mvvm:ObjectToObjectConverter>
                    </Binding.Converter>
                  </Binding>
                </Setter.Value>
              </Setter>
            </DataTrigger>
            <Trigger Property="dx:ThemeManager.IsTouchlineTheme" Value="True">
              <Setter TargetName="PART_SearchControl" Property="SearchTextBoxMinWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidthTouch}}" />
            </Trigger>
            <Trigger Property="dx:ThemeManager.IsTouchEnabled" Value="True">
              <Setter TargetName="PART_SearchControl" Property="SearchTextBoxMinWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidthTouch}}" />
            </Trigger>
            <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).ActualSearchPanelPosition, RelativeSource={RelativeSource TemplatedParent}}" Value="OverGroupPanel">
              <Setter TargetName="PART_SearchControl" Property="SearchTextBoxMinWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelTextBoxMinWidth}}" />
            </DataTrigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <DataTemplate x:Key="{dxgt:CardTemplatesThemeKey ResourceKey=CardHeaderTemplate}">
    <TextBlock Text="{Binding Path=Value}" />
  </DataTemplate>
  <ControlTemplate x:Key="{dxgt:CardTemplatesThemeKey ResourceKey=CellContentPresenterTemplate}" TargetType="{x:Type dxgcore:CellContentPresenter}">
    <Border x:Name="ContentBorder" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" CornerRadius="{TemplateBinding Border.CornerRadius}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}">
      <dxg:CellEditor x:Name="PART_CellEditor" Margin="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=CellEditorMargin}}" ClipToBounds="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=ClipCellEditor}}" />
    </Border>
  </ControlTemplate>
  <DataTemplate x:Key="{dxgt:CardTemplatesThemeKey ResourceKey=CardRowTemplate}">
    <Grid x:Name="grid" dxg:GridColumn.NavigationIndex="{Binding Path=DataContext.Column.ActualVisibleIndex, RelativeSource={RelativeSource TemplatedParent}}">
      <Grid.ColumnDefinitions>
        <ColumnDefinition SharedSizeGroup="cardRowDescription" />
        <ColumnDefinition Width="6" />
        <ColumnDefinition />
      </Grid.ColumnDefinitions>
      <TextBlock Style="{DynamicResource {dxgt:CardTemplatesThemeKey ResourceKey=CardRowHeaderTextStyle}}">
        <TextBlock.Text>
          <Binding Path="Column.HeaderCaption">
            <Binding.Converter>
              <dx:FormatStringConverter FormatString="{}{0}:" />
            </Binding.Converter>
          </Binding>
        </TextBlock.Text>
        <dxg:GridViewHitInfoBase.HitTestAcceptor>
          <dxght:FieldCaptionCardViewHitTestAcceptor />
        </dxg:GridViewHitInfoBase.HitTestAcceptor>
      </TextBlock>
      <dxg:CardCellContentPresenter x:Name="cell" Grid.Column="2" Column="{Binding Path=DataContext.Column, RelativeSource={RelativeSource TemplatedParent}}" CellStyle="{Binding Path=DataContext.Column.ActualCellStyle, RelativeSource={RelativeSource TemplatedParent}}" />
    </Grid>
  </DataTemplate>
  <DataTemplate x:Key="{dxgt:CardTemplatesThemeKey ResourceKey=CardTemplate}">
    <dxg:CardItemsControl x:Name="cardItemsControl" ItemsSource="{Binding Path=CellData}">
      <dxg:CardItemsControl.ItemTemplate>
        <DataTemplate>
          <dx:DataContentPresenter ContentTemplateSelector="{Binding Path=(dxg:GridControl.ActiveView).ActualCardRowTemplateSelector, RelativeSource={RelativeSource TemplatedParent}}" />
        </DataTemplate>
      </dxg:CardItemsControl.ItemTemplate>
      <dxg:CardItemsControl.ItemsPanel>
        <ControlTemplate>
          <dx:StackVisibleIndexPanel ArrangeAccordingToVisibleIndex="True" Orientation="Vertical" />
        </ControlTemplate>
      </dxg:CardItemsControl.ItemsPanel>
    </dxg:CardItemsControl>
  </DataTemplate>
  <DataTemplate x:Key="{dxgt:CardViewThemeKey ResourceKey=HeaderTemplate}">
    <ContentPresenter Content="{Binding}" Margin="3" VerticalAlignment="Center" TextBlock.FontSize="14" UseLayoutRounding="True" />
  </DataTemplate>
  <ControlTemplate x:Key="{dxgt:CardViewThemeKey ResourceKey=TopPanel}">
    <Grid x:Name="TopGrid">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <Border x:Name="headerContent" Grid.Row="0" Grid.ColumnSpan="3" Background="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=GroupPanelBackground}}">
        <ContentControl HorizontalAlignment="{Binding Path=(dxg:GridControl.CurrentView).HeaderHorizontalAlignment, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=HeaderTemplate}}" Content="{Binding Path=(dxg:GridControl.CurrentView).Header, RelativeSource={RelativeSource TemplatedParent}}" Margin="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=HeaderMargin}}" />
        <Border.Visibility>
          <Binding Path="(dxg:GridControl.CurrentView).Header" RelativeSource="{RelativeSource TemplatedParent}">
            <Binding.Converter>
              <dx:ObjectToVisibilityConverter HandleList="False" />
            </Binding.Converter>
          </Binding>
        </Border.Visibility>
      </Border>
      <Border x:Name="borderSearchPanel" Grid.Row="1" Grid.ColumnSpan="3" Grid.Column="1" Background="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=GroupPanelBackground}}">
        <Grid ClipToBounds="True">
          <ContentControl x:Name="part_SearchControlContainer" dxg:GridControl.CurrentView="{Binding Path=(dxg:GridControl.CurrentView), RelativeSource={RelativeSource TemplatedParent}}" Visibility="{Binding Path=(dxg:GridControl.CurrentView).ActualShowSearchPanel, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" Style="{DynamicResource {dxgt:CardTemplatesThemeKey ResourceKey=SearchPanelContentTemplate}}" Margin="0,0,-4,0">
            <dxg:GridViewHitInfoBase.HitTestAcceptor>
              <dxght:GridSearchPanelHitTestAcceptor />
            </dxg:GridViewHitInfoBase.HitTestAcceptor>
          </ContentControl>
          <Button Grid.Column="2" Grid.Row="2" x:Name="searchPanelShowButton" Command="{Binding Path=(dxg:GridControl.CurrentView).Commands.ShowSearchPanel, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="True" Style="{DynamicResource {dxet:SearchControlThemeKey ResourceKey=ShowButtonStyle}}" VerticalAlignment="Top" Margin="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=HeadersButtonMargin}}">
            <Button.Content>
              <Path Fill="{Binding Path=(TextElement.Foreground), RelativeSource={RelativeSource Self}}" Stretch="Fill" Height="14" Width="14" HorizontalAlignment="Center" VerticalAlignment="Center" Data="F1 M 4,1.90735e-006C 6.20914,1.90735e-006 8,1.79086 8,4C 8,4.84917 7.73539,5.63653 7.28414,6.28414L 10,9L 9,10L 6.28414,7.28414C 5.63653,7.7354 4.84917,8 4,8C 1.79086,8 0,6.20914 0,4C 0,1.79086 1.79086,1.90735e-006 4,1.90735e-006 Z M 4,1C 2.34315,1 1,2.34315 1,4C 1,5.65686 2.34315,7 4,7C 5.65685,7 7,5.65686 7,4C 7,2.34315 5.65685,1 4,1 Z " />
            </Button.Content>
            <Button.Visibility>
              <MultiBinding>
                <MultiBinding.Bindings>
                  <Binding Path="(dxgcore:DataControlBase.CurrentView).ActualShowSearchPanel" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="(dxgcore:DataControlBase.CurrentView).ActualSearchPanelPosition" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="(dxgcore:DataControlBase.CurrentView).ShowSearchPanelMode" RelativeSource="{RelativeSource TemplatedParent}" />
                </MultiBinding.Bindings>
                <MultiBinding.Converter>
                  <dxg:SearchPanelShowButtonVisibilityConverter />
                </MultiBinding.Converter>
              </MultiBinding>
            </Button.Visibility>
            <dxg:GridViewHitInfoBase.HitTestAcceptor>
              <dxght:SearchPanelShowButtonHitTestAcceptor />
            </dxg:GridViewHitInfoBase.HitTestAcceptor>
          </Button>
        </Grid>
      </Border>
      <Border Grid.Row="2" x:Name="PART_GroupPanel" Grid.ColumnSpan="3" dxg:GridControl.CurrentView="{Binding Path=(dxg:GridControl.CurrentView), RelativeSource={RelativeSource TemplatedParent}}" Background="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=GroupPanelBackground}}">
        <dxg:GridControl.CurrentViewChangedListener>
          <dxg:GroupPanelInitializer />
        </dxg:GridControl.CurrentViewChangedListener>
        <dxg:GridViewHitInfoBase.HitTestAcceptor>
          <dxght:GroupPanelTableViewHitTestAcceptor />
        </dxg:GridViewHitInfoBase.HitTestAcceptor>
        <Grid x:Name="grid" Margin="8">
          <TextBlock x:Name="GroupPanelDragText" Style="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=GroupPanelDragTextStyle}}">
            <TextBlock.Text>
              <Binding Path="(dxg:GridControl.CurrentView).LocalizationDescriptor" RelativeSource="{RelativeSource TemplatedParent}" ConverterParameter="GridGroupPanelText">
                <Binding.Converter>
                  <dxg:DynamicLocalizationStringValueConvertor />
                </Binding.Converter>
              </Binding>
            </TextBlock.Text>
          </TextBlock>
          <dxg:ColumnItemsControl ItemsSource="{Binding Path=(dxg:GridControl.CurrentView).GroupedColumns, RelativeSource={RelativeSource TemplatedParent}}" x:Name="groupPanelItemsControl" Style="{DynamicResource {dxgt:GroupRowThemeKey IsVisibleInBlend=True, ResourceKey=GroupItemsControlStyle}}" dxb:BarManager.DXContextMenu="{Binding Path=(dxg:GridControl.ActiveView).GridMenu, RelativeSource={RelativeSource TemplatedParent}}" dxg:GridPopupMenu.GridMenuType="GroupPanel" />
        </Grid>
      </Border>
    </Grid>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).HeaderPosition, RelativeSource={RelativeSource Self}}" Value="SearchPanel">
        <Setter TargetName="borderSearchPanel" Property="Grid.Row" Value="0" />
        <Setter TargetName="borderSearchPanel" Property="Grid.Column" Value="1" />
        <Setter TargetName="borderSearchPanel" Property="Grid.ColumnSpan" Value="2" />
        <Setter TargetName="headerContent" Property="Grid.ColumnSpan" Value="1" />
        <Setter TargetName="headerContent" Property="Grid.Column" Value="0" />
        <Setter TargetName="headerContent" Property="Grid.Row" Value="0" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).ShowGroupPanel, RelativeSource={RelativeSource TemplatedParent}}" Value="false">
        <Setter Property="Visibility" TargetName="PART_GroupPanel" Value="Collapsed" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).DataControl.IsGrouped, RelativeSource={RelativeSource TemplatedParent}}" Value="true">
        <Setter Property="Visibility" TargetName="GroupPanelDragText" Value="Collapsed" />
      </DataTrigger>
      <Trigger Property="dx:ThemeManager.IsTouchlineTheme" Value="False">
        <Setter TargetName="part_SearchControlContainer" Property="MaxWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidth}}" />
      </Trigger>
      <Trigger Property="dx:ThemeManager.IsTouchEnabled" Value="False">
        <Setter TargetName="part_SearchControlContainer" Property="MaxWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidth}}" />
      </Trigger>
      <Trigger Property="dx:ThemeManager.IsTouchlineTheme" Value="True">
        <Setter TargetName="grid" Property="Margin" Value="8,10,8,10" />
        <Setter TargetName="GroupPanelDragText" Property="Margin" Value="0,10,0,14" />
        <Setter TargetName="part_SearchControlContainer" Property="MaxWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidthTouch}}" />
      </Trigger>
      <Trigger Property="dx:ThemeManager.IsTouchEnabled" Value="True">
        <Setter Property="Margin" TargetName="grid" Value="14" />
        <Setter TargetName="part_SearchControlContainer" Property="MaxWidth" Value="{DynamicResource {dxgt:TableViewThemeKey ResourceKey=SearchPanelWidthTouch}}" />
      </Trigger>
      <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).ActualSearchPanelPosition, RelativeSource={RelativeSource Self}}" Value="OverGroupPanel">
        <Setter TargetName="part_SearchControlContainer" Property="Width" Value="NaN" />
        <Setter TargetName="part_SearchControlContainer" Property="MaxWidth" Value="Infinity" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=(dxgcore:DataControlBase.CurrentView).ActualSearchPanelPosition, RelativeSource={RelativeSource TemplatedParent}}" Value="Default">
        <Setter TargetName="headerContent" Property="Grid.ColumnSpan" Value="3" />
        <Setter TargetName="headerContent" Property="Grid.Column" Value="0" />
        <Setter TargetName="headerContent" Property="Grid.Row" Value="0" />
        <Setter TargetName="borderSearchPanel" Property="Grid.Row" Value="2" />
        <Setter TargetName="borderSearchPanel" Property="Grid.Column" Value="2" />
        <Setter TargetName="borderSearchPanel" Property="Grid.ColumnSpan" Value="1" />
        <Setter TargetName="PART_GroupPanel" Property="Grid.ColumnSpan" Value="2" />
        <Setter TargetName="PART_GroupPanel" Property="Grid.Column" Value="0" />
        <Setter TargetName="PART_GroupPanel" Property="Grid.Row" Value="2" />
        <Setter TargetName="borderSearchPanel" Property="Background" Value="{DynamicResource {dxgt:CardViewThemeKey ResourceKey=GroupPanelBackground}}" />
        <Setter TargetName="part_SearchControlContainer" Property="Width">
          <Setter.Value>
            <MultiBinding>
              <MultiBinding.Bindings>
                <Binding Path="ActualWidth" ElementName="TopGrid" />
                <Binding Path="MaxWidth" RelativeSource="{RelativeSource Self}" />
              </MultiBinding.Bindings>
              <MultiBinding.Converter>
                <dxg:SearchPanelWidthConverter Delta="10" />
              </MultiBinding.Converter>
            </MultiBinding>
          </Setter.Value>
        </Setter>
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).HeaderPosition, RelativeSource={RelativeSource Self}}" Value="CompactPanel">
        <Setter TargetName="headerContent" Property="Visibility" Value="Collapsed" />
      </DataTrigger>
      <DataTrigger Binding="{Binding Path=(dxg:GridControl.CurrentView).DataControl.(dxcn:AppearanceOptions.HasBackground), RelativeSource={RelativeSource Self}}" Value="True">
        <Setter TargetName="headerContent" Property="Background" Value="{Binding Path=(dxg:GridControl.CurrentView).DataControl.(dxcn:AppearanceOptions.Background), RelativeSource={RelativeSource Self}}" />
        <Setter TargetName="borderSearchPanel" Property="Background" Value="{Binding Path=(dxg:GridControl.CurrentView).DataControl.(dxcn:AppearanceOptions.Background), RelativeSource={RelativeSource Self}}" />
        <Setter TargetName="PART_GroupPanel" Property="Background" Value="{Binding Path=(dxg:GridControl.CurrentView).DataControl.(dxcn:AppearanceOptions.Background), RelativeSource={RelativeSource Self}}" />
      </DataTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
</ResourceDictionary>