<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dxt="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys" xmlns:dxdash="http://schemas.devexpress.com/winfx/2008/xaml/dashboard" xmlns:dxdashi="http://schemas.devexpress.com/winfx/2008/xaml/dashboard/internal" xmlns:dxm="http://schemas.devexpress.com/winfx/2008/xaml/map" xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" xmlns:dasboardthemes="http://schemas.devexpress.com/winfx/2008/xaml/dashboard/themekeys" xmlns:dxdasht="http://schemas.devexpress.com/winfx/2008/xaml/dashboard/themekeys" xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys">
  <dxdashi:EventToCommandConverter x:Key="EventToCommandConverter" />
  <dxdashi:LegendLabelConverter x:Key="LegendLabelConverter" />
  <DataTemplate x:Key="LegendLabelTemplate">
    <TextBlock Text="{Binding Converter={StaticResource ResourceKey=LegendLabelConverter}}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=DashboardColorListLegendTemplate}">
    <dxm:ColorListLegend Visibility="{Binding ColorListLegendVisibility}" Alignment="{Binding ColorLegendAlignment}" ItemLabelTemplate="{StaticResource LegendLabelTemplate}" Tag="{Binding ColorLegendFormatter}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=DashboardColorScaleLegendTemplate}">
    <dxm:ColorScaleLegend Visibility="{Binding ColorScaleLegendVisibility}" Alignment="{Binding ColorLegendAlignment}" ItemLabelTemplate="{StaticResource LegendLabelTemplate}" Tag="{Binding ColorLegendFormatter}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=BubbleColorListLegendTemplate}">
    <dxm:ColorListLegend Visibility="{Binding BubbleColorListLegendVisibility}" Alignment="{Binding ColorLegendAlignment}" ItemLabelTemplate="{StaticResource LegendLabelTemplate}" Tag="{Binding ColorLegendFormatter}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=BubbleColorScaleLegendTemplate}">
    <dxm:ColorScaleLegend Visibility="{Binding BubbleColorScaleLegendVisibility}" Alignment="{Binding ColorLegendAlignment}" ItemLabelTemplate="{StaticResource LegendLabelTemplate}" Tag="{Binding ColorLegendFormatter}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=BubbleSizeLegendTemplate}">
    <dxm:SizeLegend Type="{Binding SizeLegendMode}" Alignment="{Binding SizeLegendAlignment}" Visibility="{Binding BubbleSizeVisibility}" ItemLabelTemplate="{StaticResource LegendLabelTemplate}" Tag="{Binding SizeLegendFormatter}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=PieColorListLegendTemplate}">
    <dxm:ColorListLegend Visibility="{Binding PieColorListLegendVisibility}" Alignment="{Binding ColorLegendAlignment}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=PieColorScaleLegendTemplate}">
    <dxm:ColorScaleLegend Visibility="{Binding PieColorScaleLegendVisibility}" Alignment="{Binding ColorLegendAlignment}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=PieSizeLegendTemplate}">
    <dxm:SizeLegend Type="{Binding SizeLegendMode}" Alignment="{Binding SizeLegendAlignment}" Visibility="{Binding PieSizeVisibility}" ItemLabelTemplate="{StaticResource LegendLabelTemplate}" Tag="{Binding SizeLegendFormatter}" />
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=DashboardsLayerTemplate}">
    <ContentControl>
      <dxm:VectorLayer x:Name="DashboardsLayer" SelectedItems="{Binding SelectedItems}">
        <dxm:VectorLayer.Resources>
          <dxm:ListSourceDataAdapter DataSource="{Binding Items}" x:Key="dashboardsLayerDataAdapter" />
          <dxm:ShapeTitleOptions VisibilityMode="{Binding ShapeTitlesVisibility}" Pattern="{Binding ShapeTitlesPattern}" x:Key="dashboardsLayerShapeTitleOptions" />
          <dxm:ChoroplethColorizer RangeStops="{Binding Colorizer.RangeStops}" Colors="{Binding Colorizer.Colors}" x:Key="choroplethColorizer">
            <dxm:ChoroplethColorizer.ValueProvider>
              <dxm:ShapeAttributeValueProvider AttributeName="{Binding Colorizer.AttributeName}" />
            </dxm:ChoroplethColorizer.ValueProvider>
          </dxm:ChoroplethColorizer>
        </dxm:VectorLayer.Resources>
        <dxmvvm:Interaction.Behaviors>
          <dxmvvm:EventToCommand EventName="ViewportChanged" Command="{Binding OnViewportChangedCommand}" PassEventArgsToCommand="True" />
        </dxmvvm:Interaction.Behaviors>
        <dxm:VectorLayer.Data>
          <Binding Source="{StaticResource dashboardsLayerDataAdapter}" />
        </dxm:VectorLayer.Data>
        <dxm:VectorLayer.ShapeTitleOptions>
          <Binding Source="{StaticResource dashboardsLayerShapeTitleOptions}" />
        </dxm:VectorLayer.ShapeTitleOptions>
        <dxm:VectorLayer.Colorizer>
          <Binding Source="{StaticResource choroplethColorizer}" />
        </dxm:VectorLayer.Colorizer>
      </dxm:VectorLayer>
    </ContentControl>
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=BubbleLayerTemplate}">
    <dxm:VectorLayer x:Name="BubbleLayer" SelectedItems="{Binding BubblesSelection}">
      <dxm:VectorLayer.Resources>
        <dxm:BubbleChartDataAdapter DataSource="{Binding Bubbles}" ItemMinSize="20" ItemMaxSize="{Binding BubbleMaxSize}" x:Key="bubbleDataAdapter">
          <dxm:BubbleChartDataAdapter.AttributeMappings>
            <dxm:MapItemAttributeMapping Name="LatitudeSelection" Member="LatitudeSelection" />
            <dxm:MapItemAttributeMapping Name="LongitudeSelection" Member="LongitudeSelection" />
            <dxm:MapItemAttributeMapping Name="TooltipDimensions" Member="TooltipDimensions" />
            <dxm:MapItemAttributeMapping Name="TooltipMeasures" Member="TooltipMeasures" />
            <dxm:MapItemAttributeMapping Name="MainTooltip" Member="MainTooltip" />
            <dxm:MapItemAttributeMapping Name="Weight" Member="Weight" />
            <dxm:MapItemAttributeMapping Name="Color" Member="Color" />
            <dxm:MapItemAttributeMapping Name="ClusteredCount" Member="ClusteredCount" />
          </dxm:BubbleChartDataAdapter.AttributeMappings>
          <dxm:BubbleChartDataAdapter.Mappings>
            <dxm:MapBubbleMappingInfo Latitude="Latitude" Longitude="Longitude" Value="Weight" />
          </dxm:BubbleChartDataAdapter.Mappings>
          <dxm:BubbleChartDataAdapter.MeasureRules>
            <dxm:MeasureRules RangeStops="{Binding BubbleRangeStops}">
              <dxm:MeasureRules.ValueProvider>
                <dxm:ItemAttributeValueProvider AttributeName="Weight" />
              </dxm:MeasureRules.ValueProvider>
            </dxm:MeasureRules>
          </dxm:BubbleChartDataAdapter.MeasureRules>
          <dxmvvm:Interaction.Behaviors>
            <dxmvvm:EventToCommand EventName="CustomizeMapItem" Command="{Binding Path=Owner.CustomizeMapItemCommand}" PassEventArgsToCommand="True" />
          </dxmvvm:Interaction.Behaviors>
        </dxm:BubbleChartDataAdapter>
        <dxm:ChoroplethColorizer RangeStops="{Binding Colorizer.RangeStops}" Colors="{Binding Colorizer.Colors}" x:Key="bubbleColorizer">
          <dxm:ChoroplethColorizer.ValueProvider>
            <dxm:ShapeAttributeValueProvider AttributeName="{Binding Colorizer.AttributeName}" />
          </dxm:ChoroplethColorizer.ValueProvider>
        </dxm:ChoroplethColorizer>
      </dxm:VectorLayer.Resources>
      <dxm:VectorLayer.Data>
        <Binding Source="{StaticResource bubbleDataAdapter}" />
      </dxm:VectorLayer.Data>
      <dxm:VectorLayer.Colorizer>
        <Binding Source="{StaticResource bubbleColorizer}" />
      </dxm:VectorLayer.Colorizer>
    </dxm:VectorLayer>
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=GeoPointLayerTemplate}">
    <dxm:VectorLayer x:Name="GeoPointLayer" SelectedItems="{Binding GeoPointSelection}">
      <dxm:VectorLayer.Resources>
        <dxm:ListSourceDataAdapter DataSource="{Binding GeoPoints}" x:Key="geoPointDataAdapter">
          <dxmvvm:Interaction.Behaviors>
            <dxmvvm:EventToCommand EventName="CustomizeMapItem" Command="{Binding Path=Owner.CustomizeMapItemCommand}" PassEventArgsToCommand="True" />
          </dxmvvm:Interaction.Behaviors>
          <dxm:ListSourceDataAdapter.ItemSettings>
            <dxm:MapCustomElementSettings>
              <dxm:MapCustomElementSettings.ContentTemplate>
                <DataTemplate>
                  <Grid Margin="-13, -13">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto" />
                      <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid>
                      <Border x:Name="Stroke" Background="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=GeoPointBorderBrush}}" Opacity="0.38" CornerRadius="45" Width="26" Height="26" />
                      <Border x:Name="Point" Background="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=GeoPointBackgroundBrush}}" BorderBrush="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=GeoPointBorderBrush}}" BorderThickness="2" Width="{Binding PointSize}" Height="{Binding PointSize}" CornerRadius="45" />
                    </Grid>
                    <TextBlock Foreground="{Binding DisplayTextForeground}" FontWeight="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=GeoPointDisplayTextFontWeight}}" FontSize="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=GeoPointDisplayTextFontSize}}" Margin="8,0,0,0" Grid.Column="1" Text="{Binding DisplayText}" />
                  </Grid>
                  <DataTemplate.Triggers>
                    <DataTrigger Binding="{Binding Highlighted}" Value="True">
                      <DataTrigger.Setters>
                        <Setter Property="Background" TargetName="Point" Value="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=GeoPointHighLightedBackgroundBrush}}" />
                      </DataTrigger.Setters>
                    </DataTrigger>
                  </DataTemplate.Triggers>
                </DataTemplate>
              </dxm:MapCustomElementSettings.ContentTemplate>
            </dxm:MapCustomElementSettings>
          </dxm:ListSourceDataAdapter.ItemSettings>
          <dxm:ListSourceDataAdapter.Mappings>
            <dxm:MapItemMappingInfo Latitude="Latitude" Longitude="Longitude" />
          </dxm:ListSourceDataAdapter.Mappings>
        </dxm:ListSourceDataAdapter>
      </dxm:VectorLayer.Resources>
      <dxm:VectorLayer.Data>
        <Binding Source="{StaticResource geoPointDataAdapter}" />
      </dxm:VectorLayer.Data>
    </dxm:VectorLayer>
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=ClusteredGeoPointLayerTemplate}">
    <dxm:VectorLayer x:Name="ClusteredGeoPointLayer" SelectedItems="{Binding GeoPointClusteredSelection}">
      <dxm:VectorLayer.Resources>
        <dxm:BubbleChartDataAdapter DataSource="{Binding ClusteredGeoPoints}" ItemMinSize="30" ItemMaxSize="{Binding ClusteredGeoPointMaxSize}" x:Key="clusteredGeoPointDataAdapter">
          <dxmvvm:Interaction.Behaviors>
            <dxmvvm:EventToCommand EventName="CustomizeMapItem" Command="{Binding Path=Owner.CustomizeMapItemCommand}" PassEventArgsToCommand="True" />
          </dxmvvm:Interaction.Behaviors>
          <dxm:BubbleChartDataAdapter.AttributeMappings>
            <dxm:MapItemAttributeMapping Name="LatitudeSelection" Member="LatitudeSelection" />
            <dxm:MapItemAttributeMapping Name="LongitudeSelection" Member="LongitudeSelection" />
            <dxm:MapItemAttributeMapping Name="TooltipDimensions" Member="TooltipDimensions" />
            <dxm:MapItemAttributeMapping Name="TooltipMeasures" Member="TooltipMeasures" />
            <dxm:MapItemAttributeMapping Name="MainTooltip" Member="MainTooltip" />
            <dxm:MapItemAttributeMapping Name="Value" Member="Value" />
            <dxm:MapItemAttributeMapping Name="ClusteredCount" Member="ClusteredCount" />
          </dxm:BubbleChartDataAdapter.AttributeMappings>
          <dxm:BubbleChartDataAdapter.Mappings>
            <dxm:MapBubbleMappingInfo Latitude="Latitude" Longitude="Longitude" Value="ClusteredCount" />
          </dxm:BubbleChartDataAdapter.Mappings>
          <dxm:BubbleChartDataAdapter.MeasureRules>
            <dxm:MeasureRules RangeStops="{Binding ClusteredGeoPointRangeStops}">
              <dxm:MeasureRules.ValueProvider>
                <dxm:ItemAttributeValueProvider AttributeName="ClusteredCount" />
              </dxm:MeasureRules.ValueProvider>
            </dxm:MeasureRules>
          </dxm:BubbleChartDataAdapter.MeasureRules>
        </dxm:BubbleChartDataAdapter>
        <dxm:ChoroplethColorizer RangeStops="{Binding Colorizer.RangeStops}" Colors="{Binding Colorizer.Colors}" x:Key="clusteredGeoPointColorizer">
          <dxm:ChoroplethColorizer.ValueProvider>
            <dxm:ShapeAttributeValueProvider AttributeName="{Binding Colorizer.AttributeName}" />
          </dxm:ChoroplethColorizer.ValueProvider>
        </dxm:ChoroplethColorizer>
      </dxm:VectorLayer.Resources>
      <dxm:VectorLayer.Data>
        <Binding Source="{StaticResource clusteredGeoPointDataAdapter}" />
      </dxm:VectorLayer.Data>
      <dxm:VectorLayer.Colorizer>
        <Binding Source="{StaticResource clusteredGeoPointColorizer}" />
      </dxm:VectorLayer.Colorizer>
    </dxm:VectorLayer>
  </DataTemplate>
  <DataTemplate x:Key="{dxdasht:MapItemThemeKey ResourceKey=PieLayerTemplate}">
    <dxm:VectorLayer x:Name="PieLayer" SelectedItems="{Binding PieSelection}">
      <dxm:VectorLayer.Resources>
        <dxm:ListSourceDataAdapter DataSource="{Binding PieData}" x:Key="pieSource" />
        <dxm:PieChartDataAdapter x:Key="segmentSource" ItemMinSize="20" ItemMaxSize="60" ItemIdDataMember="PieItemDataMember" DataSource="{Binding PieSegmentData}">
          <dxmvvm:Interaction.Behaviors>
            <dxmvvm:EventToCommand EventName="CustomizeMapItem" Command="{Binding Path=Owner.CustomizeMapItemCommand}" PassEventArgsToCommand="True" />
          </dxmvvm:Interaction.Behaviors>
          <dxm:PieChartDataAdapter.AttributeMappings>
            <dxm:MapItemAttributeMapping Name="LatitudeSelection" Member="LatitudeSelection" />
            <dxm:MapItemAttributeMapping Name="LongitudeSelection" Member="LongitudeSelection" />
            <dxm:MapItemAttributeMapping Name="TooltipDimensions" Member="TooltipDimensions" />
            <dxm:MapItemAttributeMapping Name="TooltipMeasures" Member="TooltipMeasures" />
            <dxm:MapItemAttributeMapping Name="MainTooltip" Member="MainTooltip" />
            <dxm:MapItemAttributeMapping Name="ClusteredCount" Member="ClusteredCount" />
          </dxm:PieChartDataAdapter.AttributeMappings>
          <dxm:PieChartDataAdapter.Mappings>
            <dxm:MapPieMappingInfo Latitude="Latitude" Longitude="Longitude" SegmentId="Argument" SegmentValue="Value" />
          </dxm:PieChartDataAdapter.Mappings>
          <dxm:PieChartDataAdapter.MeasureRules>
            <dxm:MeasureRules RangeStops="{Binding PieRangeStops}" />
          </dxm:PieChartDataAdapter.MeasureRules>
        </dxm:PieChartDataAdapter>
        <dx:BoolToObjectConverter TrueValue="{StaticResource segmentSource}" FalseValue="{StaticResource pieSource}" x:Key="pieDataConverter" />
        <dxm:KeyColorColorizer Keys="{Binding KeyColorColorizer.Keys}" Colors="{Binding KeyColorColorizer.Colors}" x:Key="pieColorizer">
          <dxm:KeyColorColorizer.ItemKeyProvider>
            <dxm:IdItemKeyProvider />
          </dxm:KeyColorColorizer.ItemKeyProvider>
        </dxm:KeyColorColorizer>
      </dxm:VectorLayer.Resources>
      <dxm:VectorLayer.Data>
        <Binding Path="WeightedPies" Converter="{StaticResource pieDataConverter}" />
      </dxm:VectorLayer.Data>
      <dxm:VectorLayer.Colorizer>
        <Binding Source="{StaticResource pieColorizer}" />
      </dxm:VectorLayer.Colorizer>
    </dxm:VectorLayer>
  </DataTemplate>
  <dxdasht:MapLegendTemplateSelector x:Key="{dasboardthemes:MapItemThemeKey ResourceKey=LegendTemplateSelector}" />
  <dxdasht:MapLayerTemplateSelector x:Key="{dasboardthemes:MapItemThemeKey ResourceKey=LayerTemplateSelector}" />
  <Style x:Key="{dasboardthemes:MapItemThemeKey ResourceKey=ViewStyle}" TargetType="dxm:MapControl">
    <Setter Property="MinZoomLevel" Value="0.1" />
    <Setter Property="ZoomLevel" Value="{Binding ZoomLevel, Mode=TwoWay}" />
    <Setter Property="CenterPoint" Value="{Binding CenterPoint, Mode=TwoWay}" />
    <Setter Property="EnableScrolling" Value="{Binding EnableNavigation}" />
    <Setter Property="EnableZooming" Value="{Binding EnableNavigation}" />
    <Setter Property="UseSprings" Value="False" />
    <Setter Property="SelectionMode" Value="None" />
    <Setter Property="CoordinatesPanelOptions">
      <Setter.Value>
        <dxm:CoordinatesPanelOptions Visible="False" />
      </Setter.Value>
    </Setter>
    <Setter Property="ScrollButtonsOptions">
      <Setter.Value>
        <dxm:ScrollButtonsOptions Visible="False" />
      </Setter.Value>
    </Setter>
    <Setter Property="ZoomTrackbarOptions">
      <Setter.Value>
        <dxm:ZoomTrackbarOptions Visible="False" />
      </Setter.Value>
    </Setter>
    <Setter Property="ScalePanelOptions">
      <Setter.Value>
        <dxm:ScalePanelOptions Visible="False" />
      </Setter.Value>
    </Setter>
    <Setter Property="dxmvvm:Interaction.BehaviorsTemplate">
      <Setter.Value>
        <DataTemplate>
          <ItemsControl>
            <dxdashi:MapItemElementGenerator LayersSource="{Binding Layers}" LayerTemplateSelector="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=LayerTemplateSelector}}" LegendsSource="{Binding Legends}" LegendTemplateSelector="{DynamicResource {dasboardthemes:MapItemThemeKey ResourceKey=LegendTemplateSelector}}" />
            <dxdashi:MapControlToolTipService UnregisterOnUnloaded="True">
              <dxdashi:MapControlToolTipService.ToolTip>
                <ItemsControl ItemsSource="{Binding ToolTipItems}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Text}" FontWeight="{Binding FontWeight}" />
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </dxdashi:MapControlToolTipService.ToolTip>
            </dxdashi:MapControlToolTipService>
            <dxmvvm:EventToCommand EventName="KeyUp" Command="{Binding OnKeyUpCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="KeyDown" Command="{Binding OnKeyDownCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="SizeChanged" Command="{Binding OnSizeChangedCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="MouseUp" Command="{Binding OnMouseUpCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="MouseDoubleClick" Command="{Binding OnMouseDoubleClickCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="MouseDown" Command="{Binding OnMouseDownCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="MouseMove" Command="{Binding OnMouseMoveCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="MouseWheel" Command="{Binding OnMouseWheelCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
            <dxmvvm:EventToCommand EventName="SelectionChanging" Command="{Binding OnSelectionChangingCommand}" PassEventArgsToCommand="True" EventArgsConverter="{StaticResource EventToCommandConverter}" />
          </ItemsControl>
        </DataTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <DataTemplate x:Key="{dasboardthemes:MapItemThemeKey ResourceKey=Template}">
    <dxm:MapControl Style="{Binding Path=(dxdash:DashboardLayoutItem.ViewStyle), RelativeSource={RelativeSource TemplatedParent}}" />
  </DataTemplate>
</ResourceDictionary>