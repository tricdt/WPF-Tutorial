<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                    xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys"
                    xmlns:dxsps="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet"
                    xmlns:dxspsi="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet/internal"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:themes="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet/themekeys"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ResourceDictionary.MergedDictionaries>
        <dxdst:ResourceDictionaryEx Source="/DevExpress.Xpf.Themes.LightGray.v24.1;component/DevExpress.Xpf.Spreadsheet/Generic/DefaultStyles.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <dx:EnumToVisibilityConverter x:Key="EnumToVisibilityConverter"/>

    <dx:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

    <dx:BoolToVisibilityInverseConverter x:Key="BoolToVisibilityInverseConverter"/>

    <dx:ColorOverlayConverter x:Key="ColorOverlayConveter"/>

    <Color x:Key="{themes:SpreadsheetThemeKey ResourceKey=GridLinesColor}">#FFD3D3D3</Color>

    <Color x:Key="GlyphColor">#FF333333</Color>

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=CellStyleGalleryBarItemHeight}">75</sys:Double>

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=TableStyleGalleryBarItemHeight}">65</sys:Double>

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=ChartLayoutGalleryBarItemHeight}">78</sys:Double>

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=ChartStyleGalleryBarItemHeight}">78</sys:Double>

    <!-- General Resources -->

    <Thickness x:Key="{themes:SpreadsheetThemeKey ResourceKey=SpreadsheetBorderThickness}">1</Thickness>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=SpreadsheetBorderBrush}" Color="#FF6E6E6E"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=SpreadsheetForegroundBrush}" Color="#FF000000"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=SpreadsheetBackgroundBrush}" Color="#FFFFFFFF"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=VisualFeedbackLineBrush}" Color="#FF000000"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=FrozenSeparatorBrush}" Color="#FF6E6E6E"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=WorksheetBorderBrush}" Color="#FFEBECEF"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=AutoFilterBackgroundBrush}" Color="#E5FFFFFF"/>

    <SolidColorBrush x:Key="Selection.BorderBrush" Color="#FF6DA2DE"/>

    <SolidColorBrush x:Key="Selection.Background" Color="#7F6DA2DE"/>

    <SolidColorBrush x:Key="TabPanel.BorderBrush" Color="#FF6E6E6E"/>

    <LinearGradientBrush x:Key="TabPanel.Background"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="ResizeThumb.GlyphBrush" Color="#FF656565"/>

    <SolidColorBrush x:Key="ResizeThumb.GlyphBrush.IsMouseOver" Color="#FF656565"/>

    <SolidColorBrush x:Key="ScrollBar.Corner.CustomBorderBrush" Color="#FFE9E9E9"/>

    <SolidColorBrush x:Key="ScrollBar.Corner.BorderBrush" Color="#FFE9E9E9"/>

    <SolidColorBrush x:Key="ScrollBar.Corner.Background" Color="#FFE9E9E9"/>

    <SolidColorBrush x:Key="GlyphBrush" Color="#FF656565"/>

    <!--Grouping-->

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupControlBackgroundBrush}" Color="#FFEBECEF"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupLineBrush}" Color="#FF9DA0AA"/>

    <SolidColorBrush x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupDotBrush}" Color="#FF6E6E6E"/>

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupLineThickness}">2</sys:Double>

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupDotThickness}">2</sys:Double>

    <LinearGradientBrush x:Key="expandButton.DefaultState"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF959595" Offset="0"/>
        <GradientStop Color="#FF7B7B7B" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="expandButton.HoverState"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF7A7A7A" Offset="0"/>
        <GradientStop Color="#FF646464" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="expandButton.PressedState"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF595959" Offset="0"/>
        <GradientStop Color="#FF595959" Offset="1"/>
    </LinearGradientBrush>

    <!-- Header -->

    <SolidColorBrush x:Key="Header.BorderBrush" Color="#FFFFFFFF"/>

    <LinearGradientBrush x:Key="Header.Background"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF6CA2DF" Offset="1"/>
        <GradientStop Color="#FF92BAE7" Offset="0"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="Header.BorderBrush.IsMouseOver" Color="#FFFFFFFF"/>

    <LinearGradientBrush x:Key="Header.Background.IsMouseOver"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF508ACC" Offset="1"/>
        <GradientStop Color="#FF6CA0D9" Offset="0"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="Header.BorderBrush.IsSelected" Color="#FFFFFFFF"/>

    <LinearGradientBrush x:Key="Header.Background.IsSelected"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF407ABC" Offset="1"/>
        <GradientStop Color="#FF5C90C9" Offset="0"/>
    </LinearGradientBrush>

    <!-- TabSelectorItem -->

    <SolidColorBrush x:Key="TabSelectorItem.UnselectedState.Border1" Color="#FF6E6E6E"/>

    <LinearGradientBrush x:Key="TabSelectorItem.UnselectedState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="TabSelectorItem.SelectedState.Border1" Color="#FF6E6E6E"/>

    <SolidColorBrush x:Key="TabSelectorItem.SelectedState.Border2" Color="#FFFFFFFF"/>

    <SolidColorBrush x:Key="TabSelectorItem.SelectedState.Border3" Color="#FFFFFFFF"/>

    <SolidColorBrush x:Key="TabSelectorItem.MouseHoverState.Border1" Color="#FF6E6E6E"/>

    <LinearGradientBrush x:Key="TabSelectorItem.MouseHoverState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFCFDDED" Offset="0"/>
        <GradientStop Color="#FFB8CADF" Offset="1"/>
    </LinearGradientBrush>

    <!-- NavButton -->

    <LinearGradientBrush x:Key="NavButton.Background"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="NavButton.HoverState.Border1"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF9B9B9B" Offset="0"/>
        <GradientStop Color="#FF7E7E7E" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="NavButton.HoverState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFFFFDF3" Offset="0"/>
        <GradientStop Color="#FFC28F36" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="NavButton.PressedState.Border1"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FF8F8F8F" Offset="0"/>
        <GradientStop Color="#FF707070" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="NavButton.PressedState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFB8B8B8" Offset="0"/>
        <GradientStop Color="#FFA7A7A7" Offset="1"/>
    </LinearGradientBrush>

    <!-- AddButton -->

    <SolidColorBrush x:Key="AddButton.DefaultState.Border1" Color="#FF6E6E6E"/>

    <LinearGradientBrush x:Key="AddButton.DefaultState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="AddButton.DefaultState.Border3"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="AddButton.HoverState.Border1" Color="#FF6E6E6E"/>

    <LinearGradientBrush x:Key="AddButton.HoverState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFCFDDED" Offset="0"/>
        <GradientStop Color="#FFB8CADF" Offset="1"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="AddButton.PressedState.Border1" Color="#FF6E6E6E"/>

    <LinearGradientBrush x:Key="AddButton.PressedState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="AddButton.PressedState.Border3"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFDEDEDE" Offset="1"/>
        <GradientStop Color="#FFF0F0F0" Offset="0"/>
    </LinearGradientBrush>

    <!-- FormulaBarItem Hover/Pressed -->

    <SolidColorBrush x:Key="FormulaBarItem.HoverState.Border1" Color="#7F989173"/>

    <LinearGradientBrush x:Key="FormulaBarItem.HoverState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFFFFBEE" Offset="0"/>
        <GradientStop Color="#FFFFE8A6" Offset="1"/>
        <GradientStop Color="#FFFFF3D1" Offset="0.5"/>
        <GradientStop Color="#FFFFE8A6" Offset="0.5"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="FormulaBarItem.PressedState.Border1" Color="#7F606C81"/>

    <SolidColorBrush x:Key="FormulaBarItem.PressedState.Border2" Color="#FFACB9CC"/>

    <SolidColorBrush x:Key="FormulaBarItem.PressedState.Border3" Color="#FFB1BED1"/>

    <LinearGradientBrush x:Key="FormulaBarItem.Editor.BorderBrush"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#7F525F74" Offset="0"/>
        <GradientStop Color="#7F9AA8BD" Offset="1"/>
    </LinearGradientBrush>

    <!-- FormulaBar Collapse/Expand Button -->

    <SolidColorBrush x:Key="ExpandButton.DefaultState.Border1" Color="#FFD6D8DC"/>

    <LinearGradientBrush x:Key="ExpandButton.DefaultState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFD8DDE5" Offset="0"/>
        <GradientStop Color="#FFD8DDE5" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="ExpandButton.DefaultState.Border3"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFD8DDE5" Offset="0"/>
        <GradientStop Color="#FFD8DDE5" Offset="1"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="ExpandButton.HoverState.Border1" Color="#FFE1BD29"/>

    <LinearGradientBrush x:Key="ExpandButton.HoverState.Border2"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFFFFEF8" Offset="0"/>
        <GradientStop Color="#FFFFF4D3" Offset="1"/>
        <GradientStop Color="#FFFFF9E8" Offset="0.5"/>
        <GradientStop Color="#FFFFF4D3" Offset="0.5"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="ExpandButton.HoverState.Border3"
                         EndPoint="0.5,1"
                         StartPoint="0.5,0">
        <GradientStop Color="#FFFFFBEE" Offset="0"/>
        <GradientStop Color="#FFFFE8A6" Offset="1"/>
        <GradientStop Color="#FFFFF3D1" Offset="0.5"/>
        <GradientStop Color="#FFFFE8A6" Offset="0.5"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="ExpandButton.PressedState.Border1" Color="#FFCDC1A6"/>

    <SolidColorBrush x:Key="ExpandButton.PressedState.Border2" Color="#FFFFE8A6"/>

    <SolidColorBrush x:Key="ExpandButton.PressedState.Border3" Color="#FFFFE8A6"/>

    <!--FormulaBarContol-->

    <sys:Double x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarControlMinHeight}">28</sys:Double>

    <Style x:Key="SpreadsheetNameBoxControlStyle" TargetType="{x:Type dxspsi:SpreadsheetNameBoxControl}">
        <Setter Property="Margin" Value="3,0,0,0"/>
        <Setter Property="MinHeight" Value="22"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="EditValuePostMode" Value="Immediate"/>
        <Setter Property="ValidateOnTextInput" Value="True"/>
        <Setter Property="IsReadOnly" Value="False"/>
    </Style>

    <Style x:Key="FormulaBarEditorStyle" TargetType="{x:Type dxspsi:FormulaBarEditor}">
        <Setter Property="Padding" Value="3"/>
        <Setter Property="Background" Value="Transparent"/>
    </Style>

    <Style x:Key="FormulaBarEditorBorderStyle" TargetType="{x:Type Border}">
        <Setter Property="BorderBrush" Value="{StaticResource ScrollBar.Corner.BorderBrush}"/>
        <Setter Property="BorderThickness" Value="1,0,0,0"/>
        <Setter Property="Margin" Value="0,1,1,1"/>
    </Style>

    <DataTemplate x:Key="FormulaBarEditorBackgroundTemplate">
        <Grid>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="4"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="4"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Border CornerRadius="2,2,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF797979"/>
                            <GradientStop Color="#FFA2A2A2" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border Background="#FFA2A2A2" Grid.Row="1"/>
                <Border CornerRadius="0,0,2,2" Grid.Row="2">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFA2A2A2"/>
                            <GradientStop Color="#FFBBBBBB" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
            </Grid>
            <Grid Margin="1,1,1,1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="3"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Border CornerRadius="1,1,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFDCDCDC"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border Background="#FFFFFFFF"
                        CornerRadius="0,0,1,1"
                        Grid.Row="1"/>
            </Grid>
        </Grid>
    </DataTemplate>

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarControlTemplate}" TargetType="{x:Type dxsps:SpreadsheetFormulaBarControl}">
        <Border>
            <Grid Height="{TemplateBinding Height}" Width="{TemplateBinding Width}">
                <Grid.RowDefinitions>
                    <RowDefinition MinHeight="{TemplateBinding MinHeight}"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid x:Name="PART_HorizontalContainer">
                    <Grid x:Name="PART_FormulaBarEditorContainer" Grid.Column="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition MinWidth="100" Width="100"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="{TemplateBinding MinHeight}"
                                           MaxHeight="{TemplateBinding MinHeight}"
                                           MinHeight="{TemplateBinding MinHeight}"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <dxspsi:SpreadsheetNameBoxControl x:Name="PART_Combobox"
                                                          MaxHeight="{TemplateBinding MinHeight}"
                                                          SpreadsheetControl="{TemplateBinding SpreadsheetControl}"
                                                          Style="{StaticResource SpreadsheetNameBoxControlStyle}"/>
                        <Thumb x:Name="PART_VerticalThumb"
                               Grid.Column="1"
                               Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=FormulaBarVerticalThumbStyle}}"/>
                        <Border Grid.Column="2"
                                MaxHeight="{TemplateBinding MaxHeight}"
                                MinHeight="{TemplateBinding MinHeight}"
                                VerticalAlignment="Top">
                            <Grid Margin="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Button x:Name="PART_CancelButton" Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=FormulaBarCancelButtonStyle}}"/>
                                <Button x:Name="PART_OkButton"
                                        Grid.Column="1"
                                        Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=FormulaBarOkButtonStyle}}"/>
                                <Button x:Name="PART_FunctionButton"
                                        Grid.Column="2"
                                        Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=FormulaBarFunctionButtonStyle}}"/>
                            </Grid>
                        </Border>
                        <Grid Grid.Column="3"
                              Grid.RowSpan="2"
                              Margin="3">
                            <ContentPresenter ContentTemplate="{StaticResource FormulaBarEditorBackgroundTemplate}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <dxspsi:FormulaBarEditor x:Name="PART_Editor" Style="{StaticResource FormulaBarEditorStyle}"/>
                                <Border Grid.Column="1" Style="{StaticResource FormulaBarEditorBorderStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <ScrollBar Grid.Column="3"
                                                   Grid.Row="1"
                                                   LargeChange="{Binding ScrollViewer.ViewportHeight, ElementName=PART_Editor}"
                                                   Maximum="{Binding ScrollViewer.ScrollableHeight, ElementName=PART_Editor}"
                                                   Minimum="0"
                                                   ViewportSize="{Binding ScrollViewer.ViewportHeight, ElementName=PART_Editor}"
                                                   Visibility="{Binding IsExpanded, Converter={StaticResource BoolToVisibilityConverter},RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}"/>
                                        <ToggleButton x:Name="PART_ExpandButton"
                                                      IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                                      Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=FormulaBarExpandButtonStyle}}"/>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
                <Thumb x:Name="PART_HorizontalThumb"
                       Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=FormulaBarHorizontalThumbStyle}}"
                       VerticalAlignment="Bottom"/>
            </Grid>
        </Border>
    </ControlTemplate>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarExpandButtonStyle}" TargetType="{x:Type ToggleButton}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Width" Value="17"/>
        <Setter Property="Height" Value="20"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border x:Name="Root"
                            Background="{StaticResource ScrollBar.Corner.Background}"
                            CornerRadius="0,1,1,0"
                            SnapsToDevicePixels="True">
                        <Grid>
                            <Border Background="#7F000000"
                                    CornerRadius="64"
                                    Height="13"
                                    Width="13"/>
                            <Path x:Name="GlyphExpanded"
                                  Data="F1 M 758,604L 757,604L 754,610L 761,610L 758,604 Z "
                                  Height="6"
                                  HorizontalAlignment="Center"
                                  Margin="0"
                                  Opacity="0"
                                  Stretch="Uniform"
                                  VerticalAlignment="Center"
                                  Width="7">
                                <Path.Fill>
                                    <SolidColorBrush x:Name="ButtonColor" Color="#FFE3E3E3"/>
                                </Path.Fill>
                            </Path>
                            <Path x:Name="GlyphCollapsed"
                                  Data="F1 M 769,610L 770,610L 773,604L 766,604L 769,610 Z "
                                  Height="6"
                                  HorizontalAlignment="Center"
                                  Margin="0,1,0,0"
                                  Stretch="Uniform"
                                  VerticalAlignment="Center"
                                  Width="7">
                                <Path.Fill>
                                    <SolidColorBrush x:Name="ButtonColor" Color="#FFE3E3E3"/>
                                </Path.Fill>
                            </Path>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Fill"
                                    TargetName="GlyphCollapsed"
                                    Value="#FFFFFFFF"/>
                            <Setter Property="Fill"
                                    TargetName="GlyphExpanded"
                                    Value="#FFFFFFFF"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Fill"
                                    TargetName="GlyphCollapsed"
                                    Value="#FFFFFFFF"/>
                            <Setter Property="Fill"
                                    TargetName="GlyphExpanded"
                                    Value="#FFFFFFFF"/>
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="CornerRadius"
                                    TargetName="Root"
                                    Value="0,1,0,0"/>
                            <Setter Property="Opacity"
                                    TargetName="GlyphExpanded"
                                    Value="1"/>
                            <Setter Property="Opacity"
                                    TargetName="GlyphCollapsed"
                                    Value="0"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarCancelButtonStyle}" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid MinHeight="22" MinWidth="22">
                        <Border x:Name="HoverState"
                                Background="{StaticResource FormulaBarItem.HoverState.Border2}"
                                BorderBrush="{StaticResource FormulaBarItem.HoverState.Border1}"
                                BorderThickness="1"
                                CornerRadius="2"
                                Opacity="0"/>
                        <Border x:Name="PressedState"
                                Background="{StaticResource FormulaBarItem.PressedState.Border2}"
                                BorderBrush="{StaticResource FormulaBarItem.PressedState.Border1}"
                                BorderThickness="1"
                                CornerRadius="2"
                                Opacity="0">
                            <Border Background="{StaticResource FormulaBarItem.PressedState.Border3}" Margin="1"/>
                        </Border>
                        <Grid Margin="3">
                            <Image x:Name="image1"
                                   dxb:ImageColorizer.Color="{StaticResource GlyphColor}"
                                   dxb:ImageColorizer.IsEnabled="True"
                                   HorizontalAlignment="Center"
                                   Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/FormulaBarCancel_16x16.png"
                                   Stretch="None"
                                   VerticalAlignment="Center"
                                   Visibility="{TemplateBinding IsEnabled, Converter={StaticResource BoolToVisibilityInverseConverter}}"/>
                            <Image x:Name="image2"
                                   dxb:ImageColorizer.Color="{StaticResource GlyphColor}"
                                   dxb:ImageColorizer.IsEnabled="True"
                                   HorizontalAlignment="Center"
                                   Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/FormulaBarCancel_16x16.png"
                                   Stretch="None"
                                   VerticalAlignment="Center"
                                   Visibility="{TemplateBinding IsEnabled, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="1"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="0"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image1"
                                    Value="#FF1B293E"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image2"
                                    Value="#FF1B293E"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="1"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image1"
                                    Value="#FF1B293E"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image2"
                                    Value="#FF1B293E"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.35"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarOkButtonStyle}" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid MinHeight="22" MinWidth="22">
                        <Border x:Name="HoverState"
                                Background="{StaticResource FormulaBarItem.HoverState.Border2}"
                                BorderBrush="{StaticResource FormulaBarItem.HoverState.Border1}"
                                BorderThickness="1"
                                CornerRadius="2"
                                Opacity="0"/>
                        <Border x:Name="PressedState"
                                Background="{StaticResource FormulaBarItem.PressedState.Border2}"
                                BorderBrush="{StaticResource FormulaBarItem.PressedState.Border1}"
                                BorderThickness="1"
                                CornerRadius="2"
                                Opacity="0">
                            <Border Background="{StaticResource FormulaBarItem.PressedState.Border3}" Margin="1"/>
                        </Border>
                        <Grid Margin="3">
                            <Image x:Name="image1"
                                   dxb:ImageColorizer.Color="{StaticResource GlyphColor}"
                                   dxb:ImageColorizer.IsEnabled="True"
                                   HorizontalAlignment="Center"
                                   Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/FormulaBarOk_16x16.png"
                                   Stretch="None"
                                   VerticalAlignment="Center"
                                   Visibility="{TemplateBinding IsEnabled, Converter={StaticResource BoolToVisibilityInverseConverter}}"/>
                            <Image x:Name="image2"
                                   dxb:ImageColorizer.Color="{StaticResource GlyphColor}"
                                   dxb:ImageColorizer.IsEnabled="True"
                                   HorizontalAlignment="Center"
                                   Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/FormulaBarOk_16x16.png"
                                   Stretch="None"
                                   VerticalAlignment="Center"
                                   Visibility="{TemplateBinding IsEnabled, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="1"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="0"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image1"
                                    Value="#FF1B293E"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image2"
                                    Value="#FF1B293E"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="1"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image1"
                                    Value="#FF1B293E"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image2"
                                    Value="#FF1B293E"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.35"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarFunctionButtonStyle}" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid MinHeight="22" MinWidth="22">
                        <Border x:Name="HoverState"
                                Background="{StaticResource FormulaBarItem.HoverState.Border2}"
                                BorderBrush="{StaticResource FormulaBarItem.HoverState.Border1}"
                                BorderThickness="1"
                                CornerRadius="2"
                                Opacity="0"/>
                        <Border x:Name="PressedState"
                                Background="{StaticResource FormulaBarItem.PressedState.Border2}"
                                BorderBrush="{StaticResource FormulaBarItem.PressedState.Border1}"
                                BorderThickness="1"
                                CornerRadius="2"
                                Opacity="0">
                            <Border Background="{StaticResource FormulaBarItem.PressedState.Border3}" Margin="1"/>
                        </Border>
                        <Grid Margin="3">
                            <Image x:Name="image1"
                                   dxb:ImageColorizer.Color="{StaticResource GlyphColor}"
                                   dxb:ImageColorizer.IsEnabled="True"
                                   HorizontalAlignment="Center"
                                   Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/FormulaBarInsertFunction_16x16.png"
                                   Stretch="None"
                                   VerticalAlignment="Center"
                                   Visibility="{TemplateBinding IsEnabled, Converter={StaticResource BoolToVisibilityInverseConverter}}"/>
                            <Image x:Name="image2"
                                   dxb:ImageColorizer.Color="{StaticResource GlyphColor}"
                                   dxb:ImageColorizer.IsEnabled="True"
                                   HorizontalAlignment="Center"
                                   Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/FormulaBarInsertFunction_16x16.png"
                                   Stretch="None"
                                   VerticalAlignment="Center"
                                   Visibility="{TemplateBinding IsEnabled, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="1"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="0"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image1"
                                    Value="#FF1B293E"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image2"
                                    Value="#FF1B293E"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="1"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image1"
                                    Value="#FF1B293E"/>
                            <Setter Property="dxb:ImageColorizer.Color"
                                    TargetName="image2"
                                    Value="#FF1B293E"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.35"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarHorizontalThumbStyle}" TargetType="{x:Type Thumb}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Grid Background="Transparent" Height="3"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=FormulaBarVerticalThumbStyle}" TargetType="{x:Type Thumb}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Border Background="Transparent" Padding="4,0,4,0">
                        <Canvas Height="18"
                                Margin="0,-1,0,0"
                                Width="3">
                            <Path Data="F1 M 512,359C 513.105,359 514,359.895 514,361C 514,362.105 513.105,363 512,363C 510.895,363 510,362.105 510,361C 510,359.895 510.895,359 512,359 Z M 512,364C 513.104,364 514,364.896 514,366C 514,367.105 513.104,368 512,368C 510.895,368 510,367.105 510,366C 510,364.896 510.895,364 512,364 Z M 512,369C 513.105,369 514,369.895 514,371C 514,372.105 513.104,373 512,373C 510.895,373 510,372.105 510,371C 510,369.895 510.895,369 512,369 Z M 512,374C 513.105,374 514,374.895 514,376C 514,377.105 513.105,378 512,378C 510.895,378 510,377.105 510,376C 510,374.895 510.895,374 512,374 Z"
                                  Fill="#80FFFFFF"
                                  Height="19"
                                  Stretch="Fill"
                                  Width="4"/>
                            <Path Data="F1 M 511.5,359C 512.328,359 513,359.672 513,360.5C 513,361.328 512.328,362 511.5,362C 510.672,362 510,361.328 510,360.5C 510,359.672 510.672,359 511.5,359 Z M 511.5,364C 512.328,364 513,364.672 513,365.5C 513,366.329 512.328,367 511.5,367C 510.671,367 510,366.329 510,365.5C 510,364.672 510.671,364 511.5,364 Z M 511.5,369C 512.328,369 513,369.672 513,370.5C 513,371.328 512.328,372 511.5,372C 510.672,372 510,371.328 510,370.5C 510,369.672 510.672,369 511.5,369 Z M 511.5,374C 512.328,374 513,374.672 513,375.5C 513,376.328 512.328,377 511.5,377C 510.672,377 510,376.328 510,375.5C 510,374.672 510.672,374 511.5,374 Z"
                                  Fill="#FF757A82"
                                  Height="18"
                                  Stretch="Fill"
                                  Width="3"/>
                        </Canvas>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type dxspsi:FormulaBarEditor}">
        <Setter Property="Background" Value="#FFFFFFFF"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type dxspsi:FormulaBarEditor}">
                    <Grid x:Name="RootElement"
                          Background="{TemplateBinding Background}"
                          Margin="{TemplateBinding Margin}">
                        <Grid>
                            <Border x:Name="focus"
                                    BorderThickness="0"
                                    Opacity="0"/>
                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                <ScrollViewer x:Name="PART_ContentHost"
                                              Background="{TemplateBinding Background}"
                                              Foreground="{TemplateBinding Foreground}"
                                              IsTabStop="False"
                                              Padding="{TemplateBinding Padding}"
                                              VerticalContentAlignment="Center"/>
                            </Border>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--Grouping-->

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupButtonTemplate}" TargetType="{x:Type dxspsi:GroupItem}">
        <Grid Height="15"
              Margin="-1,-1,0,0"
              Width="15">
            <Border x:Name="DefaultState"
                    Background="{StaticResource expandButton.DefaultState}"
                    CornerRadius="2"/>
            <Border x:Name="HoverState"
                    Background="{StaticResource expandButton.HoverState}"
                    CornerRadius="2"
                    Opacity="0"/>
            <Border x:Name="PressedState"
                    Background="{StaticResource expandButton.PressedState}"
                    CornerRadius="2"
                    Opacity="0"/>
            <Path x:Name="CollapseButton"
                  Data="F1 M 3,0L 4,0L 4,3L 7,3L 7,4L 4,4L 4,7L 3,7L 3,4L 0,4L 0,3L 3,3L 3,0 Z "
                  Fill="#FFFFFFFF"
                  Height="7"
                  Opacity="0"
                  Stretch="Fill"
                  Width="7"/>
            <Rectangle x:Name="ExpandButton"
                       Fill="#FFFFFFFF"
                       Height="1"
                       Opacity="0"
                       Stretch="Fill"
                       Width="7"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsExpanded" Value="True">
                <Setter Property="Opacity"
                        TargetName="ExpandButton"
                        Value="1"/>
            </Trigger>
            <Trigger Property="IsCollapsed" Value="True">
                <Setter Property="Opacity"
                        TargetName="CollapseButton"
                        Value="1"/>
            </Trigger>
            <Trigger Property="IsHovered" Value="True">
                <Setter Property="Opacity"
                        TargetName="DefaultState"
                        Value="0"/>
                <Setter Property="Opacity"
                        TargetName="HoverState"
                        Value="1"/>
                <Setter Property="Opacity"
                        TargetName="PressedState"
                        Value="0"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Opacity"
                        TargetName="DefaultState"
                        Value="0"/>
                <Setter Property="Opacity"
                        TargetName="HoverState"
                        Value="0"/>
                <Setter Property="Opacity"
                        TargetName="PressedState"
                        Value="1"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=GroupHeaderTemplate}" TargetType="{x:Type dxspsi:GroupItem}">
        <Grid>
            <Grid x:Name="DefaultState">
                <Border Background="{StaticResource Header.BorderBrush}" Padding="1">
                    <Border Background="{StaticResource Header.Background}" Padding="1"/>
                </Border>
            </Grid>
            <Grid x:Name="HoverState" Opacity="0">
                <Border Background="{StaticResource Header.BorderBrush.IsMouseOver}" Padding="1">
                    <Border Background="{StaticResource Header.Background.IsMouseOver}" Padding="1"/>
                </Border>
            </Grid>
            <Grid x:Name="PressedState" Opacity="0">
                <Border Background="{StaticResource Header.BorderBrush.IsSelected}" Padding="1">
                    <Border Background="{StaticResource Header.Background.IsSelected}" Padding="1"/>
                </Border>
            </Grid>
            <TextBlock HorizontalAlignment="Center"
                       Text="{TemplateBinding Text}"
                       FontSize="{TemplateBinding FontHeight}"
                       TextAlignment="Center"
                       TextElement.Foreground="#FFFFFFFF"
                       VerticalAlignment="Center"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsHovered" Value="True">
                <Setter Property="Opacity"
                        TargetName="DefaultState"
                        Value="0"/>
                <Setter Property="Opacity"
                        TargetName="HoverState"
                        Value="1"/>
                <Setter Property="Opacity"
                        TargetName="PressedState"
                        Value="0"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Opacity"
                        TargetName="DefaultState"
                        Value="0"/>
                <Setter Property="Opacity"
                        TargetName="HoverState"
                        Value="0"/>
                <Setter Property="Opacity"
                        TargetName="PressedState"
                        Value="1"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!--Comments-->

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=CommentTemplate}" TargetType="{x:Type dxspsi:CommentItem}">
        <Border Background="{TemplateBinding Background}"
                BorderBrush="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=CommentLineBrush}}"
                BorderThickness="1">
            <TextBox x:Name="PART_CommentBox"
                     AcceptsReturn="True"
                     Background="{TemplateBinding Background}"
                     BorderThickness="0"
                     Cursor="{TemplateBinding Cursor}"
                     dx:ThemeManager.ThemeName="None"
                     Focusable="{TemplateBinding Focusable}"
                     FontFamily="{Binding TextSettings.FontFamily, RelativeSource={RelativeSource TemplatedParent}}"
                     FontSize="{Binding TextSettings.FontSize, RelativeSource={RelativeSource TemplatedParent}}"
                     FontStyle="{Binding TextSettings.FontStyle, RelativeSource={RelativeSource TemplatedParent}}"
                     FontWeight="{Binding TextSettings.FontWeight, RelativeSource={RelativeSource TemplatedParent}}"
                     Foreground="{Binding TextSettings.Foreground, RelativeSource={RelativeSource TemplatedParent}}"
                     IsReadOnly="{TemplateBinding IsReadOnly}"
                     Text="{TemplateBinding Text}"
                     TextWrapping="{Binding TextSettings.TextWrapping, RelativeSource={RelativeSource TemplatedParent}}"/>
        </Border>
    </ControlTemplate>

    <!--HeaderControl-->

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=HeadersControlTemplate}" TargetType="{x:Type dxspsi:WorksheetHeadersControl}">
        <Border>
            <dxspsi:HeadersPanel LayoutInfo="{Binding Path=(dxspsi:SpreadsheetViewControl.ActiveSpreadsheetView).LayoutInfo, RelativeSource={RelativeSource Self}}" Orientation="{TemplateBinding Orientation}"/>
        </Border>
    </ControlTemplate>

    <!-- Header Item -->

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=HorizontalHeaderItem}" TargetType="{x:Type dxspsi:HeaderItem}">
        <Border Background="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=SpreadsheetBorderBrush}}" Padding="0,0,0,1">
            <Border x:Name="Root"
                    Background="{StaticResource Header.Background}"
                    BorderBrush="{StaticResource Header.BorderBrush}"
                    BorderThickness="0,1,1,1">
                <TextBlock FontSize="{TemplateBinding FontHeight}"
                           Foreground="#FFFFFFFF"
                           HorizontalAlignment="Center"
                           Text="{TemplateBinding Text}"
                           TextAlignment="Center"
                           VerticalAlignment="Center"/>
            </Border>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="BorderBrush"
                        TargetName="Root"
                        Value="{StaticResource Header.BorderBrush.IsMouseOver}"/>
                <Setter Property="Background"
                        TargetName="Root"
                        Value="{StaticResource Header.Background.IsMouseOver}"/>
            </Trigger>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="BorderBrush"
                        TargetName="Root"
                        Value="{StaticResource Header.BorderBrush.IsSelected}"/>
                <Setter Property="Background"
                        TargetName="Root"
                        Value="{StaticResource Header.Background.IsSelected}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=VerticalHeaderItem}" TargetType="{x:Type dxspsi:HeaderItem}">
        <Border Background="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=SpreadsheetBorderBrush}}" Padding="0,0,1,0">
            <Border x:Name="Root"
                    Background="{StaticResource Header.Background}"
                    BorderBrush="{StaticResource Header.BorderBrush}"
                    BorderThickness="1,0,1,1">
                <TextBlock FontSize="{TemplateBinding FontHeight}"
                           Foreground="#FFFFFFFF"
                           HorizontalAlignment="Center"
                           Text="{TemplateBinding Text}"
                           TextAlignment="Center"
                           VerticalAlignment="Center"/>
            </Border>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="BorderBrush"
                        TargetName="Root"
                        Value="{StaticResource Header.BorderBrush.IsMouseOver}"/>
                <Setter Property="Background"
                        TargetName="Root"
                        Value="{StaticResource Header.Background.IsMouseOver}"/>
            </Trigger>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="BorderBrush"
                        TargetName="Root"
                        Value="{StaticResource Header.BorderBrush.IsSelected}"/>
                <Setter Property="Background"
                        TargetName="Root"
                        Value="{StaticResource Header.Background.IsSelected}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!--TabSelector-->

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=TabSelectorItemTemplate}" TargetType="{x:Type dxspsi:TabSelectorItem}">
        <Grid x:Name="PART_Root">
            <Grid Margin="0,1,0,-1">
                <Grid x:Name="UnselectedState" Visibility="{TemplateBinding State, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Normal}">
                    <Border Background="{StaticResource TabSelectorItem.UnselectedState.Border1}" Padding="0,0,1,0">
                        <Border Background="{StaticResource TabSelectorItem.UnselectedState.Border2}" Padding="1,0,1,1"/>
                    </Border>
                </Grid>
                <Grid x:Name="HoverState" Opacity="0">
                    <Border Background="{StaticResource TabSelectorItem.MouseHoverState.Border1}" Padding="0,0,1,0">
                        <Border Background="{StaticResource TabSelectorItem.MouseHoverState.Border2}" Padding="1,0,1,1"/>
                    </Border>
                </Grid>
                <Grid x:Name="CheckedState" Visibility="{TemplateBinding State, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Selected}">
                    <Border Background="{StaticResource TabSelectorItem.UnselectedState.Border1}" Padding="0,0,1,0">
                        <Border Background="{StaticResource TabSelectorItem.UnselectedState.Border2}" Padding="1,0,1,1"/>
                    </Border>
                </Grid>
                <Grid x:Name="SelectedState" Visibility="{TemplateBinding State, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Active}">
                    <Border Background="{StaticResource TabSelectorItem.SelectedState.Border1}"
                            Margin="0,-1,0,0"
                            Padding="0,0,1,0">
                        <Border Background="{StaticResource TabSelectorItem.SelectedState.Border2}" Padding="1,0,1,1"/>
                    </Border>
                </Grid>
            </Grid>
            <TextBlock Focusable="False"
                       Foreground="#FF000000"
                       Margin="12,0,12,0"
                       Text="{TemplateBinding Text}"
                       TextAlignment="Center"
                       VerticalAlignment="Center"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Opacity"
                        TargetName="HoverState"
                        Value="1"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=TabSelectorColoredItemTemplate}" TargetType="{x:Type dxspsi:TabSelectorItem}">
        <Grid x:Name="PART_Root">
            <Grid.Resources>
                <SolidColorBrush x:Key="Color.TabSelectorItem.UnselectedState.Border1" Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FF999999}"/>
                <LinearGradientBrush x:Key="Color.TabSelectorItem.UnselectedState.Border2"
                                     EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                    <GradientStop Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FFDDDDDD}" Offset="0"/>
                    <GradientStop Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FFBBBBBB}" Offset="1"/>
                </LinearGradientBrush>
                <SolidColorBrush x:Key="Color.TabSelectorItem.SelectedState.Border1" Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FF999999}"/>
                <LinearGradientBrush x:Key="Color.TabSelectorItem.SelectedState.Border2"
                                     EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                    <GradientStop Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FFFFFFFF}" Offset="0"/>
                    <GradientStop Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FFEEEEEE}" Offset="1"/>
                </LinearGradientBrush>
                <SolidColorBrush x:Key="Color.TabSelectorItem.MouseHoverState.Border1" Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FF999999}"/>
                <LinearGradientBrush x:Key="Color.TabSelectorItem.MouseHoverState.Border2"
                                     EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                    <GradientStop Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FFFFFFFF}" Offset="0"/>
                    <GradientStop Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FFEEEEEE}" Offset="1"/>
                </LinearGradientBrush>
            </Grid.Resources>
            <Grid Margin="0,0,0,-1">
                <Grid x:Name="UnselectedState" Visibility="{TemplateBinding State, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Normal}">
                    <Grid.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFFFFFFF" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Grid.Background>
                    <Border Background="{StaticResource Color.TabSelectorItem.UnselectedState.Border2}"
                            BorderBrush="#FF111111"
                            BorderThickness="0,1,1,0"
                            Opacity="0.35"/>
                    <Border BorderBrush="{StaticResource Color.TabSelectorItem.UnselectedState.Border1}"
                            BorderThickness="0,1,1,0"
                            Opacity="0.15"/>
                </Grid>
                <Grid x:Name="HoverState" Opacity="0">
                    <Grid.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFFFFFFF" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Grid.Background>
                    <Border Background="{StaticResource Color.TabSelectorItem.MouseHoverState.Border2}"
                            BorderBrush="#FF111111"
                            BorderThickness="0,1,1,0"
                            Opacity="0.35"/>
                    <Border BorderBrush="{StaticResource Color.TabSelectorItem.UnselectedState.Border1}"
                            BorderThickness="0,1,1,0"
                            Opacity="0.15"/>
                </Grid>
                <Grid x:Name="CheckedState" Visibility="{TemplateBinding State, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Selected}">
                    <Grid.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFFFFFFF" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Grid.Background>
                    <Border Background="{StaticResource Color.TabSelectorItem.UnselectedState.Border2}"
                            BorderBrush="#FF111111"
                            BorderThickness="0,1,1,0"
                            Opacity="0.35"/>
                    <Border BorderBrush="{StaticResource Color.TabSelectorItem.UnselectedState.Border1}"
                            BorderThickness="0,1,1,0"
                            Opacity="0.15"/>
                </Grid>
                <Grid x:Name="SelectedState" Visibility="{TemplateBinding State, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Active}">
                    <Border Background="{StaticResource Color.TabSelectorItem.SelectedState.Border2}"
                            BorderBrush="#FF111111"
                            BorderThickness="0,0,1,0"
                            Padding="1,0,1,1"/>
                    <Border BorderBrush="{StaticResource Color.TabSelectorItem.UnselectedState.Border1}"
                            BorderThickness="0,0,1,0"
                            Opacity="0.15"/>
                </Grid>
            </Grid>
            <TextBlock x:Name="content"
                       Focusable="False"
                       Foreground="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FF333333}"
                       Margin="12,0,12,0"
                       Text="{TemplateBinding Text}"
                       TextAlignment="Center"
                       VerticalAlignment="Center"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Opacity"
                        TargetName="HoverState"
                        Value="1"/>
            </Trigger>
            <Trigger Property="State" Value="Active">
                <Setter Property="Foreground"
                        TargetName="content"
                        Value="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ColorOverlayConveter}, ConverterParameter=#FF333333}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=TabSelectorTemplate}" TargetType="{x:Type dxspsi:SpreadsheetTabSelector}">
        <Border>
            <Grid x:Name="PART_RootContainer">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Border Background="{StaticResource TabPanel.BorderBrush}" Padding="0,0,1,0">
                    <Grid x:Name="PART_NavButtonContainer">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Button x:Name="PART_FirstButton"
                                Command="{TemplateBinding FirstTabCommand}"
                                CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                Focusable="False"
                                Grid.Column="0"
                                Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=BaseButtonStyle}}"
                                Width="20">
                            <Grid>
                                <Path Data="F1 M 1351,926L 1347,922L 1347,926L 1346,926L 1346,918L 1347,918L 1347,922L 1351,918L 1351,922L 1355,918L 1355,926L 1351,922L 1351,926 Z"
                                      Fill="#3FFFFFFF"
                                      Height="8"
                                      Margin="0,1,0,-1"
                                      Stretch="Fill"
                                      Width="9"/>
                                <Path Data="F1 M 1351,926L 1347,922L 1347,926L 1346,926L 1346,918L 1347,918L 1347,922L 1351,918L 1351,922L 1355,918L 1355,926L 1351,922L 1351,926 Z"
                                      Fill="{StaticResource GlyphBrush}"
                                      Height="8"
                                      Stretch="Fill"
                                      Width="9"/>
                            </Grid>
                        </Button>
                        <Button x:Name="PART_PrevButton"
                                Command="{TemplateBinding PrevTabCommand}"
                                CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                Focusable="False"
                                Grid.Column="1"
                                Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=BaseButtonStyle}}"
                                Width="20">
                            <Grid>
                                <Path Data="F1 M 1314,926L 1310,922L 1314,918L 1314,926 Z"
                                      Fill="#3FFFFFFF"
                                      Height="8"
                                      Margin="0,1,0,-1"
                                      Stretch="Fill"
                                      Width="4"/>
                                <Path Data="F1 M 1314,926L 1310,922L 1314,918L 1314,926 Z"
                                      Fill="{StaticResource GlyphBrush}"
                                      Height="8"
                                      Stretch="Fill"
                                      Width="4"/>
                            </Grid>
                        </Button>
                        <Button x:Name="PART_NextButton"
                                Command="{TemplateBinding NextTabCommand}"
                                CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                Focusable="False"
                                Grid.Column="2"
                                Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=BaseButtonStyle}}"
                                Width="20">
                            <Grid>
                                <Path Data="F1 M 1423,918L 1427,922L 1423,926L 1423,918 Z "
                                      Fill="#3FFFFFFF"
                                      Height="8"
                                      Margin="0,1,0,-1"
                                      Stretch="Fill"
                                      Width="4"/>
                                <Path Data="F1 M 1423,918L 1427,922L 1423,926L 1423,918 Z "
                                      Fill="{StaticResource GlyphBrush}"
                                      Height="8"
                                      Stretch="Fill"
                                      Width="4"/>
                            </Grid>
                        </Button>
                        <Button x:Name="PART_LastButton"
                                Command="{TemplateBinding LastTabCommand}"
                                CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                Focusable="False"
                                Grid.Column="3"
                                Style="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=BaseButtonStyle}}"
                                Width="20">
                            <Grid>
                                <Path Data="F1 M 1386,918L 1390,922L 1390,918L 1391,918L 1391,926L 1390,926L 1390,922L 1386,926L 1386,922L 1382,926L 1382,918L 1386,922L 1386,918 Z "
                                      Fill="#3FFFFFFF"
                                      Height="8"
                                      Margin="0,1,0,-1"
                                      Stretch="Fill"
                                      Width="9"/>
                                <Path Data="F1 M 1386,918L 1390,922L 1390,918L 1391,918L 1391,926L 1390,926L 1390,922L 1386,926L 1386,922L 1382,926L 1382,918L 1386,922L 1386,918 Z "
                                      Fill="{StaticResource GlyphBrush}"
                                      Height="8"
                                      Stretch="Fill"
                                      Width="9"/>
                            </Grid>
                        </Button>
                    </Grid>
                </Border>
                <dxspsi:TabSelectorPanel AddButtonTemplate="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=AddButtonDataTemplate}}"
                                         Grid.Column="1"
                                         Grid.ColumnSpan="2"
                                         TabSelectorItemColoredTemplate="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=TabSelectorColoredItemTemplate}}"
                                         TabSelectorItemDefaultTemplate="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=TabSelectorItemTemplate}}"/>
            </Grid>
        </Border>
    </ControlTemplate>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=BaseButtonStyle}" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid x:Name="Root"
                          Background="{StaticResource NavButton.Background}"
                          Margin="0,1,0,0">
                        <Grid Margin="1">
                            <Border x:Name="HoverState"
                                    Background="{StaticResource NavButton.HoverState.Border2}"
                                    BorderBrush="{StaticResource NavButton.HoverState.Border1}"
                                    BorderThickness="1"
                                    CornerRadius="1"
                                    Opacity="0"/>
                            <Border x:Name="PressedState"
                                    Background="{StaticResource NavButton.PressedState.Border2}"
                                    BorderBrush="{StaticResource NavButton.PressedState.Border1}"
                                    BorderThickness="1"
                                    CornerRadius="1"
                                    Opacity="0"/>
                        </Grid>
                        <ContentPresenter x:Name="Content"
                                          Content="{TemplateBinding Content}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="1"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="0"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="1"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity"
                                    TargetName="Content"
                                    Value="0.35"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=AddButtonStyle}" TargetType="{x:Type Button}">
        <Setter Property="Width" Value="32"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid x:Name="Root">
                        <Grid x:Name="DefaultState">
                            <Border Background="{StaticResource AddButton.DefaultState.Border1}" Padding="0,1,1,0">
                                <Border Background="{StaticResource AddButton.DefaultState.Border2}" Padding="0,1,1,1"/>
                            </Border>
                        </Grid>
                        <Grid x:Name="HoverState" Opacity="0">
                            <Border Background="{StaticResource AddButton.HoverState.Border1}" Padding="0,1,1,0">
                                <Border Background="{StaticResource AddButton.HoverState.Border2}" Padding="0,1,1,1"/>
                            </Border>
                        </Grid>
                        <Grid x:Name="PressedState" Opacity="0">
                            <Border Background="{StaticResource AddButton.PressedState.Border1}" Padding="0,1,1,0">
                                <Border Background="{StaticResource AddButton.PressedState.Border2}" Padding="0,1,1,1"/>
                            </Border>
                        </Grid>
                        <Grid Margin="0,5,0,4" VerticalAlignment="Center">
                            <Path Data="F1 M 119,100L 122,100L 122,97L 124,97L 124,100L 127,100L 127,102L 124,102L 124,105L 122,105L 122,102L 119,102L 119,100 Z "
                                  Fill="#3FFFFFFF"
                                  Height="8"
                                  Margin="0,1,0,0"
                                  Stretch="Fill"
                                  Width="8"/>
                            <Path Data="F1 M 119,100L 122,100L 122,97L 124,97L 124,100L 127,100L 127,102L 124,102L 124,105L 122,105L 122,102L 119,102L 119,100 Z "
                                  Fill="{StaticResource GlyphBrush}"
                                  Height="8"
                                  Stretch="Fill"
                                  Width="8"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="DefaultState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="1"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="0"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Opacity"
                                    TargetName="DefaultState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="HoverState"
                                    Value="0"/>
                            <Setter Property="Opacity"
                                    TargetName="PressedState"
                                    Value="1"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity"
                                    TargetName="Root"
                                    Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--Spreadsheet-->

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=TabSelectorPanelStyle}" TargetType="{x:Type Border}">
        <Setter Property="Background" Value="{StaticResource TabPanel.Background}"/>
        <Setter Property="BorderBrush" Value="{StaticResource TabPanel.BorderBrush}"/>
        <Setter Property="BorderThickness" Value="0,1,0,0"/>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=BottomRightCornerStyle}" TargetType="{x:Type Border}">
        <Setter Property="Background" Value="{StaticResource ScrollBar.Corner.Background}"/>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=WorksheetSelectionControlStyle}" TargetType="{x:Type dxspsi:WorksheetSelectionControl}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="SelectionBorderBrush" Value="{StaticResource Selection.BorderBrush}"/>
        <Setter Property="SelectionBrush" Value="{StaticResource Selection.Background}"/>
        <Setter Property="AutoFilterBackgroundBrush" Value="{DynamicResource {themes:SpreadsheetThemeKey ResourceKey=AutoFilterBackgroundBrush}}"/>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=TopLeftCornerStyle}" TargetType="{x:Type Border}">
        <Setter Property="Background" Value="{StaticResource Header.Background}"/>
        <Setter Property="BorderBrush" Value="{StaticResource Header.BorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <Style x:Key="{themes:SpreadsheetThemeKey ResourceKey=ResizeThumbStyle}" TargetType="{x:Type Thumb}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Grid x:Name="Root" Background="Transparent">
                        <Border Background="{StaticResource TabPanel.Background}"
                                BorderBrush="{StaticResource TabPanel.BorderBrush}"
                                BorderThickness="0,1,1,0"/>
                        <Grid Cursor="SizeWE"
                              Height="14"
                              Width="3">
                            <Path x:Name="Path"
                                  Data="F1 M 375,379L 376,379L 376,380L 375,380L 375,379 Z M 377,379.001L 378,379.001L 378,380.001L 377,380.001L 377,379.001 Z M 375,381.001L 376,381.001L 376,382.001L 375,382.001L 375,381.001 Z M 377,381.001L 378,381.001L 378,382.001L 377,382.001L 377,381.001 Z M 375,383.001L 376,383.001L 376,384.001L 375,384.001L 375,383.001 Z M 377,383L 378,383L 378,384L 377,384L 377,383 Z M 375,385L 376,385L 376,386L 375,386L 375,385 Z M 377,385L 378,385L 378,386L 377,386L 377,385 Z M 375,387L 376,387L 376,388L 375,388L 375,387 Z M 377,387L 378,387L 378,388L 377,388L 377,387 Z M 375,389L 376,389L 376,390L 375,390L 375,389 Z M 377,389L 378,389L 378,390L 377,390L 377,389 Z "
                                  Fill="{StaticResource ResizeThumb.GlyphBrush}"
                                  Height="11"
                                  Stretch="Fill"
                                  Width="3"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Fill"
                                    TargetName="Path"
                                    Value="{StaticResource ResizeThumb.GlyphBrush.IsMouseOver}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity"
                                    TargetName="Root"
                                    Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource {x:Type TextBox}}" TargetType="{x:Type dxspsi:XpfCellInplaceEditor}">
        <Setter Property="Visibility" Value="Hidden"/>
        <Setter Property="Background" Value="Red"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type dxspsi:XpfCellInplaceEditor}">
                    <Grid x:Name="RootElement"
                          Background="{TemplateBinding Background}"
                          Margin="{TemplateBinding Margin}">
                        <Grid>
                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                <ScrollViewer x:Name="PART_ContentHost"
                                              Background="{TemplateBinding Background}"
                                              Foreground="{TemplateBinding Foreground}"
                                              IsTabStop="False"
                                              Padding="{TemplateBinding Padding}"
                                              VerticalContentAlignment="Center"/>
                            </Border>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--ReferenceEditor-->

    <DataTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=ReferenceEditCollapseButtonTemplate}">
        <Image x:Name="collapse"
               HorizontalAlignment="Center"
               Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/ReferenceEdit_Collapse_16x16.png"
               Stretch="None"
               VerticalAlignment="Center"/>
    </DataTemplate>

    <DataTemplate x:Key="{themes:SpreadsheetThemeKey ResourceKey=ReferenceEditExpandButtonTemplate}">
        <Image x:Name="collapse"
               HorizontalAlignment="Center"
               Source="/DevExpress.Xpf.Spreadsheet.v24.1;component/Images/ReferenceEdit_Expand_16x16.png"
               Stretch="None"
               VerticalAlignment="Center"/>
    </DataTemplate>

</ResourceDictionary>