<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
                    xmlns:dxrt="http://schemas.devexpress.com/winfx/2008/xaml/ribbon/themekeys"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <DataTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=DefaultCaptionContentTemplate}">
        <TextBlock Text="{Binding}"/>
    </DataTemplate>

    <sys:Double x:Key="{dxrt:RibbonPageThemeKey ResourceKey=HeaderTextIndent}">10.0</sys:Double>

    <sys:Double x:Key="{dxrt:RibbonPageThemeKey ResourceKey=MinHeight}">23.0</sys:Double>

    <sys:Double x:Key="{dxrt:RibbonPageThemeKey ResourceKey=AeroMinHeight}">23.0</sys:Double>

    <Thickness x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SelectedPagePopupBorderMargin}">0,20,0,20</Thickness>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SelectedPageContainerStyle}" TargetType="{x:Type ContentControl}">
        <Setter Property="Margin" Value="4,2,4,4"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionContentContainerStyle}" TargetType="{x:Type ContentControl}">
        <Setter Property="Margin" Value="5,0,5,0"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=HighlightedCaptionContentContainerStyle}" TargetType="{x:Type ContentControl}">
        <Setter Property="Margin" Value="5,0,5,0"/>
    </Style>

    <Thickness x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionControlMargin}">1,2,0,-1</Thickness>

    <!-- Office2007Black: Ribbon Header Template and Triggers -->

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionBackgroundTemplate}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Background="Transparent"
              Margin="1,0,1,0"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_NormalChecked" Opacity="0">
                <Border Background="#FFBEBEBE" CornerRadius="4,4,0,0">
                    <Border Background="#FFD0FBFF"
                            CornerRadius="3,3,0,0"
                            Margin="1,1,1,0">
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF7F7F7" Offset="0"/>
                                    <GradientStop Color="#FFD7DADF" Offset="1"/>
                                    <GradientStop Color="#FFF9F9F9" Offset="0.25"/>
                                    <GradientStop Color="#FFEEEFEF" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverUnchecked"
                  Margin="0,0,0,1"
                  Opacity="0">
                <Border Background="#FF999895" CornerRadius="4,4,0,0">
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.75,1" StartPoint="0,1">
                            <GradientStop Color="#FF000000" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Grid Margin="1,1,1,0">
                        <Border CornerRadius="3,3,0,0">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF716B5E" Offset="1"/>
                                    <GradientStop Color="#FF716B5E"/>
                                    <GradientStop Color="#FF8E7D53" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="1"
                              Grid.RowSpan="2"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="#0CEBC227" Offset="0"/>
                                    <GradientStop Color="#7FEBC227" Offset="0.522"/>
                                    <GradientStop Color="#0CEBC227" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                        </Path>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="2"
                              Margin="0"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="#3FEBC227" Offset="0"/>
                                    <GradientStop Color="#7FEBC227" Offset="0.522"/>
                                    <GradientStop Color="#3FEBC227" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path Data="F1 M 369,270L 404,270C 404,270 405,285 387,285C 369,285 369,271 369,270 Z "
                              Grid.RowSpan="3"
                              Height="18"
                              Margin="1,0"
                              Stretch="Fill"
                              StrokeLineJoin="Round"
                              UseLayoutRounding="False"
                              VerticalAlignment="Top">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF000000" Offset="0.5"/>
                                    <GradientStop Color="#7FFFFFFF" Offset="1"/>
                                    <GradientStop Color="#7F000000"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF969695" Offset="0"/>
                                    <GradientStop Color="#26989896" Offset="0.65"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverChecked" Opacity="0">
                <Border CornerRadius="4,4,0,0"
                        Margin="-2,3,-2,0"
                        Opacity="0.5">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1"
                                             MappingMode="RelativeToBoundingBox"
                                             StartPoint="0.5,0">
                            <GradientStop Color="#3FF9CC60" Offset="0"/>
                            <GradientStop Color="#BFF9CC60" Offset="0.75"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#3FF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFD7BC8A" Offset="0"/>
                            <GradientStop Color="#FFF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFF8ECC6" Offset="0"/>
                                <GradientStop Color="#FFFFFFBD" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF4F4F4" Offset="0"/>
                                    <GradientStop Color="#FFD7DADF" Offset="1"/>
                                    <GradientStop Color="#FFF8F8F8" Offset="0.25"/>
                                    <GradientStop Color="#FFEEEEEE" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <ContentPresenter/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStateGroup">
                    <VisualState x:Name="NormalUnchecked"/>
                    <VisualState x:Name="NormalChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverUnchecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverUnchecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="PressedChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <!-- Office2007Black: Ribbon Page Button Separator Template -->

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SeparatorTemplate}">
        <Rectangle Stretch="Fill" Width="1">
            <Rectangle.Fill>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#00000000" Offset="0"/>
                    <GradientStop Color="#99000000" Offset="1"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=RightRepeatButtonTemplate}" TargetType="{x:Type RepeatButton}">
        <Grid Margin="-2,-3,-3,-3"
              SnapsToDevicePixels="True"
              Width="12">
            <Grid x:Name="PART_Normal">
                <Border BorderThickness="0"
                        CornerRadius="0,3,3,0"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF7e8894" Offset="0"/>
                            <GradientStop Color="#FF98a7b3" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="0,2,2,0"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="#FFf0f0f2" Offset="0"/>
                                <GradientStop Color="#FFf3f3f3" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0,1,1,0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFdcdfe3" Offset="0"/>
                                    <GradientStop Color="#FFe5e8ec" Offset="1"/>
                                    <GradientStop Color="#FFcacdd3" Offset="0.25"/>
                                    <GradientStop Color="#FFbcc2c8" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_MouseOver" Opacity="0">
                <Border BorderThickness="0"
                        CornerRadius="0,3,3,0"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF7e8894" Offset="0"/>
                            <GradientStop Color="#FF98a7b3" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="0,2,2,0"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="#FFCDEBF7" Offset="0"/>
                                <GradientStop Color="#FFF3F6FB" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0,2,2,0"
                                Margin="1,0,0,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFfdfde4" Offset="0"/>
                                    <GradientStop Color="#FFffebac" Offset="1"/>
                                    <GradientStop Color="#FFffe79f" Offset="0.25"/>
                                    <GradientStop Color="#FFffd869" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Pressed" Opacity="0">
                <Border BorderThickness="0"
                        CornerRadius="0,3,3,0"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF7e8894" Offset="0"/>
                            <GradientStop Color="#FF98a7b3" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="0,2,2,0"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="#FFCDEBF7" Offset="0"/>
                                <GradientStop Color="#FFF3F6FB" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0,1,1,0"
                                Margin="1,0,0,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFc69b61" Offset="0"/>
                                    <GradientStop Color="#FFffc470" Offset="1"/>
                                    <GradientStop Color="#FFdca966" Offset="0.5"/>
                                    <GradientStop Color="#FFeeb469" Offset="0.5"/>
                                    <GradientStop Color="#FFeeb469" Offset="0.25"/>
                                    <GradientStop Color="#FFffa140" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Path Data="F1 M 102,14L 102,19L 104.55,16.4505L 102,14 Z "
                  Fill="#FF000000"
                  Height="6"
                  HorizontalAlignment="Center"
                  Margin="0"
                  SnapsToDevicePixels="True"
                  Stretch="Fill"
                  VerticalAlignment="Center"
                  Width="3"/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Normal" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_MouseOver" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Normal" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_MouseOver" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="MouseOver">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Normal" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_MouseOver" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=LeftRepeatButtonTemplate}" TargetType="{x:Type RepeatButton}">
        <Grid Margin="-3,-3,-2,-3"
              SnapsToDevicePixels="True"
              Width="12">
            <Grid x:Name="PART_Normal">
                <Border BorderThickness="0"
                        CornerRadius="2,0,0,2"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF7e8894" Offset="0"/>
                            <GradientStop Color="#FF98a7b3" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="1,0,0,1"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="#FFf0f0f2" Offset="0"/>
                                <GradientStop Color="#FFf3f3f3" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="0"
                                Margin="1"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFdcdfe3" Offset="0"/>
                                    <GradientStop Color="#FFe5e8ec" Offset="1"/>
                                    <GradientStop Color="#FFcacdd3" Offset="0.25"/>
                                    <GradientStop Color="#FFbcc2c8" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_MouseOver" Opacity="0">
                <Border BorderThickness="0"
                        CornerRadius="3,0,0,3"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF7e8894" Offset="0"/>
                            <GradientStop Color="#FF98a7b3" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="2,0,0,2"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="#FFCDEBF7" Offset="0"/>
                                <GradientStop Color="#FFF3F6FB" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="2,0,0,2"
                                Margin="0,0,1,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFfdfde4" Offset="0"/>
                                    <GradientStop Color="#FFffebac" Offset="1"/>
                                    <GradientStop Color="#FFffe79f" Offset="0.25"/>
                                    <GradientStop Color="#FFffd869" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_Pressed" Opacity="0">
                <Border BorderThickness="0"
                        CornerRadius="3,0,0,3"
                        SnapsToDevicePixels="True">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF7e8894" Offset="0"/>
                            <GradientStop Color="#FF98a7b3" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border BorderThickness="0"
                            CornerRadius="2,0,0,2"
                            Margin="1"
                            SnapsToDevicePixels="True">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="#FFCDEBF7" Offset="0"/>
                                <GradientStop Color="#FFF3F6FB" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border BorderThickness="0"
                                CornerRadius="1,0,0,1"
                                Margin="0,0,1,0"
                                SnapsToDevicePixels="True">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFc69b61" Offset="0"/>
                                    <GradientStop Color="#FFffc470" Offset="1"/>
                                    <GradientStop Color="#FFdca966" Offset="0.5"/>
                                    <GradientStop Color="#FFeeb469" Offset="0.5"/>
                                    <GradientStop Color="#FFeeb469" Offset="0.25"/>
                                    <GradientStop Color="#FFffa140" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Path Data="F1 M 91,15L 90.9999,21L 88,18L 91,15 Z "
                  Fill="#FF000000"
                  Height="6"
                  HorizontalAlignment="Center"
                  Margin="0"
                  SnapsToDevicePixels="True"
                  Stretch="Fill"
                  VerticalAlignment="Center"
                  Width="3"/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Normal" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_MouseOver" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Normal" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_MouseOver" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="MouseOver">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Normal" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_MouseOver" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Pressed" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <!--Background-->

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey  ResourceKey=BackgroundTemplate}" TargetType="{x:Type ContentControl}">
        <ContentPresenter/>
    </ControlTemplate>

    <dx:ColorOverlayConverter x:Key="colorOverlayConverter"/>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey  ResourceKey=HighlightedCaptionBackgroundTemplate}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Background="Transparent"
              Margin="1,0,1,0"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_NormalChecked" Opacity="0">
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FF999999}" Offset="1"/>
                            <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFB0B0B0}" Offset="0"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,-1">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFF5F5F5}" Offset="0"/>
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD7D7D7}" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,0">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFF0F0F0}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverUnchecked" Opacity="0">
                <Border Background="#FF999895"
                        CornerRadius="4,4,0,0"
                        Margin="0,0,0,1">
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.75,1" StartPoint="0,1">
                            <GradientStop Color="#FF000000" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Grid Margin="1,1,1,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.5*"/>
                            <RowDefinition Height="0.25*"/>
                            <RowDefinition Height="0.25*"/>
                        </Grid.RowDefinitions>
                        <Border CornerRadius="3,3,0,0" Grid.RowSpan="3">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF716B5E" Offset="1"/>
                                    <GradientStop Color="#FF716B5E"/>
                                    <GradientStop Color="#FF8E7D53" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="1"
                              Grid.RowSpan="2"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#3F949494}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#7F949494}" Offset="0.5"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#3F949494}" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                        </Path>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="2"
                              Margin="0"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#0C949494}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FF949494}" Offset="0.5"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#0C949494}" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path Data="F1 M 369,270L 404,270C 404,270 405,285 387,285C 369,285 369,271 369,270 Z "
                              Grid.RowSpan="3"
                              Height="18"
                              Margin="1,0"
                              Stretch="Fill"
                              StrokeLineJoin="Round"
                              UseLayoutRounding="False"
                              VerticalAlignment="Top">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF000000" Offset="0.5"/>
                                    <GradientStop Color="#7FFFFFFF" Offset="1"/>
                                    <GradientStop Color="#7F000000"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF969695" Offset="0"/>
                                    <GradientStop Color="#26989896" Offset="0.65"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverChecked"
                  Grid.ColumnSpan="3"
                  Opacity="0">
                <Border CornerRadius="4,4,0,0"
                        Margin="-2,3,-2,0"
                        Opacity="0.5">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1"
                                             MappingMode="RelativeToBoundingBox"
                                             StartPoint="0.5,0">
                            <GradientStop Color="#3FF9CC60" Offset="0"/>
                            <GradientStop Color="#BFF9CC60" Offset="0.75"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#3FF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFD7BC8A" Offset="0"/>
                            <GradientStop Color="#FFF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFF8ECC6" Offset="0"/>
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFFFFFFF}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <ContentPresenter/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStateGroup">
                    <VisualState x:Name="NormalUnchecked"/>
                    <VisualState x:Name="NormalChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverUnchecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverUnchecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="PressedChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <!--BEGIN WPF-->

    <Thickness x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionControlMarginInAeroWindow}">1,2,0,-1</Thickness>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SeparatorTemplateInAeroWindow}">
        <Rectangle Stretch="Fill" Width="1">
            <Rectangle.Fill>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#00000000" Offset="0"/>
                    <GradientStop Color="#99000000" Offset="1"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionBackgroundTemplateInAeroWindow}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Background="Transparent"
              Margin="1,0,1,0"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_NormalChecked" Opacity="0">
                <Border Background="#FFBEBEBE" CornerRadius="4,4,0,0">
                    <Border Background="#FFD0FBFF"
                            CornerRadius="3,3,0,0"
                            Margin="1,1,1,0">
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF7F7F7" Offset="0"/>
                                    <GradientStop Color="#FFD7DADF" Offset="1"/>
                                    <GradientStop Color="#FFF9F9F9" Offset="0.25"/>
                                    <GradientStop Color="#FFEEEFEF" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverUnchecked"
                  Margin="0,0,0,1"
                  Opacity="0">
                <Border Background="#FF999895" CornerRadius="4,4,0,0">
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.75,1" StartPoint="0,1">
                            <GradientStop Color="#FF000000" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Grid Margin="1,1,1,0">
                        <Border CornerRadius="3,3,0,0">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF716B5E" Offset="1"/>
                                    <GradientStop Color="#FF716B5E"/>
                                    <GradientStop Color="#FF8E7D53" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="1"
                              Grid.RowSpan="2"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="#0CEBC227" Offset="0"/>
                                    <GradientStop Color="#7FEBC227" Offset="0.522"/>
                                    <GradientStop Color="#0CEBC227" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                        </Path>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="2"
                              Margin="0"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="#3FEBC227" Offset="0"/>
                                    <GradientStop Color="#7FEBC227" Offset="0.522"/>
                                    <GradientStop Color="#3FEBC227" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path Data="F1 M 369,270L 404,270C 404,270 405,285 387,285C 369,285 369,271 369,270 Z "
                              Grid.RowSpan="3"
                              Height="18"
                              Margin="1,0"
                              Stretch="Fill"
                              StrokeLineJoin="Round"
                              UseLayoutRounding="False"
                              VerticalAlignment="Top">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF000000" Offset="0.5"/>
                                    <GradientStop Color="#7FFFFFFF" Offset="1"/>
                                    <GradientStop Color="#7F000000"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF969695" Offset="0"/>
                                    <GradientStop Color="#26989896" Offset="0.65"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverChecked" Opacity="0">
                <Border CornerRadius="4,4,0,0"
                        Margin="-2,3,-2,0"
                        Opacity="0.5">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1"
                                             MappingMode="RelativeToBoundingBox"
                                             StartPoint="0.5,0">
                            <GradientStop Color="#3FF9CC60" Offset="0"/>
                            <GradientStop Color="#BFF9CC60" Offset="0.75"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#3FF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFD7BC8A" Offset="0"/>
                            <GradientStop Color="#FFF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFF8ECC6" Offset="0"/>
                                <GradientStop Color="#FFFFFFBD" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF4F4F4" Offset="0"/>
                                    <GradientStop Color="#FFD7DADF" Offset="1"/>
                                    <GradientStop Color="#FFF8F8F8" Offset="0.25"/>
                                    <GradientStop Color="#FFEEEEEE" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <ContentPresenter/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStateGroup">
                    <VisualState x:Name="NormalUnchecked"/>
                    <VisualState x:Name="NormalChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverUnchecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverUnchecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="PressedChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=HighlightedCaptionBackgroundTemplateInAeroWindow}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Background="Transparent"
              Margin="1,0,1,0"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_NormalChecked" Opacity="0">
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FF999999}" Offset="1"/>
                            <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFB0B0B0}" Offset="0"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,-1">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFF5F5F5}" Offset="0"/>
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD7D7D7}" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,0">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFF0F0F0}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverUnchecked" Opacity="0">
                <Border Background="#FF999895"
                        CornerRadius="4,4,0,0"
                        Margin="0,0,0,1">
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.75,1" StartPoint="0,1">
                            <GradientStop Color="#FF000000" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Grid Margin="1,1,1,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.5*"/>
                            <RowDefinition Height="0.25*"/>
                            <RowDefinition Height="0.25*"/>
                        </Grid.RowDefinitions>
                        <Border CornerRadius="3,3,0,0" Grid.RowSpan="3">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF716B5E" Offset="1"/>
                                    <GradientStop Color="#FF716B5E"/>
                                    <GradientStop Color="#FF8E7D53" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="1"
                              Grid.RowSpan="2"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#3F949494}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#7F949494}" Offset="0.5"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#3F949494}" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                        </Path>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="2"
                              Margin="0"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#0C949494}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FF949494}" Offset="0.5"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#0C949494}" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path Data="F1 M 369,270L 404,270C 404,270 405,285 387,285C 369,285 369,271 369,270 Z "
                              Grid.RowSpan="3"
                              Height="18"
                              Margin="1,0"
                              Stretch="Fill"
                              StrokeLineJoin="Round"
                              UseLayoutRounding="False"
                              VerticalAlignment="Top">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF000000" Offset="0.5"/>
                                    <GradientStop Color="#7FFFFFFF" Offset="1"/>
                                    <GradientStop Color="#7F000000"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF969695" Offset="0"/>
                                    <GradientStop Color="#26989896" Offset="0.65"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverChecked"
                  Grid.ColumnSpan="3"
                  Opacity="0">
                <Border CornerRadius="4,4,0,0"
                        Margin="-2,3,-2,0"
                        Opacity="0.5">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1"
                                             MappingMode="RelativeToBoundingBox"
                                             StartPoint="0.5,0">
                            <GradientStop Color="#3FF9CC60" Offset="0"/>
                            <GradientStop Color="#BFF9CC60" Offset="0.75"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#3FF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFD7BC8A" Offset="0"/>
                            <GradientStop Color="#FFF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFF8ECC6" Offset="0"/>
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFFFFFFF}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <ContentPresenter/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStateGroup">
                    <VisualState x:Name="NormalUnchecked"/>
                    <VisualState x:Name="NormalChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverUnchecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverUnchecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="PressedChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=CaptionBackgroundTemplateInAeroWindowInMinimizedRibbon}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Background="Transparent"
              Margin="1,0,1,0"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_NormalChecked" Opacity="0">
                <Border Background="#FFBEBEBE" CornerRadius="4,4,0,0">
                    <Border Background="#FFD0FBFF"
                            CornerRadius="3,3,0,0"
                            Margin="1,1,1,0">
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF7F7F7" Offset="0"/>
                                    <GradientStop Color="#FFD7DADF" Offset="1"/>
                                    <GradientStop Color="#FFF9F9F9" Offset="0.25"/>
                                    <GradientStop Color="#FFEEEFEF" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverUnchecked"
                  Margin="0,0,0,1"
                  Opacity="0">
                <Border Background="#FF999895" CornerRadius="4,4,0,0">
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.75,1" StartPoint="0,1">
                            <GradientStop Color="#FF000000" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Grid Margin="1,1,1,0">
                        <Border CornerRadius="3,3,0,0">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF716B5E" Offset="1"/>
                                    <GradientStop Color="#FF716B5E"/>
                                    <GradientStop Color="#FF8E7D53" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="1"
                              Grid.RowSpan="2"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="#0CEBC227" Offset="0"/>
                                    <GradientStop Color="#7FEBC227" Offset="0.522"/>
                                    <GradientStop Color="#0CEBC227" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                        </Path>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="2"
                              Margin="0"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="#3FEBC227" Offset="0"/>
                                    <GradientStop Color="#7FEBC227" Offset="0.522"/>
                                    <GradientStop Color="#3FEBC227" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path Data="F1 M 369,270L 404,270C 404,270 405,285 387,285C 369,285 369,271 369,270 Z "
                              Grid.RowSpan="3"
                              Height="18"
                              Margin="1,0"
                              Stretch="Fill"
                              StrokeLineJoin="Round"
                              UseLayoutRounding="False"
                              VerticalAlignment="Top">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF000000" Offset="0.5"/>
                                    <GradientStop Color="#7FFFFFFF" Offset="1"/>
                                    <GradientStop Color="#7F000000"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF969695" Offset="0"/>
                                    <GradientStop Color="#26989896" Offset="0.65"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverChecked" Opacity="0">
                <Border CornerRadius="4,4,0,0"
                        Margin="-2,3,-2,0"
                        Opacity="0.5">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1"
                                             MappingMode="RelativeToBoundingBox"
                                             StartPoint="0.5,0">
                            <GradientStop Color="#3FF9CC60" Offset="0"/>
                            <GradientStop Color="#BFF9CC60" Offset="0.75"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#3FF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFD7BC8A" Offset="0"/>
                            <GradientStop Color="#FFF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFF8ECC6" Offset="0"/>
                                <GradientStop Color="#FFFFFFBD" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF4F4F4" Offset="0"/>
                                    <GradientStop Color="#FFD7DADF" Offset="1"/>
                                    <GradientStop Color="#FFF8F8F8" Offset="0.25"/>
                                    <GradientStop Color="#FFEEEEEE" Offset="0.25"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <ContentPresenter/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStateGroup">
                    <VisualState x:Name="NormalUnchecked"/>
                    <VisualState x:Name="NormalChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverUnchecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverUnchecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="PressedChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxrt:RibbonPageThemeKey ResourceKey=HighlightedCaptionBackgroundTemplateInAeroWindowInMinimizedRibbon}" TargetType="{x:Type dxr:RibbonCheckedBorderControl}">
        <Grid Background="Transparent"
              Margin="1,0,1,0"
              SnapsToDevicePixels="True">
            <Grid x:Name="PART_NormalChecked" Opacity="0">
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FF999999}" Offset="1"/>
                            <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFB0B0B0}" Offset="0"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,-1">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFF5F5F5}" Offset="0"/>
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD7D7D7}" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,0">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFF0F0F0}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverUnchecked" Opacity="0">
                <Border Background="#FF999895"
                        CornerRadius="4,4,0,0"
                        Margin="0,0,0,1">
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.75,1" StartPoint="0,1">
                            <GradientStop Color="#FF000000" Offset="0"/>
                            <GradientStop Color="#FFFFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Grid Margin="1,1,1,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.5*"/>
                            <RowDefinition Height="0.25*"/>
                            <RowDefinition Height="0.25*"/>
                        </Grid.RowDefinitions>
                        <Border CornerRadius="3,3,0,0" Grid.RowSpan="3">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF716B5E" Offset="1"/>
                                    <GradientStop Color="#FF716B5E"/>
                                    <GradientStop Color="#FF8E7D53" Offset="0.5"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="1"
                              Grid.RowSpan="2"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#3F949494}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#7F949494}" Offset="0.5"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#3F949494}" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                        </Path>
                        <Path Data="F1 M 195.5,83.0001C 200.027,83.0001 203.727,86.5383 203.986,91L 187.014,91C 187.273,86.5383 190.973,83.0001 195.5,83.0001 Z "
                              Grid.Row="2"
                              Margin="0"
                              Stretch="Fill"
                              UseLayoutRounding="False">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF000000" Offset="1"/>
                                    <GradientStop Color="#3FFFFFFF" Offset="0.35"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.974,0.667" StartPoint="0.026,0.833">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#0C949494}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FF949494}" Offset="0.5"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#0C949494}" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path Data="F1 M 369,270L 404,270C 404,270 405,285 387,285C 369,285 369,271 369,270 Z "
                              Grid.RowSpan="3"
                              Height="18"
                              Margin="1,0"
                              Stretch="Fill"
                              StrokeLineJoin="Round"
                              UseLayoutRounding="False"
                              VerticalAlignment="Top">
                            <Path.OpacityMask>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Color="#FF000000" Offset="0.5"/>
                                    <GradientStop Color="#7FFFFFFF" Offset="1"/>
                                    <GradientStop Color="#7F000000"/>
                                </LinearGradientBrush>
                            </Path.OpacityMask>
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FF969695" Offset="0"/>
                                    <GradientStop Color="#26989896" Offset="0.65"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </Border>
            </Grid>
            <Grid x:Name="PART_HoverChecked"
                  Grid.ColumnSpan="3"
                  Opacity="0">
                <Border CornerRadius="4,4,0,0"
                        Margin="-2,3,-2,0"
                        Opacity="0.5">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1"
                                             MappingMode="RelativeToBoundingBox"
                                             StartPoint="0.5,0">
                            <GradientStop Color="#3FF9CC60" Offset="0"/>
                            <GradientStop Color="#BFF9CC60" Offset="0.75"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#7FF9CC60" Offset="0.5"/>
                            <GradientStop Color="#3FF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Border CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FFD7BC8A" Offset="0"/>
                            <GradientStop Color="#FFF9CC60" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border CornerRadius="3,3,0,0" Margin="1,1,1,0">
                        <Border.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFF8ECC6" Offset="0"/>
                                <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border CornerRadius="2,2,0,0" Margin="1,1,1,-1">
                            <Border.Background>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFFFFFFF}" Offset="0"/>
                                    <GradientStop Color="{Binding Path=Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorOverlayConverter}, ConverterParameter=#FFD5D5D5}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </Border>
            </Grid>
            <ContentPresenter/>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStateGroup">
                    <VisualState x:Name="NormalUnchecked"/>
                    <VisualState x:Name="NormalChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverUnchecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverUnchecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="HoverChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="PressedChecked">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_NormalChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Duration="0"
                                             Storyboard.TargetName="PART_HoverChecked"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SelectedTextStyleInAeroWindow}" TargetType="{x:Type ContentControl}">
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="Margin" Value="0,4,0,3"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=NormalTextStyleInAeroWindow}" TargetType="{x:Type ContentControl}">
        <Setter Property="Foreground" Value="#FFFFFFFF"/>
        <Setter Property="Margin" Value="0,4,0,3"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=HoverTextStyleInAeroWindow}" TargetType="{x:Type ContentControl}">
        <Setter Property="Foreground" Value="#FFFFFFFF"/>
        <Setter Property="Margin" Value="0,4,0,3"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=SelectedTextStyleInAeroWindowInMinimizedRibbon}" TargetType="{x:Type ContentControl}">
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="Margin" Value="0,4,0,3"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=NormalTextStyleInAeroWindowInMinimizedRibbon}" TargetType="{x:Type ContentControl}">
        <Setter Property="Foreground" Value="#FFFFFFFF"/>
        <Setter Property="Margin" Value="0,4,0,3"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="{dxrt:RibbonPageThemeKey ResourceKey=HoverTextStyleInAeroWindowInMinimizedRibbon}" TargetType="{x:Type ContentControl}">
        <Setter Property="Foreground" Value="#FFFFFFFF"/>
        <Setter Property="Margin" Value="0,4,0,3"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <!--END WPF-->

</ResourceDictionary>