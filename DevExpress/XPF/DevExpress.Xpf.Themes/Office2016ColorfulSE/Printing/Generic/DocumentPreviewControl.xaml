<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars" xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dxt="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys" xmlns:dxd="http://schemas.devexpress.com/winfx/2008/xaml/docking" xmlns:dxdv="http://schemas.devexpress.com/winfx/2008/xaml/documentviewer" xmlns:dxdvt="http://schemas.devexpress.com/winfx/2008/xaml/documentviewer/themekeys" xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid" xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" xmlns:mvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon" xmlns:dxco="http://schemas.devexpress.com/winfx/2008/xaml/controls" xmlns:dxcot="http://schemas.devexpress.com/winfx/2008/xaml/controls/themekeys" xmlns:dxcoi="http://schemas.devexpress.com/winfx/2008/xaml/controls/internal" xmlns:dxi="http://schemas.devexpress.com/winfx/2008/xaml/core/internal" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:local="http://schemas.devexpress.com/winfx/2008/xaml/printing" xmlns:dxpn="http://schemas.devexpress.com/winfx/2008/xaml/printing/native" xmlns:dxpp="http://schemas.devexpress.com/winfx/2008/xaml/printing/parameters" xmlns:bars="http://schemas.devexpress.com/winfx/2008/xaml/printing/bars" xmlns:native="http://schemas.devexpress.com/winfx/2008/xaml/printing/native" xmlns:themes="http://schemas.devexpress.com/winfx/2008/xaml/printing/themekeys" xmlns:xtraprintingnative="clr-namespace:DevExpress.XtraPrinting.Native;assembly=DevExpress.Printing.v24.1.Core" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys">
  <sys:Boolean x:Key="TrueBoolean">True</sys:Boolean>
  <sys:Boolean x:Key="FalseBoolean">false</sys:Boolean>
  <BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter" />
  <native:NumberToVisibilityConverter x:Key="visibilityConverter" />
  <native:ObjectToCollectionConverter x:Key="objectToCollectionConverter" />
  <dx:ObjectToBooleanConverter x:Key="objectToBooleanConverter" />
  <dx:BoolToVisibilityConverter x:Key="boolToVisibilityConverter" />
  <local:CursorModeToCanMouseScrollConverter x:Key="cursorModeToCanMouseScrollConverter" />
  <sys:Double x:Key="zoomComboBoxWidth">100</sys:Double>
  <dx:FormatStringConverter FormatString="/ {0}" x:Key="pageCountFormatStringConverter" />
  <dx:BoolInverseConverter x:Key="boolInverseConverter" />
  <Color x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=HighlightSelectionColor}">#596098C0</Color>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PaginationTemplate}">
    <Grid Margin="10,0,10,0">
      <StackPanel Orientation="Horizontal">
        <TextBlock Text="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CurrentPageNumber, RelativeSource={RelativeSource TemplatedParent}}" />
        <TextBlock Text=" / " />
        <TextBlock Text="{Binding Path=(local:DocumentPreviewControl.ActualViewer).PageCount, RelativeSource={RelativeSource TemplatedParent}}" />
      </StackPanel>
    </Grid>
  </DataTemplate>
  <Style TargetType="{x:Type dxb:BarItem}" x:Key="previewBarItemStyle">
    <Setter Property="Glyph" Value="{Binding Path=SmallGlyph, Converter={dxpn:UriToSvgImageSourceConverter}}" />
    <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph, Converter={dxpn:UriToSvgImageSourceConverter}}" />
    <Setter Property="GlyphAlignment" Value="Top" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarButtonItem}" TargetType="{x:Type bars:DocumentPreviewBarButtonItem}" BasedOn="{StaticResource previewBarItemStyle}">
    <Setter Property="Content" Value="{Binding Path=Caption}" />
    <Setter Property="Hint" Value="{Binding Path=Hint}" />
  </Style>
  <dxdv:CheckBarItemTemplateSelector x:Key="checkItemTemplateSelector" />
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarSubItem}" TargetType="{x:Type bars:DocumentPreviewBarSubItem}" BasedOn="{StaticResource previewBarItemStyle}">
    <Setter Property="Content" Value="{Binding Path=Caption}" />
    <Setter Property="Hint" Value="{Binding Path=Hint}" />
    <Setter Property="ItemLinksSource" Value="{Binding Path=Items}" />
    <Setter Property="ItemTemplateSelector" Value="{StaticResource checkItemTemplateSelector}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarCheckItem}" TargetType="{x:Type bars:DocumentPreviewBarCheckItem}" BasedOn="{StaticResource previewBarItemStyle}">
    <Setter Property="Content" Value="{Binding Path=Caption}" />
    <Setter Property="Hint" Value="{Binding Path=Hint}" />
    <Setter Property="IsChecked" Value="{Binding Path=IsChecked, Mode=OneWay}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.PageLayoutBarSubItem}" TargetType="{x:Type bars:PageLayoutBarSubItem}" BasedOn="{StaticResource previewBarItemStyle}">
    <Setter Property="SubItemsGlyphSize" Value="Large" />
    <Setter Property="Content" Value="{Binding Path=Caption}" />
    <Setter Property="Hint" Value="{Binding Path=Hint}" />
    <Setter Property="ItemLinksSource" Value="{Binding Path=Items}" />
    <Setter Property="ItemTemplate">
      <Setter.Value>
        <DataTemplate>
          <ContentControl>
            <bars:PageLayoutBarCheckItem Command="{Binding}" />
          </ContentControl>
        </DataTemplate>
      </Setter.Value>
    </Setter>
    <Setter Property="ItemTemplateSelector" Value="{x:Null}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.SelectToolBarItem}" TargetType="{x:Type bars:SelectToolBarItem}" BasedOn="{StaticResource {dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarCheckItem}}">
    <Setter Property="CommandParameter" Value="{Binding Path=CommandValue}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.HandToolBarItem}" TargetType="{x:Type bars:HandToolBarItem}" BasedOn="{StaticResource {dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.DocumentPreviewBarCheckItem}}">
    <Setter Property="CommandParameter" Value="{Binding Path=CommandValue}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.PageNumberEditItem}" TargetType="{x:Type bars:PageNumberEditItem}">
    <Setter Property="Content" Value="{local:PrintingStringId StringId=GoToPage}" />
    <Setter Property="Content2" Value="{Binding Path=SettingsSource.PageCount, Converter={StaticResource pageCountFormatStringConverter}, RelativeSource={RelativeSource Self}}" />
    <Setter Property="EditValue" Value="{Binding Mode=TwoWay, UpdateSourceTrigger=Explicit, Path=SettingsSource.CurrentPageNumber, FallbackValue=0, RelativeSource={RelativeSource Self}}" />
    <Setter Property="IsEnabled" Value="{Binding SettingsSource.PageCount, FallbackValue=False, RelativeSource={RelativeSource Self}}" />
    <Setter Property="EditStyle">
      <Setter.Value>
        <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=http://schemas.devexpress.com/winfx/2008/xaml/editors.TextEdit}" TargetType="{x:Type dxe:TextEdit}">
          <Setter Property="Padding" Value="0,-2,0,-2" />
          <Setter Property="MinWidth" Value="30" />
        </Style>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.ExportSplitItem}" TargetType="{x:Type bars:ExportSplitItem}" BasedOn="{StaticResource previewBarItemStyle}">
    <Setter Property="Content" Value="{Binding Path=Caption}" />
    <Setter Property="Hint" Value="{Binding Path=Hint}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.ZoomFactorEditItem}" TargetType="{x:Type bars:ZoomFactorEditItem}">
    <Setter Property="Content" Value="{Binding SettingsSource.ZoomFactor, FallbackValue={x:Null}, Converter={mvvm:FormatStringConverter FormatString=P0}, RelativeSource={RelativeSource Self}}" />
    <Setter Property="EditValue" Value="{Binding SettingsSource.ZoomFactor, FallbackValue=1, Converter={native:TrackBarZoomValueConverter MinZoomValue=0.1, MaxZoomValue=5}, RelativeSource={RelativeSource Self}}" />
    <Setter Property="IsEnabled" Value="{Binding SettingsSource.ZoomFactor, FallbackValue=False, RelativeSource={RelativeSource Self}}" />
  </Style>
  <Style TargetType="{x:Type dxb:BarButtonItem}" x:Key="exportItemStyleBase" BasedOn="{StaticResource previewBarItemStyle}">
    <Setter Property="Hint" Value="{Binding Path=Hint}" />
    <Setter Property="CommandParameter" Value="{Binding Format}" />
    <Setter Property="Command" Value="{Binding}" />
    <Setter Property="Content" Value="{Binding}" />
    <Setter Property="ContentTemplate">
      <Setter.Value>
        <DataTemplate>
          <StackPanel>
            <TextBlock Text="{Binding Caption, Mode=OneWay}" />
            <TextBlock Text="{Binding Tag, Mode=OneWay}" Opacity="0.5" />
          </StackPanel>
        </DataTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey  ResourceKey=ExportPopupMenuItemTemplate}">
    <ContentControl>
      <dxb:BarButtonItem Style="{StaticResource exportItemStyleBase}" local:DocumentPreviewControl.BarItemName="{Binding Path=Format, StringFormat=bExport{0}}" />
    </ContentControl>
  </DataTemplate>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey  ResourceKey=SendPopupMenuItemTemplate}">
    <ContentControl>
      <dxb:BarButtonItem Style="{StaticResource exportItemStyleBase}" local:DocumentPreviewControl.BarItemName="{Binding Path=Format, StringFormat=bSend{0}}" />
    </ContentControl>
  </DataTemplate>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.ProgressEditItem}" TargetType="{x:Type bars:ProgressEditItem}">
    <Setter Property="EditValue" Value="{Binding ProgressSettings.ProgressPosition, Mode=OneWay, FallbackValue=0, RelativeSource={RelativeSource Self}}" />
    <Setter Property="IsVisible" Value="{Binding ProgressSettings.InProgress, FallbackValue={StaticResource FalseBoolean}, RelativeSource={RelativeSource Self}}" />
    <Setter Property="EditStyle">
      <Setter.Value>
        <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=http://schemas.devexpress.com/winfx/2008/xaml/editors.ProgressBarEdit}" TargetType="{x:Type dxe:ProgressBarEdit}">
          <Setter Property="MinWidth" Value="150" />
          <Setter Property="ContentDisplayMode" Value="Value" />
          <Setter Property="DisplayFormatString" Value="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.ProgressDisplayText, RelativeSource={RelativeSource Self}}" />
        </Style>
      </Setter.Value>
    </Setter>
    <Setter Property="EditHeight" Value="22" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Bars.StopPageBuildItem}" TargetType="{x:Type bars:StopPageBuildItem}">
    <Setter Property="IsVisible" Value="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" />
  </Style>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=NavigationPaneDockLayoutTemplate}">
    <dxd:DockLayoutManager Background="Transparent" DisposeOnWindowClosing="False" ViewStyle="Light">
      <mvvm:Interaction.Behaviors>
        <native:HideClosingItemsBehavior />
      </mvvm:Interaction.Behaviors>
      <dxd:LayoutGroup>
        <dxd:LayoutGroup Orientation="Vertical" ItemWidth="300">
          <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=Parameters}" MinWidth="150">
            <dxd:LayoutPanel.Visibility>
              <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                <MultiBinding.Converter>
                  <local:DockPanelVisibilityConverter />
                </MultiBinding.Converter>
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).PropertyProvider.ShowParametersPanel" Mode="TwoWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel.HasVisibleParameters" Mode="OneWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).AutoShowParametersPanel" Mode="OneWay" />
              </MultiBinding>
            </dxd:LayoutPanel.Visibility>
            <dxpp:ParametersPanel ParametersModel="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel, RelativeSource={RelativeSource Self}}" IsEnabled="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.IsCreating, Converter={StaticResource boolInverseConverter}, RelativeSource={RelativeSource Self}}">
              <mvvm:Interaction.Behaviors>
                <native:LegacyParametersPanelModelSwitcher />
              </mvvm:Interaction.Behaviors>
            </dxpp:ParametersPanel>
          </dxd:LayoutPanel>
          <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=NavigationPane_Title}" MinWidth="150">
            <dxd:LayoutPanel.Visibility>
              <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                <MultiBinding.Converter>
                  <local:DockPanelVisibilityConverter />
                </MultiBinding.Converter>
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ShowNavigationPane" Mode="TwoWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).Document" Converter="{StaticResource objectToBooleanConverter}" Mode="OneWay" />
              </MultiBinding>
            </dxd:LayoutPanel.Visibility>
            <local:NavigationPaneControl Margin="12,12,12,0" />
          </dxd:LayoutPanel>
        </dxd:LayoutGroup>
        <dxd:LayoutPanel Name="DocumentViewerPanel" AllowClose="False" AllowDrag="False" ShowCaption="False" ShowBorder="False" Background="Transparent" Caption="{local:PrintingStringId StringId=ToolBarCaption}">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="auto" />
              <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <dxco:BreadcrumbControl DisplayMember="Name" KeyMember="ID" ParentMember="ParentID" EditMode="Items" PopupHeight="0" Visibility="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.BreadcrumbViewModel.Visible, RelativeSource={RelativeSource Self}, Converter={StaticResource boolToVisibilityConverter}, FallbackValue=Collapsed}" SelectedItem="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.BreadcrumbViewModel.SelectedNode, RelativeSource={RelativeSource Self}, Mode=TwoWay}" ItemsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.BreadcrumbViewModel.NestedReports, RelativeSource={RelativeSource Self}}">
              <dxco:BreadcrumbControl.Resources>
                <Style x:Key="{dxcot:BreadcrumbControlThemeKey ResourceKey=ArrowStyleBase}" TargetType="{x:Type dxcoi:BreadcrumbArrowControl}">
                  <Setter Property="IsHitTestVisible" Value="False" />
                  <Setter Property="Template" Value="{dxi:ThemeResource {dxcot:BreadcrumbControlThemeKey ResourceKey=ArrowTemplate}}" />
                  <Setter Property="Background" Value="Transparent" />
                  <Setter Property="Padding" Value="3" />
                  <Setter Property="BorderThickness" Value="0,1,1,1" />
                  <Setter Property="ArrowGeometry" Value="F1 M 2,0 6,4 2,8 Z" />
                  <Style.Triggers>
                    <Trigger Property="dx:ThemeManager.IsTouchEnabled" Value="True">
                      <Setter Property="Padding" Value="16" />
                    </Trigger>
                    <Trigger Property="dx:ThemeManager.IsTouchlineTheme" Value="True">
                      <Setter Property="Padding" Value="16" />
                    </Trigger>
                  </Style.Triggers>
                </Style>
                <Style x:Key="{dxcot:BreadcrumbControlThemeKey ResourceKey=ArrowStyle, IsThemeIndependent=True}" BasedOn="{StaticResource {dxcot:BreadcrumbControlThemeKey ResourceKey=ArrowStyleBase}}" TargetType="{x:Type dxcoi:BreadcrumbArrowControl}" />
                <Style x:Key="{dxcot:BreadcrumbControlThemeKey ResourceKey=RootItemArrowStyle, IsThemeIndependent=True}" BasedOn="{StaticResource {dxcot:BreadcrumbControlThemeKey ResourceKey=ArrowStyleBase}}" TargetType="{x:Type dxcoi:BreadcrumbArrowControl}">
                  <Setter Property="BorderThickness" Value="1" />
                </Style>
                <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=http://schemas.devexpress.com/winfx/2008/xaml/controls/internal.BreadcrumbPathEdit}" TargetType="dxcoi:BreadcrumbPathEdit">
                  <Setter Property="ShowEditorButtons" Value="False" />
                  <Setter Property="ShowPopupIfReadOnly" Value="False" />
                  <Setter Property="IsReadOnly" Value="True" />
                </Style>
              </dxco:BreadcrumbControl.Resources>
            </dxco:BreadcrumbControl>
            <ContentPresenter Grid.Row="1" Content="{Binding}" />
          </Grid>
        </dxd:LayoutPanel>
      </dxd:LayoutGroup>
    </dxd:DockLayoutManager>
  </DataTemplate>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=SeparatePanelsDockLayoutTemplate}">
    <dxd:DockLayoutManager Background="Transparent" DisposeOnWindowClosing="False">
      <mvvm:Interaction.Behaviors>
        <native:HideClosingItemsBehavior />
      </mvvm:Interaction.Behaviors>
      <dxd:LayoutGroup>
        <dxd:LayoutGroup Orientation="Vertical" ItemWidth="250">
          <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=Parameters}">
            <dxd:LayoutPanel.Visibility>
              <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                <MultiBinding.Converter>
                  <local:DockPanelVisibilityConverter />
                </MultiBinding.Converter>
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).PropertyProvider.ShowParametersPanel" Mode="TwoWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel.HasVisibleParameters" Mode="OneWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).AutoShowParametersPanel" Mode="OneWay" />
              </MultiBinding>
            </dxd:LayoutPanel.Visibility>
            <dxpp:ParametersPanel ParametersModel="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ParameterPanelViewModel, RelativeSource={RelativeSource Self}}" IsEnabled="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.IsCreating, Converter={StaticResource boolInverseConverter}, RelativeSource={RelativeSource Self}}">
              <mvvm:Interaction.Behaviors>
                <native:LegacyParametersPanelModelSwitcher />
              </mvvm:Interaction.Behaviors>
            </dxpp:ParametersPanel>
          </dxd:LayoutPanel>
          <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=DocumentMap}">
            <dxd:LayoutPanel.Visibility>
              <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                <MultiBinding.Converter>
                  <local:DockPanelVisibilityConverter />
                </MultiBinding.Converter>
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).PropertyProvider.ShowDocumentMap" Mode="TwoWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).Document.HasBookmarks" Mode="OneWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).AutoShowDocumentMap" Mode="OneWay" />
              </MultiBinding>
            </dxd:LayoutPanel.Visibility>
            <native:DocumentMap Settings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualDocumentMapSettings, RelativeSource={RelativeSource TemplatedParent}}" SelectedItem="{Binding ActualSettings.SelectedNode, RelativeSource={RelativeSource Self}}" />
          </dxd:LayoutPanel>
          <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=Thumbnails}">
            <dxd:LayoutPanel.Visibility>
              <MultiBinding FallbackValue="Collapsed" Mode="TwoWay">
                <MultiBinding.Converter>
                  <local:DockPanelVisibilityConverter />
                </MultiBinding.Converter>
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ShowThumbnails" Mode="TwoWay" />
                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).Document" Converter="{StaticResource objectToBooleanConverter}" Mode="OneWay" />
              </MultiBinding>
            </dxd:LayoutPanel.Visibility>
            <native:ThumbnailsViewerControl SelectedPageNumber="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CurrentPageNumber, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Settings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ThumbnailsSettings, RelativeSource={RelativeSource TemplatedParent}}" />
          </dxd:LayoutPanel>
        </dxd:LayoutGroup>
        <dxd:LayoutPanel Name="DocumentViewerPanel" AllowDrag="False" ShowCaption="False" ShowBorder="False" Background="Transparent" Caption="{local:PrintingStringId StringId=ToolBarCaption}">
          <ContentPresenter Content="{Binding}" />
        </dxd:LayoutPanel>
      </dxd:LayoutGroup>
    </dxd:DockLayoutManager>
  </DataTemplate>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}">
    <Grid>
      <native:PreviewSurface />
      <ContentControl Focusable="False" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=NavigationPaneDockLayoutTemplate}}">
        <mvvm:Interaction.Behaviors>
          <native:DocumentPreviewDockingLayoutTemplateUpdater UseNavigationPaneTemplate="{Binding Path=AssociatedObject.(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource Self}}" />
        </mvvm:Interaction.Behaviors>
        <local:DocumentPresenterControl Focusable="False">
          <dxb:BarManager.DXContextMenu>
            <dxb:PopupMenu>
              <bars:HandToolBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.HandTool}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.HandToolCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:SelectToolBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.SelectTool}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SelectToolCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <dxb:BarItemSeparator />
              <bars:CopyBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Copy}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.CopyCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxb:PopupMenu>
          </dxb:BarManager.DXContextMenu>
        </local:DocumentPresenterControl>
      </ContentControl>
    </Grid>
  </DataTemplate>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=BarsTemplate}">
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="auto" />
      </Grid.RowDefinitions>
      <dxb:BarContainerControl>
        <dxb:ToolBarControl local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Bar}" AllowHide="False" GlyphSize="Large" Caption="{local:PrintingStringId StringId=ToolBarCaption}" UseWholeRow="True" AllowCustomizationMenu="False">
          <mvvm:Interaction.Behaviors>
            <dxb:ControllerBehavior Actions="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.Actions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
              <dxb:ControllerBehavior.Triggers>
                <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True" />
              </dxb:ControllerBehavior.Triggers>
            </dxb:ControllerBehavior>
          </mvvm:Interaction.Behaviors>
          <bars:OpenBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Open}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.OpenDocumentCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:SaveBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Save}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SaveCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <dxb:BarItemLinkSeparator />
          <bars:ParametersBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Parameters}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:DocumentMapBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.DocumentMap}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:ThumbnailsBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Thumbnails}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleThumbnailsCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:EditingFieldsBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.EditingFields}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEditingFieldsCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:FindTextBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Find}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ShowFindTextCommand, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="{StaticResource TrueBoolean}" />
          <dxb:BarItemLinkSeparator />
          <bars:PrintBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Print}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:PrintDirectBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PrintDirect}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintDirectCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:PageSetupBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageSetup}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PageSetupCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:ScaleBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Scale}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ScaleCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <dxb:BarItemLinkSeparator />
          <bars:FirstPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.FirstPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.FirstPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:PreviousPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PreviousPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PreviousPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:NextPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NextPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.NextPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:LastPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.LastPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.LastPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:NavigationPaneBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NavigationPane}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, FallbackValue=True}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleNavigationPaneCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <dxb:BarItemLinkSeparator />
          <bars:ZoomOutBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomOut}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomOutCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:ZoomBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Zoom}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:ZoomInBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomIn}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomInCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <dxb:BarItemLinkSeparator />
          <bars:PageLayoutBarSubItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageLayoutSplit}" SubItemsGlyphSize="Small" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetPageLayoutSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:ContinuousScrollingBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ContinuousScrolling}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEnableContinuousScrollingCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:CoverPageBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ShowCoverPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleShowCoverPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <dxb:BarItemLinkSeparator />
          <bars:ExportSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Export}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ExportSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:SendSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Send}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SendSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:WatermarkBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Watermark}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetWatermarkCommand, RelativeSource={RelativeSource TemplatedParent}}" />
        </dxb:ToolBarControl>
      </dxb:BarContainerControl>
      <ContentControl UseLayoutRounding="True" Grid.Row="1" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}" />
      <dxb:StatusBarControl local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.StatusBar}" Focusable="True" IsTabStop="True" AllowCustomizationMenu="False" Grid.Row="2" Caption="{local:PrintingStringId StringId=StatusBarCaption}">
        <bars:PageNumberEditItem Focusable="True" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageNumber}" SettingsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}" />
        <bars:ProgressEditItem Focusable="True" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Progress}" ProgressSettings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}" />
        <bars:StopPageBuildItem Focusable="True" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.StopBuilding}" Command="{Binding  Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.StopPageBuildingCommand, RelativeSource={RelativeSource TemplatedParent}}" Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Stop.svg}" />
        <bars:ZoomFactorEditItem Focusable="True" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomFactor}" Alignment="Far" SettingsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}" />
      </dxb:StatusBarControl>
    </Grid>
  </DataTemplate>
  <Style TargetType="{x:Type dxr:RibbonControl}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=RibbonStyle}">
    <Setter Property="ToolbarShowMode" Value="Hide" />
    <Setter Property="RibbonTitleBarVisibility" Value="Collapsed" />
    <Setter Property="RibbonStyle" Value="Office2010" />
    <Setter Property="HideEmptyGroups" Value="True" />
    <Setter Property="AllowCustomization" Value="False" />
  </Style>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=RibbonTemplate}">
    <Grid>
      <mvvm:Interaction.Behaviors>
        <dxb:ControllerBehavior Actions="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.RibbonActions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
          <dxb:ControllerBehavior.Triggers>
            <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True" />
          </dxb:ControllerBehavior.Triggers>
        </dxb:ControllerBehavior>
      </mvvm:Interaction.Behaviors>
      <Grid.RowDefinitions>
        <RowDefinition Height="auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="auto" />
      </Grid.RowDefinitions>
      <dxr:RibbonControl local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Ribbon}" Focusable="False" Style="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=RibbonStyle}}">
        <dxr:RibbonControl.ApplicationMenu>
          <dxr:ApplicationMenu Name="menu">
            <dxb:BarButtonItemLink BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Open}" />
            <dxb:BarButtonItemLink BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Save}" />
            <dxb:BarItemSeparator />
            <dxb:BarButtonItemLink BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Print}" />
          </dxr:ApplicationMenu>
        </dxr:RibbonControl.ApplicationMenu>
        <dxr:RibbonDefaultPageCategory>
          <dxr:RibbonPage local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PreviewPage}" Caption="{local:PrintingStringId StringId=RibbonPageCaption}">
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_File}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.FileGroup}">
              <bars:OpenBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Open}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.OpenDocumentCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:SaveBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Save}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SaveCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Print}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PrintGroup}">
              <bars:PrintBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Print}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:PrintDirectBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PrintDirect}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintDirectCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:PageSetupBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageSetup}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PageSetupCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:ScaleBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Scale}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ScaleCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Navigation}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NavigationGroup}">
              <bars:FirstPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.FirstPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.FirstPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:PreviousPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PreviousPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PreviousPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:NextPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NextPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.NextPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:LastPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.LastPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.LastPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:NavigationPaneBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NavigationPane}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleNavigationPaneCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Zoom}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomGroup}">
              <bars:ZoomOutBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomOut}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomOutCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:ZoomBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Zoom}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:ZoomInBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomIn}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomInCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_View}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ViewGroup}">
              <bars:PageLayoutBarSubItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageLayoutSplit}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetPageLayoutSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <dxb:BarItemSeparator />
              <bars:ContinuousScrollingBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ContinuousScrolling}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEnableContinuousScrollingCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:CoverPageBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ShowCoverPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleShowCoverPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Export}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ExportGroup}">
              <bars:ExportSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Export}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ExportSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:SendSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Send}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SendSplitCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
            <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Document}" local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.DocumentGroup}">
              <bars:ParametersBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Parameters}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:DocumentMapBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.DocumentMap}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand, RelativeSource={RelativeSource TemplatedParent}}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}" />
              <bars:ThumbnailsBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Thumbnails}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleThumbnailsCommand, RelativeSource={RelativeSource TemplatedParent}}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}" />
              <bars:EditingFieldsBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.EditingFields}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleEditingFieldsCommand, RelativeSource={RelativeSource TemplatedParent}}" />
              <bars:FindTextBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Find}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ShowFindTextCommand, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="{StaticResource TrueBoolean}" IsVisible="{Binding Path=(local:DocumentPreviewControl.ActualViewer).UseOfficeInspiredNavigationPane, RelativeSource={RelativeSource TemplatedParent}, Converter={dxmvvm:BooleanNegationConverter}, FallbackValue=False}" />
              <bars:WatermarkBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Watermark}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetWatermarkCommand, RelativeSource={RelativeSource TemplatedParent}}" />
            </dxr:RibbonPageGroup>
          </dxr:RibbonPage>
        </dxr:RibbonDefaultPageCategory>
      </dxr:RibbonControl>
      <ContentControl UseLayoutRounding="True" Focusable="False" Grid.Row="1" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}" />
      <dxr:RibbonStatusBarControl local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.StatusBar}" Focusable="True" IsTabStop="True" Grid.Row="2">
        <dxr:RibbonStatusBarControl.LeftItems>
          <bars:PageNumberEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageNumber}" SettingsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}" />
          <bars:ProgressEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Progress}" ProgressSettings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}" />
          <bars:StopPageBuildItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.StopBuilding}" Command="{Binding  Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.StopPageBuildingCommand, RelativeSource={RelativeSource TemplatedParent}}" Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Stop.svg}" />
        </dxr:RibbonStatusBarControl.LeftItems>
        <dxr:RibbonStatusBarControl.RightItems>
          <bars:ZoomFactorEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomFactor}" SettingsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}" />
        </dxr:RibbonStatusBarControl.RightItems>
      </dxr:RibbonStatusBarControl>
    </Grid>
  </DataTemplate>
  <ControlTemplate TargetType="{x:Type native:PreviewScrollViewer}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}">
    <Grid x:Name="Grid" Background="{TemplateBinding Background}" Margin="{TemplateBinding Margin}">
      <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>
      <ScrollContentPresenter x:Name="PART_ScrollContentPresenter" Margin="{TemplateBinding Padding}" CanContentScroll="{TemplateBinding CanContentScroll}" CanHorizontallyScroll="False" CanVerticallyScroll="False">
        <Grid.RowSpan>
          <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
            <Binding.Converter>
              <dx:EnumToObjectConverter DefaultValue="1">
                <dx:EnumToObjectConverter.Values>
                  <dx:EnumObjectProvider x:Key="TouchOverlap" Value="2" />
                </dx:EnumToObjectConverter.Values>
              </dx:EnumToObjectConverter>
            </Binding.Converter>
          </Binding>
        </Grid.RowSpan>
        <Grid.ColumnSpan>
          <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
            <Binding.Converter>
              <dx:EnumToObjectConverter DefaultValue="1">
                <dx:EnumToObjectConverter.Values>
                  <dx:EnumObjectProvider x:Key="TouchOverlap" Value="2" />
                </dx:EnumToObjectConverter.Values>
              </dx:EnumToObjectConverter>
            </Binding.Converter>
          </Binding>
        </Grid.ColumnSpan>
      </ScrollContentPresenter>
      <ScrollBar Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" Cursor="Arrow" x:Name="PART_VerticalScrollBar" Grid.Column="1" Grid.Row="0" ViewportSize="{TemplateBinding ViewportHeight}" Maximum="{TemplateBinding ScrollableHeight}" Minimum="0" Value="{Binding Path=VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" AutomationProperties.AutomationId="VerticalScrollBar">
        <Grid.RowSpan>
          <MultiBinding>
            <MultiBinding.Bindings>
              <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource Self}" />
              <Binding Path="(dxc:ScrollBarExtensions.ScrollViewerOrientation)" RelativeSource="{RelativeSource TemplatedParent}" />
            </MultiBinding.Bindings>
            <MultiBinding.Converter>
              <dx:VerticalScrollBarRowSpanConverter />
            </MultiBinding.Converter>
          </MultiBinding>
        </Grid.RowSpan>
      </ScrollBar>
      <ScrollBar Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Cursor="Arrow" x:Name="PART_HorizontalScrollBar" Grid.Column="0" Grid.Row="1" Orientation="Horizontal" ViewportSize="{TemplateBinding ViewportWidth}" Maximum="{TemplateBinding ScrollableWidth}" Minimum="0" Value="{Binding Path=HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" AutomationProperties.AutomationId="HorizontalScrollBar">
        <Grid.ColumnSpan>
          <MultiBinding>
            <MultiBinding.Bindings>
              <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource Self}" />
              <Binding Path="(dxc:ScrollBarExtensions.ScrollViewerOrientation)" RelativeSource="{RelativeSource TemplatedParent}" />
            </MultiBinding.Bindings>
            <MultiBinding.Converter>
              <dx:HorizontalScrollBarRowSpanConverter />
            </MultiBinding.Converter>
          </MultiBinding>
        </Grid.ColumnSpan>
      </ScrollBar>
      <Border x:Name="Corner" Grid.Row="1" Grid.Column="1" Style="{DynamicResource {dxt:ScrollBarThemeKey ResourceKey=ScrollingCornerStyle}}">
        <Border.Visibility>
          <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
            <Binding.Converter>
              <dx:EnumToObjectConverter DefaultValue="Visible">
                <dx:EnumToObjectConverter.Values>
                  <dx:EnumObjectProvider x:Key="TouchOverlap" Value="Collapsed" />
                </dx:EnumToObjectConverter.Values>
              </dx:EnumToObjectConverter>
            </Binding.Converter>
          </Binding>
        </Border.Visibility>
        <dx:BackgroundPanel />
      </Border>
      <dxe:FlyoutControl x:Name="PART_FlyoutControl" PlacementTarget="{Binding ElementName=PART_VerticalScrollBar}" VerticalAlignment="Center" AllowMoveAnimation="False" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PaginationTemplate}}" IsOpen="False">
        <dxe:FlyoutControl.Settings>
          <dxe:FlyoutSettings Placement="Left" ShowIndicator="True" />
        </dxe:FlyoutControl.Settings>
      </dxe:FlyoutControl>
    </Grid>
  </ControlTemplate>
  <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasContentTemplate}">
    <Border VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Background="#45007FFF" BorderBrush="#FF007FFF" BorderThickness="1" />
  </DataTemplate>
  <ControlTemplate TargetType="{x:Type native:SelectionCanvas}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasTemplate}">
    <Canvas x:Name="PART_SelectionCanvas" ClipToBounds="True">
      <ContentControl Canvas.Left="{Binding Path=(SelectionRectangle).X, RelativeSource={RelativeSource TemplatedParent}}" Canvas.Top="{Binding Path=(SelectionRectangle).Y, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(SelectionRectangle).Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(SelectionRectangle).Height, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasContentTemplate}}" Content="{TemplateBinding SelectionRectangle}" Focusable="False" />
    </Canvas>
  </ControlTemplate>
  <ControlTemplate TargetType="{x:Type native:PageSelector}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PageSelectorTemplate}">
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition />
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>
      <dxdv:DocumentPresenterDecorator Focusable="False" x:Name="PART_Decorator" FocusVisualStyle="{x:Null}" Grid.RowSpan="2" Grid.ColumnSpan="2">
        <Grid>
          <native:PreviewScrollViewer x:Name="PART_ScrollViewer" FlowDirection="{Binding FlowDirection, RelativeSource={RelativeSource AncestorType=local:DocumentPreviewControl}}" dx:ScrollBarExtensions.ScrollBehavior="{dxc:ScrollViewerScrollBehavior}" CanMouseScroll="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CursorMode, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource cursorModeToCanMouseScrollConverter}}" Focusable="false" Padding="{TemplateBinding Padding}" Template="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}}" CanContentScroll="True">
            <mvvm:Interaction.Behaviors>
              <native:CursorAttachedBehavior CursorMode="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CursorMode, RelativeSource={RelativeSource TemplatedParent}}" />
              <dx:ScrollViewerTouchBehavior Orientation="Vertical" />
            </mvvm:Interaction.Behaviors>
            <ItemsPresenter x:Name="PART_ItemsPresenter" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
          </native:PreviewScrollViewer>
        </Grid>
      </dxdv:DocumentPresenterDecorator>
      <native:SelectionCanvas Grid.ColumnSpan="2" SelectionRectangle="{Binding Path=SelectionRectangle, RelativeSource={RelativeSource AncestorType=local:DocumentPresenterControl}}" />
      <dx:DXExpander HorizontalExpand="FromLeftToRight" IsExpanded="{TemplateBinding IsSearchControlVisible}" Visibility="{TemplateBinding IsSearchControlVisible, Converter={dx:BooleanToVisibilityConverter}}" VerticalAlignment="Top" HorizontalAlignment="Stretch" Opacity="{Binding Path=AnimationProgress, RelativeSource={RelativeSource Self}}">
        <dxdv:SearchControlContainer IsSearchControlVisible="{TemplateBinding IsSearchControlVisible}" SearchParameter="{TemplateBinding SearchParameter}" />
      </dx:DXExpander>
    </Grid>
  </ControlTemplate>
  <ControlTemplate TargetType="{x:Type local:DocumentPresenterControl}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=DocumentPresenterTemplate}">
    <Border Focusable="False">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition />
        </Grid.RowDefinitions>
        <TextBlock HorizontalAlignment="Center" TextAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Background="Transparent" Text="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.DocumentStatus, UpdateSourceTrigger=PropertyChanged, Converter={dxpn:DocumentStatusToTextConverter}, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.DocumentStatus, Converter={dxpn:DocumentStatusToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource TemplatedParent}}" />
        <Grid Name="renderContainer">
          <dxe:NativeImage x:Name="PART_NativeImage" Focusable="False" />
          <native:PageSelector x:Name="PART_ItemsControl" Background="Transparent" IsSearchControlVisible="{TemplateBinding IsSearchControlVisible}" SearchParameter="{TemplateBinding SearchParameter}" VirtualizingStackPanel.VirtualizationMode="Recycling">
            <native:PageSelector.ItemsPanel>
              <ItemsPanelTemplate>
                <dxdv:DocumentViewerPanel Name="itemsHost" IsItemsHost="True" FlowDirection="LeftToRight" />
              </ItemsPanelTemplate>
            </native:PageSelector.ItemsPanel>
          </native:PageSelector>
        </Grid>
      </Grid>
    </Border>
  </ControlTemplate>
  <ControlTemplate TargetType="{x:Type local:DocumentPreviewControl}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=Template}">
    <ContentControl Grid.RowSpan="3" Focusable="False" Grid.ColumnSpan="3" ContentTemplate="{TemplateBinding ActualBarsTemplate}" />
  </ControlTemplate>
  <ControlTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=DocumentMapTemplate}" TargetType="{x:Type native:DocumentMap}">
    <dxg:GridControl Grid.Row="1" SelectionMode="Row" CurrentItem="{Binding SelectedItem, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" SelectedItem="{Binding SelectedItem, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}" x:Name="PART_GridControl" ItemsSource="{TemplateBinding ActualSource}" ShowBorder="False">
      <mvvm:Interaction.Behaviors>
        <mvvm:KeyToCommand EventName="PreviewKeyDown" Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}" CommandParameter="{Binding Path=CurrentItem, ElementName=PART_GridControl}" MarkRoutedEventsAsHandled="True" KeyGesture="Enter" />
        <mvvm:KeyToCommand EventName="PreviewKeyDown" Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}" CommandParameter="{Binding Path=CurrentItem, ElementName=PART_GridControl}" MarkRoutedEventsAsHandled="True" KeyGesture="Space" />
      </mvvm:Interaction.Behaviors>
      <dxg:GridControl.View>
        <dxg:TreeListView x:Name="PART_TreeView" Style="{TemplateBinding TreeViewStyle}">
          <dxg:TreeListView.FormatConditions>
            <dxg:FormatCondition FieldName="IsHighlighted" Expression="[IsHighlighted] = True" ApplyToRow="True">
              <dxg:FormatCondition.Format>
                <dx:Format Background="#FFFFEE80" Foreground="#FF2B579A" />
              </dxg:FormatCondition.Format>
            </dxg:FormatCondition>
          </dxg:TreeListView.FormatConditions>
          <dxg:TreeListView.RowCellMenuCustomizations>
            <dxb:BarButtonItem Content="{dxdv:DocumentViewerControlLocalizedString DocumentMapGoToCaption}" Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}" CommandParameter="{Binding Path=CurrentItem, ElementName=PART_GridControl}" CommandTarget="{Binding ElementName=PART_GridControl}" />
          </dxg:TreeListView.RowCellMenuCustomizations>
          <mvvm:Interaction.Behaviors>
            <mvvm:EventToCommand Command="{x:Static dxdv:DocumentMapCommands.GoToNodeCommand}" EventName="MouseLeftButtonUp">
              <mvvm:EventToCommand.EventArgsConverter>
                <dxdv:MouseEventArgsToDataRowConverter ChangedButton="Left" />
              </mvvm:EventToCommand.EventArgsConverter>
            </mvvm:EventToCommand>
          </mvvm:Interaction.Behaviors>
        </dxg:TreeListView>
      </dxg:GridControl.View>
      <dxg:GridControl.Columns>
        <dxg:GridColumn FieldName="Title" />
      </dxg:GridControl.Columns>
    </dxg:GridControl>
  </ControlTemplate>
  <ControlTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=ThumbnailsTemplate}" TargetType="{x:Type native:ThumbnailsViewerControl}">
    <Grid>
      <native:ThumbnailsPresenterControl PageDisplayMode="Wrap" />
    </Grid>
  </ControlTemplate>
  <ControlTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=ThumbnailsPresenterTemplate}" TargetType="{x:Type native:ThumbnailsPresenterControl}">
    <Grid>
      <dxe:NativeImage x:Name="PART_NativeImage" />
      <native:ThumbnailsPageSelector x:Name="PART_ItemsControl">
        <native:ThumbnailsPageSelector.ItemsPanel>
          <ItemsPanelTemplate>
            <dxdv:DocumentViewerPanel x:Name="PART_DocumentViewerPanel" />
          </ItemsPanelTemplate>
        </native:ThumbnailsPageSelector.ItemsPanel>
      </native:ThumbnailsPageSelector>
    </Grid>
  </ControlTemplate>
  <ControlTemplate TargetType="{x:Type local:PreviewPageControlItem}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PageControlItemTemplate}">
    <Grid Margin="1">
      <ContentControl IsHitTestVisible="False" Content="{Binding}" Focusable="False" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PageBorderTemplate}}" />
      <native:PageMarginsEditor Focusable="False" Margin="-1" Zoom="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ZoomFactor, RelativeSource={RelativeSource Self}}" Page="{Binding}" />
    </Grid>
  </ControlTemplate>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailPageControlItem}" TargetType="{x:Type native:ThumbnailPageControlItem}">
    <Setter Property="Focusable" Value="False" />
    <Setter Property="VerticalAlignment" Value="Bottom" />
    <Setter Property="IsSelected" Value="{Binding Path=IsSelected}" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type native:ThumbnailPageControlItem}">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="*" />
              <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <ContentControl IsHitTestVisible="False" Content="{Binding}" ContentTemplate="{DynamicResource ResourceKey={themes:NewDocumentViewerThemeKey ResourceKey=PageBorderTemplate}}" />
            <TextBlock Grid.Row="1" Text="{Binding Path=PageNumber}" TextAlignment="Center" Margin="0,5,0,5" />
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailsViewerControl}" TargetType="{x:Type native:ThumbnailsViewerControl}">
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=ThumbnailsTemplate}}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailsPresenterControl}" TargetType="{x:Type native:ThumbnailsPresenterControl}">
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=ThumbnailsPresenterTemplate}}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.ThumbnailsPageSelector}" TargetType="{x:Type native:ThumbnailsPageSelector}">
    <Setter Property="Focusable" Value="False" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type native:ThumbnailsPageSelector}">
          <Grid>
            <dxdv:DocumentPresenterDecorator Focusable="False" x:Name="PART_Decorator" FocusVisualStyle="{x:Null}" Grid.RowSpan="2" Grid.ColumnSpan="2">
              <native:PreviewScrollViewer x:Name="PART_ScrollViewer" dx:ScrollViewerTouchBehavior.IsEnabled="True" dx:ScrollBarExtensions.ScrollBehavior="{dxc:ScrollViewerScrollBehavior}" CanMouseScroll="True" Focusable="false" Padding="{TemplateBinding Padding}" Template="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" CanContentScroll="True" ShowFlyoutOnScroll="False">
                <mvvm:Interaction.Behaviors>
                  <dx:ScrollViewerTouchBehavior Orientation="Vertical" />
                </mvvm:Interaction.Behaviors>
                <ItemsPresenter x:Name="PART_ItemsPresenter" />
              </native:PreviewScrollViewer>
            </dxdv:DocumentPresenterDecorator>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.DocumentMap}" TargetType="{x:Type native:DocumentMap}">
    <Setter Property="TreeViewStyle" Value="{DynamicResource {dxdvt:DocumentViewerThemeKey ResourceKey=TreeViewStyle}}" />
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=DocumentMapTemplate}}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewPageControlItem}" TargetType="{x:Type local:PreviewPageControlItem}">
    <Setter Property="Focusable" Value="True" />
    <Setter Property="IsSelected" Value="{Binding IsSelected}" />
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PageControlItemTemplate}}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.SelectionCanvas}" TargetType="{x:Type native:SelectionCanvas}">
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasTemplate}}" />
    <Setter Property="Focusable" Value="False" />
    <Setter Property="IsHitTestVisible" Value="False" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.PageSelector}" TargetType="{x:Type native:PageSelector}">
    <Setter Property="Focusable" Value="False" />
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PageSelectorTemplate}}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.DocumentPresenterControl}" TargetType="{x:Type local:DocumentPresenterControl}">
    <Setter Property="MinHeight" Value="10" />
    <Setter Property="FlowDirection" Value="LeftToRight" />
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=DocumentPresenterTemplate}}" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.DocumentPreviewControl}" TargetType="{x:Type local:DocumentPreviewControl}">
    <Setter Property="HighlightSelectionColor" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=HighlightSelectionColor}}" />
    <Setter Property="BarsTemplate" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=BarsTemplate}}" />
    <Setter Property="RibbonTemplate" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=RibbonTemplate}}" />
    <Setter Property="PresenterTemplate" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}" />
    <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=Template}}" />
    <Setter Property="dx:ScrollBarExtensions.ScrollBarMode" Value="TouchOverlap" />
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.PageMarginsEditor}" TargetType="{x:Type native:PageMarginsEditor}">
    <Setter Property="Visibility">
      <Setter.Value>
        <MultiBinding Converter="{native:PageViewModelToPageMarginsVisibilityConverter}">
          <Binding />
          <Binding Path="(local:DocumentPreviewControl.ActualViewer).CurrentPageNumber" RelativeSource="{RelativeSource Self}" />
        </MultiBinding>
      </Setter.Value>
    </Setter>
    <Setter Property="IsEnabled" Value="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.CanChangePageSettings, RelativeSource={RelativeSource Self}}" />
    <Setter Property="Focusable" Value="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document.CanChangePageSettings, RelativeSource={RelativeSource Self}}" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="native:PageMarginsEditor">
          <Grid ClipToBounds="True" Name="Margins" Visibility="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ShowPageMargins, RelativeSource={RelativeSource Self}, Converter={dxc:BooleanToVisibilityConverter}}">
            <Grid.RowDefinitions>
              <RowDefinition MinHeight="0" Height="{Binding TopMargin.Size, RelativeSource={RelativeSource TemplatedParent}}" MaxHeight="{Binding TopMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}" />
              <RowDefinition Height="auto" />
              <RowDefinition Height="*" MinHeight="1" />
              <RowDefinition Height="auto" />
              <RowDefinition MinHeight="0" Height="{Binding BottomMargin.Size, RelativeSource={RelativeSource TemplatedParent}}" MaxHeight="{Binding BottomMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition MinWidth="0" Width="{Binding LeftMargin.Size, RelativeSource={RelativeSource TemplatedParent}}" MaxWidth="{Binding LeftMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}" />
              <ColumnDefinition Width="auto" />
              <ColumnDefinition Width="*" />
              <ColumnDefinition Width="auto" />
              <ColumnDefinition MinWidth="0" Width="{Binding RightMargin.Size, RelativeSource={RelativeSource TemplatedParent}}" MaxWidth="{Binding RightMargin.MaxSize, RelativeSource={RelativeSource TemplatedParent}}" />
            </Grid.ColumnDefinitions>
            <native:MarginThumb PageMargin="{TemplateBinding LeftMargin}" SetPageMarginCommand="{Binding Page.SetPageMarginCommand, RelativeSource={RelativeSource TemplatedParent}}" Grid.RowSpan="5" Grid.Column="1" Orientation="Vertical" ResizeBehavior="PreviousAndNext" Background="LightGray" VerticalAlignment="Stretch" />
            <native:MarginThumb PageMargin="{TemplateBinding TopMargin}" SetPageMarginCommand="{Binding SetPageMarginCommand}" Grid.ColumnSpan="5" Grid.Row="1" Orientation="Horizontal" ResizeBehavior="PreviousAndNext" Background="LightGray" HorizontalAlignment="Stretch" />
            <native:MarginThumb PageMargin="{TemplateBinding RightMargin}" SetPageMarginCommand="{Binding SetPageMarginCommand}" Grid.RowSpan="5" Grid.Column="3" Orientation="Vertical" ResizeBehavior="PreviousAndNext" Background="LightGray" VerticalAlignment="Stretch" />
            <native:MarginThumb PageMargin="{TemplateBinding BottomMargin}" SetPageMarginCommand="{Binding SetPageMarginCommand}" Grid.ColumnSpan="5" Grid.Row="3" Orientation="Horizontal" ResizeBehavior="PreviousAndNext" Background="LightGray" HorizontalAlignment="Stretch" />
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Printing.PreviewControl.Native.MarginThumb}" TargetType="{x:Type native:MarginThumb}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type native:MarginThumb}">
          <Grid Background="#00000000">
            <VisualStateManager.VisualStateGroups>
              <VisualStateGroup x:Name="CommonStates">
                <VisualState x:Name="Normal" />
                <VisualState x:Name="MouseOver">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Stroke).(SolidColorBrush.Color)" Storyboard.TargetName="border">
                      <EasingColorKeyFrame KeyTime="0" Value="Gray" />
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Disabled" />
                <VisualState x:Name="Pressed" />
              </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <native:NoSizeDecorator>
              <Line Name="border" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" StrokeThickness="5" StrokeDashArray="1 1" Stroke="LightGray" Y2="{TemplateBinding ActualHeight}" X2="{TemplateBinding ActualWidth}" />
            </native:NoSizeDecorator>
            <ToolTipService.ToolTip>
              <ToolTip x:Name="PART_Tooltip" Placement="Mouse" Visibility="{Binding IsDragging, RelativeSource={RelativeSource TemplatedParent}, Converter={mvvm:BooleanToVisibilityConverter HiddenInsteadOfCollapsed=True}}">
                <ToolTip.Content>
                  <MultiBinding Converter="{native:MarginSideAndSizeToTextConverter}" FallbackValue="{x:Null}">
                    <Binding Path="PageMargin.Side" RelativeSource="{RelativeSource TemplatedParent}" Mode="OneWay" />
                    <Binding Path="ActualSize" RelativeSource="{RelativeSource TemplatedParent}" Mode="OneWay" />
                  </MultiBinding>
                </ToolTip.Content>
              </ToolTip>
            </ToolTipService.ToolTip>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="Orientation" Value="Horizontal">
              <Setter TargetName="border" Property="Y2" Value="1" />
              <Setter TargetName="border" Property="Height" Value="1" />
            </Trigger>
            <Trigger Property="Orientation" Value="Vertical">
              <Setter TargetName="border" Property="X2" Value="1" />
              <Setter TargetName="border" Property="Width" Value="1" />
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="Orientation" Value="Horizontal">
        <Setter Property="Height" Value="3" />
      </Trigger>
      <Trigger Property="Orientation" Value="Vertical">
        <Setter Property="Width" Value="3" />
      </Trigger>
    </Style.Triggers>
  </Style>
</ResourceDictionary>